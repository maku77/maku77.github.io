---
title: "ダイナミック・ルーティング・プロトコルのメモ (RIP, OSPF, BGP-4)"
url: "p/gowvphv/"
date: "2008-05-09"
description: "RIP や OSPF に関してのまとめメモです。"
tags: ["memo", "network"]
aliases: ["/memo/network/dynamic-routing.html"]
---


RIP (Routing Information Protocol)
----

### 特徴

- 最も歴史があり、最も簡単で、多くのエンジニアが知っている。
- 小、中規模の WAN を介さないネットワークで使われる。
- サポートしている機器が多い。

### 仕組み

- ルータが自身のルーティングテーブルをブロードキャストで隣のルータへ伝える、ということを繰り返してルーティングテーブルを伝播していく。
- 自分自身のルーティングテーブルは最初、メトリック値１としてブロードキャストする。ルーティングテーブルを伝播するごとに、ルーティングテーブルのメトリック値が＋１される。メトリック値が大きいほど、遠いルータだということが分かる。同じサブネットへの経路として複数のルータが選択できる場合、メトリック値が小さいもの（要するにルータのホップ数が少なく、近いもの）が選択される。
- 30秒ごとにルータはまわりのルータに情報を送信する（レギュラーアップデート）。あるルータのレギュラーアップデートを 6 回受信できない状態が続くと、そのルータに障害が発生したとみなされ、メトリック値 16 が設定され、さらに 4 回 RIP パケットの応答がない場合はルーティングテーブルからそのルータの情報が削除される。
- RIPv2 では可変長サブネットマスクに対応している。

### 欠点

- 30秒後とのレギュラーアップデートなので、経路情報の伝播には時間がかかる。また、ブロードキャストなので、ネットワークへの負荷がかかる。RIPv2 ではレギュラーアップデートはブロードキャストではなく、マルチキャスト (224.0.0.9) で送られるが、送信周期は 30 秒で同じ。
- RIP におけるメトリック値の上限は 16 であり、その値が設定されると、使用できないルートであるという意味になる。結果として、RIP は 16 個以上のルータを経由する大規模なネットワークには適用できない。逆に、この制限のおかげで経路のループによる問題が起こらないようになっている。
- 経路はメトリック値だけで判断されるので、回線速度、品質が考慮されない。


OSPF (Open Shortest Path First)
----

### 特徴

- RIP の課題を解決したプロトコル。
- 回線速度などを考慮しているので、WAN を含む中～大規模のネットワークに適用できる。
- RIP よりも複雑で構築が難しい。
- OSPF をサポートする機器は、RIP だけサポートしている機器に比べて高価。

### 仕組み

- サブネットに主従関係を持たせ、1 つのルータを代表ルータとする。そのサブネット内のルータ情報は代表ルータが集中管理して他のサブネットへ通知するため、通信量が RIP に比べて少ない。
- サブネット内のルータの中で、プライオリティ値が一番高く設定されているものが代表ルータとなる。ルータのプライオリティ値は各インタフェースごとに設定できる。
- RIP のように定期的に情報を送信（レギュラーアップデート）するのではなく、ルータ情報に変化が起きたときにただちに情報が伝えられる。ネットワークへの負荷が少なく、情報の更新が速い。
- ルータの各ポートにコスト値が設定され、この値を元にメトリック値が計算され、最適な経路が決定される。コスト値は手動で設定することも自動で計算することもできる。
- 16 台以上のルータを越えるルーティングが可能。
- 可変長サブネットマスクに対応している。


BGP-4
----

プロバイダ向け。

