<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Windows on 天才まくまくノート</title><link>https://maku77.github.io/windows/</link><description>Recent content in Windows on 天才まくまくノート</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Wed, 09 Nov 2022 00:00:00 +0900</lastBuildDate><atom:link href="https://maku77.github.io/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Windows のバッチファイルでプロンプトを表示してユーザー入力を促す (set /p)</title><link>https://maku77.github.io/p/2dn6njw/</link><pubDate>Wed, 09 Nov 2022 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/2dn6njw/</guid><description>&lt;h2 id="set-p-コマンドの使い方">set /p コマンドの使い方&lt;/h2>
&lt;p>Windows のコマンドプロンプトで &lt;strong>&lt;code>SET /P&lt;/code>&lt;/strong> コマンドを実行すると、任意のプロンプトを表示して、ユーザーにキーボード入力を促すことができます。&lt;/p>
&lt;pre tabindex="0">&lt;code>SET /P 変数=[プロンプト文字列]
&lt;/code>&lt;/pre>&lt;p>ユーザーが入力したテキストは、指定した変数に格納されるので、後から &lt;code>%変数名%&lt;/code> という形で参照することができます。
次の例では、ユーザーにプロジェクト名の入力を促し、入力結果を &lt;code>PjName&lt;/code> という変数に格納しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.cmd&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">echo&lt;/span> off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">setlocal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">set&lt;/span> &lt;span class="k">/p&lt;/span> &lt;span class="nv">PjName&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s2">&amp;#34;Project name? &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> 入力したプロジェクト名は &lt;span class="nv">%PjName%&lt;/span> です&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Project name? HelloWorld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">入力したプロジェクト名は HelloWorld です&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="具体的な使用例">具体的な使用例&lt;/h2>
&lt;p>&lt;code>set /p&lt;/code> コマンドを実行する前に、入力候補を表示するという利用方法も考えられます。
次のサンプルバッチファイルは、Android のエミュレーター (AVD) を起動するためのものですが、起動可能なデバイス (AVD) の候補を表示して、ユーザーにどのデバイスを起動するかを選択させています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">emu.cmd&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">echo&lt;/span> off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">setlocal&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> Available AVDs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">emulator -list-avds
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">set&lt;/span> &lt;span class="k">/p&lt;/span> &lt;span class="nv">AvdName&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s2">&amp;#34;Which AVD do you want to start? &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">%AvdName%&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">echo&lt;/span> ERROR: No AVD specified.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">exit&lt;/span> /b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">emulator @&lt;span class="nv">%AvdName%&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Available AVDs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">phone-s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">phone-t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tv-s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tv-t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Which AVD do you want to start? phone-t&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;ul>
&lt;li>参考: &lt;a href="../p/66q7m2j/">Windows のバッチファイルの実行を途中で終了する (exit /b)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Windows のバッチファイルの実行を途中で終了する (exit /b)</title><link>https://maku77.github.io/p/66q7m2j/</link><pubDate>Mon, 09 Feb 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/66q7m2j/</guid><description>&lt;p>バッチファイルの実行を途中で終了したい場合は、次のコマンドを実行します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="k">EXIT&lt;/span> /B
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>バッチファイルの中で単純に &lt;code>exit&lt;/code> コマンドを実行すると、バッチファイルを実行していたコマンドプロンプト（コマンドシェル）ごと終了してしまいますが、&lt;strong>&lt;code>/B&lt;/code>&lt;/strong> オプション付きで実行すると、&lt;strong>コマンドプロンプト自体は終了せずに、バッチファイルの実行だけを終了&lt;/strong> してくれます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.cmd&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">echo&lt;/span> off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> AAA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">exit&lt;/span> /b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> BBB&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>例えば、上記の &lt;code>sample.cmd&lt;/code> を実行すると、&lt;code>echo BBB&lt;/code> は実行せずに終了します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="go">C:\&amp;gt; sample
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">AAA
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item></channel></rss>