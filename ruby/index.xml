<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Ruby on 天才まくまくノート</title><link>https://maku77.github.io/ruby/</link><description>Recent content in Ruby on 天才まくまくノート</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Mon, 05 Jul 2021 00:00:00 +0900</lastBuildDate><atom:link href="https://maku77.github.io/ruby/index.xml" rel="self" type="application/rss+xml"/><item><title>Rubyメモ: n 文字のランダム文字列を生成する</title><link>https://maku77.github.io/p/vt7ws7t/</link><pubDate>Mon, 05 Jul 2021 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/vt7ws7t/</guid><description>&lt;h2 id="rand_str-関数を実装する">rand_str 関数を実装する&lt;/h2>
&lt;p>次の &lt;code>rand_str&lt;/code> 関数は、指定した長さのランダム文字列を生成します。
使用する文字の種類は、第 2 引数 (&lt;code>chars&lt;/code>) で指定することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># chars の中からランダムに len 文字を選んだランダム文字列を生成します&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">rand_str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">chars&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;23456789abcdefghijkmnopqrstuvwxzy&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">chars&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="nb">rand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">chars&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># テスト&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vg">$0&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="bp">__FILE__&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">rand_str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>$ ruby rand-str.rb
rspgyta5h8
&lt;/code>&lt;/pre>&lt;p>&lt;code>rand(n)&lt;/code> 関数は、0 以上 n 未満のランダムな整数を返します。
&lt;code>chars[rand(chars.length)]&lt;/code> とすることで、&lt;code>chars&lt;/code> 文字列からランダムに 1 つの文字を取得できます。
あとは、これを指定された文字数 &lt;code>len&lt;/code> だけ繰り返し取得して、すべて結合して文字列にすれば完成です。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/vfp5zx9/">Python でランダムな文字列を生成する (&lt;code>random.choice&lt;/code>)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://maku.blog/p/3nx9is3/">ランダムな文字列を生成する Web サイト&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: ファイルやディレクトリが存在するか調べる (File.exist?, Dir.exist?)</title><link>https://maku77.github.io/p/dnav4hc/</link><pubDate>Tue, 12 Feb 2019 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/dnav4hc/</guid><description>&lt;h2 id="ファイルディレクトリの有無を調べる-fileexist">ファイル・ディレクトリの有無を調べる (File.exist?)&lt;/h2>
&lt;p>指定したパスのファイルやディレクトリが存在するかどうかを調べるには、&lt;a href="https://docs.ruby-lang.org/ja/latest/method/File/s/exist=3f.html">File.exist?(path)&lt;/a> メソッドを使用します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample というファイル（あるいはディレクトリ）の有無を調べる&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exist?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;sample&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;sample が見つかりました&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>ディレクトリの確認もまったく同様ですが、&lt;code>File.exist?&lt;/code> では、ファイルとディレクトリの区別ができないことに注意してください。
&lt;code>sample&lt;/code> というファイルがある場合も、&lt;code>sample&lt;/code> というディレクトリがある場合も、&lt;code>File.exist?('sample')&lt;/code> は &lt;code>true&lt;/code> を返します。&lt;/p>
&lt;h2 id="ファイルとディレクトリを区別して有無を調べる-filefile-filedirectory-direxist">ファイルとディレクトリを区別して有無を調べる (File.file?, File.directory?, Dir.exist?)&lt;/h2>
&lt;p>&lt;code>File.exist?&lt;/code> はファイルとディレクトリを区別せずに、指定したパスにファイルかディレクトリが存在しているかを調べるメソッドでした。
ファイルとディレクトリをちゃんと区別して、ファイルの有無やディレクトリの有無をチェックするには、&lt;a href="https://docs.ruby-lang.org/ja/latest/method/File/s/file=3f.html">File.file?(path)&lt;/a> や &lt;a href="https://docs.ruby-lang.org/ja/latest/method/File/s/directory=3f.html">File.directory?&lt;/a>（あるいは &lt;a href="https://docs.ruby-lang.org/ja/latest/method/Dir/s/exist=3f.html">Dir.exist?(path)&lt;/a>）を使用します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ファイルの有無を調べる&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">file?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/bin/bash&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">file?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/bin&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">file?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/no_such_file&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; false&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ディレクトリの有無を調べる&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">directory?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">directory?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/etc&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">directory?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; false&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="パス内で特殊文字--を使用する場合">パス内で特殊文字 (~) を使用する場合&lt;/h2>
&lt;p>ファイルやディレクトリの有無を確認するときのパスには、相対パスや絶対パスを指定できますが、下記のようにホームディレクトリを示す &lt;code>~&lt;/code> を含める場合は、あらかじめ &lt;code>File.expand_path&lt;/code> でパスを展開しておく必要があります。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ホームディレクトリ以下の temp ディレクトリの有無を調べる&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exist?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">expand_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;~/temp&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;ホームディレクトリに temp ディレクトリが見つかりました&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: テンプレート機能（プレースホルダ）で文字列の一部を置換する (%)</title><link>https://maku77.github.io/p/3yvtnt6/</link><pubDate>Mon, 11 Feb 2019 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/3yvtnt6/</guid><description>&lt;p>文字列を置換するためのメソッドとしては、&lt;a href="../p/upbbkhw/">sub や gsub&lt;/a> が用意されていますが、置換対象の文字列が決まった形（テンプレート）の場合、&lt;strong>&lt;code>%&lt;/code>&lt;/strong> によるプレースホルダを使って置換してしまうのが楽です。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.ruby-lang.org/ja/latest/class/String.html#I_--25">String クラスの % のマニュアル&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>次の例では、テンプレート文字列 (&lt;code>template&lt;/code>) の中のプレースホルダ部分 (&lt;code>%s&lt;/code>) を置換しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">template&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;/Users/%s/temp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">template&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="s1">&amp;#39;maku&amp;#39;&lt;/span> &lt;span class="c1">#=&amp;gt; /Users/maku/temp&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>複数のプレースホルダを配置することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">template&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;%s costs %d yen&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">template&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1">#=&amp;gt; AAA costs 100 yen&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>プレースホルダ部分に名前を指定しておくと、Hash オブジェクトを渡すことができます。
下記のように名前を &lt;code>&amp;lt;&amp;gt;&lt;/code> で囲んで指定し、その後ろにフォーマット（&lt;code>s&lt;/code> や &lt;code>d&lt;/code>）を指定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">template&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;%&amp;lt;name&amp;gt;s costs %&amp;lt;price&amp;gt;d yen&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">template&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="ss">:&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">price&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; AAA costs 100 yen&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>名前を囲む記号を &lt;code>{}&lt;/code> にすると、後ろのフォーマット指定を省略することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">template&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;%{name} costs %{price} yen&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">template&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="ss">:&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">price&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; AAA costs 100 yen&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: HelloWorld テンプレート</title><link>https://maku77.github.io/p/ruqnqe4/</link><pubDate>Sat, 12 Jan 2019 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ruqnqe4/</guid><description>&lt;h2 id="main-関数と-show_usage-関数のテンプレート">main 関数と show_usage 関数のテンプレート&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 説明をここに。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Usage:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># $ ruby hello.rb &amp;lt;your_name&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">show_usage&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">basename&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vg">$0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Usage: &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;lt;your_name&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ここにスクリプトのメイン部分を記述していく&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Hello, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vg">$0&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="bp">__FILE__&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">show_usage&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="クラスを使うとき">クラスを使うとき&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 説明をここに。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Usage:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># $ ruby hello.rb &amp;lt;your_name&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">show_usage&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">basename&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vg">$0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Usage: &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;lt;your_name&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># このクラスにスクリプトのメイン部分を記述していく&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Hello&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">greet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Hello, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="vi">@name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vg">$0&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="bp">__FILE__&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">show_usage&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">obj&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">greet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: ハッシュのキー、値の配列を取得する (keys, values)</title><link>https://maku77.github.io/p/899kqkj/</link><pubDate>Sat, 12 Jan 2019 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/899kqkj/</guid><description>&lt;h2 id="基本">基本&lt;/h2>
&lt;h3 id="ハッシュのキーの配列">ハッシュのキーの配列&lt;/h3>
&lt;p>あるハッシュのすべてのキーを要素とする配列を作成するには、&lt;code>Hash#keys&lt;/code> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">keys&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ハッシュの値の配列">ハッシュの値の配列&lt;/h3>
&lt;p>同様に、あるハッシュのすべての値を要素とする配列を作成するには、&lt;code>Hash#values&lt;/code> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">values&lt;/span> &lt;span class="c1">#=&amp;gt; [100, 200, 200]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="応用">応用&lt;/h2>
&lt;h3 id="セットとして作成する">セットとして作成する&lt;/h3>
&lt;p>ハッシュのキーや値を、配列ではなく &lt;code>Set&lt;/code> オブジェクトとして取得したければ、&lt;code>Set.new&lt;/code> コンストラクタに渡してやれば OK です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;set&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">key_set&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">h&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">keys&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">value_set&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">h&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">values&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {100, 200, 300}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ハッシュに期待するキーがすべて含まれているか調べる">ハッシュに期待するキーがすべて含まれているか調べる&lt;/h3>
&lt;p>例えば、あるハッシュのキーとして、&lt;code>a&lt;/code>、&lt;code>b&lt;/code>、&lt;code>c&lt;/code>、&lt;code>d&lt;/code> がすべて含まれているか調べたいとします。
このようなチェックは、それらの要素を含む &lt;code>Set&lt;/code> オブジェクトから、&lt;code>Hash#keys&lt;/code> で求められる配列を &lt;code>-&lt;/code> 演算子で引くことで実現できます。
引いた結果が空にならなければ、必要なキーが足りていないということです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;set&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">REQUIRED_KEYS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">400&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">missing&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REQUIRED_KEYS&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">k&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">missing&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;キー &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> が足りません&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">キー a が足りません
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">キー c が足りません&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>Set&lt;/code> オブジェクトの演算に関しては&lt;a href="../p/3muxcie/">こちらのページ&lt;/a>を参照してください。&lt;/p></description></item><item><title>Rubyメモ: セットを使用する（Set クラス）</title><link>https://maku77.github.io/p/3muxcie/</link><pubDate>Fri, 11 Jan 2019 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/3muxcie/</guid><description>&lt;p>Ruby でセットオブジェクト（重複する値を許さないコレクション）を生成するには、標準ライブラリに含まれている &lt;strong>&lt;code>Set&lt;/code>&lt;/strong> クラスを使用します。
配列やハッシュを扱うときは、Ruby の構文として &lt;code>[]&lt;/code> や &lt;code>{}&lt;/code> を使用できましたが、セットに関しては単純なクラスとして提供されています。&lt;/p>
&lt;h2 id="set-のインスタンスを生成する">Set のインスタンスを生成する&lt;/h2>
&lt;h3 id="空のセットを作成する">空のセットを作成する&lt;/h3>
&lt;p>&lt;code>Set&lt;/code> オブジェクトを生成するには、コンストラクタの &lt;strong>&lt;code>Set.new()&lt;/code>&lt;/strong> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;set&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="配列からセットを作成する">配列からセットを作成する&lt;/h3>
&lt;p>&lt;code>Enumerable&lt;/code> なオブジェクト、例えば配列を &lt;code>Set.new()&lt;/code> に渡して &lt;code>Set&lt;/code> オブジェクトを生成できます。
この際、重複した要素は削除されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;set&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {3, 1, 2}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {1, 2, 3, 4, 5}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Enumerable&lt;/code> には &lt;strong>&lt;code>to_set()&lt;/code>&lt;/strong> メソッドが用意されているので、これを呼び出して &lt;code>Set&lt;/code> オブジェクトを生成することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;aaa&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;bbb&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;ccc&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;bbb&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">to_set&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {&amp;#34;aaa&amp;#34;, &amp;#34;bbb&amp;#34;, &amp;#34;ccc&amp;#34;}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="任意の数のパラメータからセットを作成する">任意の数のパラメータからセットを作成する&lt;/h3>
&lt;p>&lt;strong>&lt;code>Set[]&lt;/code>&lt;/strong> を使用すると、任意の数の値を渡して &lt;code>Set&lt;/code> オブジェクトを生成することができます。
&lt;code>Set.new()&lt;/code> で配列オブジェクトを渡すのと見た目は似ていますが、こちらは配列オブジェクトを 1 つだけ渡しているわけではなく、複数の値を 1 つずつ引数として渡しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Set&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; #&amp;lt;Set: {3, 1, 2}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="set-への要素の追加と削除">Set への要素の追加と削除&lt;/h2>
&lt;h3 id="要素の追加-add-merge">要素の追加 (add, merge)&lt;/h3>
&lt;p>既存のセットオブジェクトに 1 つの要素を追加するには &lt;strong>&lt;code>add&lt;/code>&lt;/strong> メソッド、あるいは &lt;strong>&lt;code>&amp;lt;&amp;lt;&lt;/code>&lt;/strong> 演算子を使用します。&lt;/p></description></item><item><title>Rubyメモ: 文字列内にある文字列が含まれているか調べる (String#include, =~)</title><link>https://maku77.github.io/p/6835vdj/</link><pubDate>Thu, 06 Dec 2018 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6835vdj/</guid><description>&lt;h2 id="stringinclude-を使う方法">String#include? を使う方法&lt;/h2>
&lt;p>ある文字列の中に、指定した文字列そのものが含まれていることを調べるには、&lt;code>String#include?&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;apple banana mango&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">include?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;banana&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;バナナを見つけた！&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="演算子--を使用する方法">演算子 &lt;code>=~&lt;/code> を使用する方法&lt;/h2>
&lt;p>ある文字列の中に、指定した正規表現に一致する文字列が含まれているかを調べるには、&lt;code>=~&lt;/code> 演算子を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA BBB maku@example.com CCC DDD&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="sr">/\w+@\w+/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;メールアドレスっぽいものを見つけた！&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: Ruby でワンライナープログラミング</title><link>https://maku77.github.io/p/f6fj4c7/</link><pubDate>Wed, 05 Dec 2018 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/f6fj4c7/</guid><description>&lt;p>ワンライナーは、コマンドラインから &lt;code>ruby&lt;/code> を実行するときに、1 行だけコードを入力して簡単な処理を行うものです。
コマンドの出力をサクッと加工するのに適しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 各行の 3 番目のフィールドのみ抜き出す&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> cat data.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">AAA 100 xxx
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BBB 200 yyy
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">CCC 300 zzz
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="gp">$&lt;/span> cat data.txt &lt;span class="p">|&lt;/span> ruby -ane &lt;span class="s2">&amp;#34;puts &lt;/span>&lt;span class="nv">$F&lt;/span>&lt;span class="s2">[2]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">xxx
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">yyy
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">zzz
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記のように、テキストファイルの内容をそのままワンライナーに渡すのであれば、リダイレクトで入力することもできます。
こちらの方が &lt;code>cat&lt;/code> コマンドなどに依存しないのでよいかもしれません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby -ane &lt;span class="s2">&amp;#34;puts &lt;/span>&lt;span class="nv">$F&lt;/span>&lt;span class="s2">[2]&amp;#34;&lt;/span> &amp;lt; data.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>オプションの意味:&lt;/p>
&lt;ul>
&lt;li>&lt;b>&lt;code>-a&lt;/code>&lt;/b>: autosplit mode（各行の &lt;code>$_&lt;/code> が分割されて &lt;code>$F&lt;/code> に格納される）&lt;/li>
&lt;li>&lt;b>&lt;code>-n&lt;/code>&lt;/b>: 各行を処理する（内部で &lt;code>while gets()&lt;/code> ループが実行される）&lt;/li>
&lt;li>&lt;b>&lt;code>-e&lt;/code>&lt;/b>: 後ろにコマンドを直接記述していることを示す&lt;/li>
&lt;/ul>
&lt;p>&lt;code>-n&lt;/code> オプションを付けて各行を処理する場合は、&lt;a href="../sed/">Awk&lt;/a> のように、最初に一度だけ実行される &lt;code>BEGIN&lt;/code> ブロックや、最後に一度だけ実行される &lt;code>END&lt;/code> ブロックを利用できます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 各行の 2 番目のフィールドの値を合計する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby -ane &lt;span class="s2">&amp;#34;BEGIN{&lt;/span>&lt;span class="nv">$a&lt;/span>&lt;span class="s2">=0}; &lt;/span>&lt;span class="nv">$a&lt;/span>&lt;span class="s2">+=&lt;/span>&lt;span class="nv">$F&lt;/span>&lt;span class="s2">[1].to_i; END{puts &lt;/span>&lt;span class="nv">$a&lt;/span>&lt;span class="s2">}&amp;#34;&lt;/span> &amp;lt; data.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://benoithamelin.tumblr.com/ruby1line">Ruby one-liners (by Benoit Hamelin)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: Gem パッケージの gemspec にファイルを追加し忘れるのを防ぐ</title><link>https://maku77.github.io/p/sa4jekt/</link><pubDate>Wed, 23 Aug 2017 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sa4jekt/</guid><description>&lt;p>Gem パッケージを作成するときは、パッケージに含めるファイルを gemspec ファイルの &lt;code>files&lt;/code> に列挙しておく必要があります。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">hello_gem.gemspec&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Gem&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Specification&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;hello_gem&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;0.0.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">files&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;lib/hello_gem.rb&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記のように 1 つずつファイル名を列挙していく方法ですと、Gem パッケージに含めたいファイルを追加したときに、gemspec の更新をし忘れてしまうことがあります。
下記のように、ワイルドカードを使用してファイル名を指定しておけば、ファイルの追加し忘れを防ぐことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Gem&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Specification&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">files&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;lib/**/*.rb&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;bin/*&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;LICENSE&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;*.md&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: Gem パッケージを作成する (3) パッケージを公開する</title><link>https://maku77.github.io/p/sjzsisu/</link><pubDate>Mon, 07 Aug 2017 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sjzsisu/</guid><description>&lt;h2 id="gem-パッケージの準備">Gem パッケージの準備&lt;/h2>
&lt;p>ここでは、作成した Gem パッケージを &lt;a href="https://rubygems.org/">RubyGems.org&lt;/a> へ公開する手順を示します。
Gem パッケージの作成方法に関しては、下記の記事を参考にしてください。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="../p/k6gcrgj/">Gem パッケージを作成する (1) 基本&lt;/a>&lt;/li>
&lt;li>&lt;a href="../p/sf4zv8i/">Gem パッケージを作成する (2) 実行可能コマンドを追加する&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="rubygemsorg-にアカウントを作成する">RubyGems.org にアカウントを作成する&lt;/h2>
&lt;p>作成した Gem パッケージを &lt;a href="https://rubygems.org/">RubyGems.org&lt;/a> にアップロードするには、下記のサインアップページからアカウントを作成しておく必要があります。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://rubygems.org/sign_up">RubyGems.org - Sign up&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>メールアドレスとアカウント名、パスワードを入力すると確認メールが届くので、そこに記載されたアドレスにアクセスして Verify すれば完了です。&lt;/p>
&lt;h2 id="gem-パッケージをアップロードする">Gem パッケージをアップロードする&lt;/h2>
&lt;p>RubyGems.org にアカウントを作成したら、&lt;code>gem push&lt;/code> コマンドを使って Gem パッケージを公開できます。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem push hello-1.0.0.gem
Enter your RubyGems.org credentials.
Don&amp;#39;t have an account yet? Create one at https://rubygems.org/sign_up
 Email: yourname@example.com
Password: ********
Signed in.
Pushing gem to RubyGems.org...
Successfully registered gem: hello (1.0.0)
&lt;/code>&lt;/pre>&lt;p>初めて &lt;code>gem push&lt;/code> コマンドを実行するときは、上記のように、RubyGems.org のアカウント名とパスワードを入力する必要があります。&lt;/p></description></item><item><title>Rubyメモ: 標準エラー出力へ出力する (STDERR)</title><link>https://maku77.github.io/p/odauy26/</link><pubDate>Mon, 07 Aug 2017 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/odauy26/</guid><description>&lt;p>Ruby で標準エラー出力へ出力を行うには、&lt;code>STDERR.puts&lt;/code> や &lt;code>STDERR.print&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">STDERR&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;エラー発生！&amp;#39;&lt;/span> &lt;span class="c1"># 改行あり&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">STDERR&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">print&lt;/span> &lt;span class="s1">&amp;#39;エラー発生！&amp;#39;&lt;/span> &lt;span class="c1"># 改行なし&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>標準出力への出力でよく使用する &lt;code>puts&lt;/code> や &lt;code>print&lt;/code> は、通常は下記のショートカットになっています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">STDOUT&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span> &lt;span class="c1"># puts と同じ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">STDOUT&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">print&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span> &lt;span class="c1"># print と同じ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 親ディレクトリのパスを取得する</title><link>https://maku77.github.io/p/xqwzqn4/</link><pubDate>Mon, 07 Aug 2017 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/xqwzqn4/</guid><description>&lt;p>&lt;code>Dir::pwd&lt;/code> を使用すると、カレントディレクトリの絶対パスを取得できます。
取得したディレクトリパスを &lt;code>File::dirname&lt;/code> に渡すと、カレントディレクトリの親ディレクトリを取得できます。&lt;/p>
&lt;p>例えば、カレントディレクトリが &lt;code>C:\Users\maku\sample&lt;/code> であるときに、下記を実行すると、&lt;code>C:\Users\maku&lt;/code> が表示されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">dirname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">Dir&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">pwd&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下記のサンプルでは、カレントディレクトリから上位のディレクトリを順番にたどりながら出力しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="kp">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">temp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">dirname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">path&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">temp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">temp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例（D:\\users\\maku\\sample ディレクトリ内から実行した場合）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">D:\Users\maku\sample&amp;gt; ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">D:/Users/maku/sample
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">D:/Users/maku
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">D:/Users
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">D:/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: YAML ファイルを扱う</title><link>https://maku77.github.io/p/ai66hxc/</link><pubDate>Thu, 20 Oct 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ai66hxc/</guid><description>&lt;p>Ruby には &lt;a href="https://ja.wikipedia.org/wiki/YAML">YAML ファイル&lt;/a>を扱うためのモジュール &lt;code>yaml&lt;/code> が標準で搭載されています。&lt;/p>
&lt;div class="xNote">
 &lt;span class="xNote_title">☝️ ワンポイント&lt;/span>
 &lt;span class="xNote_body">YAML ファイルの拡張子は、&lt;code>.yaml&lt;/code> が使われていたり、&lt;code>.yml&lt;/code> が使われていたりしますが、&lt;a href="https://yaml.org">YAML 公式サイト&lt;/a>では &lt;code>.yaml&lt;/code> を使うことを推奨しているようです。&lt;/span>
&lt;/div>
&lt;h2 id="yaml-形式の文字列をパースする">YAML 形式の文字列をパースする&lt;/h2>
&lt;p>下記のように、&lt;code>YAML.load&lt;/code> メソッドを使用することで、YAML 形式のテキストをパースして Ruby のオブジェクトに変換してくれます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;yaml&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;lt;&amp;lt;END
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&lt;/span> &lt;span class="ss">key1&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">value1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">key2&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">value2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">key3&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">value3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">value3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">value3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">key4&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="ss">a1&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">a2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">b1&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">b2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">c1&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">c2&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">END&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ym&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">YAML&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">load&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">ym&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">{&amp;#34;key1&amp;#34;=&amp;gt;&amp;#34;value1&amp;#34;, &amp;#34;key2&amp;#34;=&amp;gt;&amp;#34;value2&amp;#34;, &amp;#34;key3&amp;#34;=&amp;gt;[&amp;#34;value3-1&amp;#34;, &amp;#34;value3-2&amp;#34;, &amp;#34;value3-3&amp;#34;], &amp;#34;key4&amp;#34;=&amp;gt;{&amp;#34;a1&amp;#34;=&amp;gt;&amp;#34;a2&amp;#34;, &amp;#34;b1&amp;#34;=&amp;gt;&amp;#34;b2&amp;#34;, &amp;#34;c1&amp;#34;=&amp;gt;&amp;#34;c2&amp;#34;}}
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="yaml-ファイルを読み込む">YAML ファイルを読み込む&lt;/h2>
&lt;p>&lt;code>YAML.load_file&lt;/code> メソッドを使用すると、YAML 形式のテキストファイルを読み込んで Ruby のオブジェクトに変換してくれます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">books.yaml&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">The Ruby Programming Language&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">author&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="l">David Flanagan, Yukihiro, Matsumoto]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Ruby Cookbook&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">author&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="l">Lucas Carlson, Leonard Richardson]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;yaml&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ym&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">YAML&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">load_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.yaml&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">ym&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">[{&amp;#34;name&amp;#34;=&amp;gt;&amp;#34;The Ruby Programming Language&amp;#34;, &amp;#34;author&amp;#34;=&amp;gt;[&amp;#34;David Flanagan&amp;#34;, &amp;#34;Yukihiro&amp;#34;, &amp;#34;Matsumoto&amp;#34;]}, {&amp;#34;name&amp;#34;=&amp;gt;&amp;#34;Ruby Cookbook&amp;#34;, &amp;#34;author&amp;#34;=&amp;gt;[&amp;#34;Lucas Carlson&amp;#34;, &amp;#34;Leonard Richardson&amp;#34;]}]
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ruby-のオブジェクトを-yaml-形式のテキストに変換する">Ruby のオブジェクトを YAML 形式のテキストに変換する&lt;/h2>
&lt;p>&lt;code>yaml&lt;/code> モジュールをロードしておくと、Ruby のオブジェクトを YAML 形式のテキストに変換するための &lt;code>Object#to_yaml&lt;/code> メソッドが使えるようになります。&lt;/p></description></item><item><title>Rubyメモ: ハッシュをループで処理する</title><link>https://maku77.github.io/p/bfkqdnw/</link><pubDate>Sat, 10 Sep 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/bfkqdnw/</guid><description>&lt;h2 id="ハッシュのキーと値をループで処理する">ハッシュのキーと値をループで処理する&lt;/h2>
&lt;p>&lt;code>Hash#each&lt;/code>（別名 &lt;code>Hash#each_pair&lt;/code>）を使用して、ハッシュに格納されたキーと値をループ処理することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key3&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">val&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> is &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">key1 is 100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key2 is 200
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key3 is 300&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ハッシュのキーのみ値のみをループで処理する">ハッシュのキーのみ、値のみをループで処理する&lt;/h2>
&lt;p>&lt;code>Hash#each_key&lt;/code> や &lt;code>Hash#each_value&lt;/code> を使用すると、ハッシュ要素のキーのみ、値のみをループ処理することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key3&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_key&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_value&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">value&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: invalid byte sequence in Windows-31J というエラーが出る場合</title><link>https://maku77.github.io/p/2pn937h/</link><pubDate>Wed, 13 Jul 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/2pn937h/</guid><description>&lt;p>外部リソースから取り込んだテキストなどを &lt;code>String#sub()&lt;/code> メソッドなどで処理していると、下記のようなエンコーディング形式に関するエラーが出ることがあります。&lt;/p>
&lt;pre tabindex="0">&lt;code>in `gsub!&amp;#39;: invalid byte sequence in US-ASCII
in `gsub!&amp;#39;: invalid byte sequence in Windows-31J
&lt;/code>&lt;/pre>&lt;p>このような場合は、下記のように環境変数でエンコーディング形式を明示するか、&lt;/p>
&lt;pre tabindex="0">&lt;code>$ export LANG=ja_JP.utf8
&lt;/code>&lt;/pre>&lt;p>あるいは、Ruby スクリプトの中で直接エンコーディング形式を設定すると動作するかもしれません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Encoding&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">default_external&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;utf-8&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列から時刻オブジェクト (Time) に変換する</title><link>https://maku77.github.io/p/rtt88eb/</link><pubDate>Tue, 12 Jul 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/rtt88eb/</guid><description>&lt;p>&lt;code>YYYY-MM-DD hh:mm:ss&lt;/code> といった形式の日時文字列から &lt;code>Time&lt;/code> オブジェクトを生成するには、&lt;code>Time.parse&lt;/code> メソッドを使用します。
&lt;code>Time&lt;/code> クラス自体はデフォルトで使用できますが、&lt;code>Time.parse&lt;/code> を使用するには、&lt;code>require 'time'&lt;/code> しておく必要があります。&lt;/p>
&lt;p>下記は、2016 年 1 月 1 日に実行した場合の例です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;time&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;21&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-01-21 （今月の 21 日を指定したことになる）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;21:54&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-01-01 21:54:00 +0900 （本日の 21 時 54 分）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;21:54:30&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-01-01 21:54:30 +0900 （本日の 21 時 54 分 30 秒）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2016-07-07&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-07-07 00:00:00 +0900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t5&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2016-07-07 21:54:30&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-07-07 21:54:30 +0900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t6&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2016-07-07T21:54:30&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-07-07 21:54:30 +0900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">t7&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;2016-07-07 21:54:30.567&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 2016-07-07 21:54:30 +0900&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列を 1 文字ずつに分割する</title><link>https://maku77.github.io/p/iz4nr7v/</link><pubDate>Tue, 05 Jul 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/iz4nr7v/</guid><description>&lt;h2 id="1-文字ずつ切り出す">1 文字ずつ切り出す&lt;/h2>
&lt;p>String クラスの &lt;code>chars&lt;/code> メソッド（別名 &lt;code>each_char&lt;/code>）を使用すると、文字列内の文字を 1 文字ずつ取り出しながら処理することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ABC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chars&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chars&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">ch&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">ch&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>$ ruby sample.rb
[&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]
A
B
C
&lt;/code>&lt;/pre>&lt;h2 id="1-文字ずつコードポイントを得る">1 文字ずつコードポイントを得る&lt;/h2>
&lt;p>文字列内の文字 1 文字ごとのコードポイントを取得するには、&lt;code>codepoints&lt;/code>（別名 &lt;code>each_codepoint&lt;/code>）を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># encoding: utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ABCあいう&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">codepoints&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;U+%04X &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>$ ruby sample.rb
U+0041 U+0042 U+0043 U+3042 U+3044 U+3046
&lt;/code>&lt;/pre>&lt;p>もとの文字とコードポイントの対応付けがわかるようにするには、下記のように &lt;code>ord&lt;/code> メソッドを組み合わせて使用するのがよいでしょう。
&lt;code>ord&lt;/code> は、その文字列の先頭の文字のコードポイントを返します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># encoding: utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ABCあいう&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chars&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">ch&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;U+%04X %s&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ch&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ord&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ch&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>U+0041 A
U+0042 B
U+0043 C
U+3042 あ
U+3044 い
U+3046 う
&lt;/code>&lt;/pre>&lt;h2 id="コラム-ruby-では-1-文字ずつに分割しても文字列型">コラム: Ruby では 1 文字ずつに分割しても文字列型&lt;/h2>
&lt;p>Java や C++ には、1 文字を表す &lt;code>char&lt;/code> 型がありますが、Ruby の場合はすべて文字列です。
そのため、下記のように分割したあとの型 (&lt;code>class&lt;/code>) を調べると、&lt;code>String&lt;/code> と表示されます。&lt;/p></description></item><item><title>Rubyメモ: 外部プログラムを実行可能か調べる／外部プログラムの絶対パスを取得する</title><link>https://maku77.github.io/p/stvk9gx/</link><pubDate>Mon, 04 Jul 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/stvk9gx/</guid><description>&lt;h2 id="コマンドが実行可能か調べる-which-クラス">コマンドが実行可能か調べる Which クラス&lt;/h2>
&lt;p>下記の &lt;code>Which&lt;/code> クラスは、指定した任意のコマンド（&lt;code>ruby&lt;/code> など）に対して下記のようなことを調べるメソッドを提供します。&lt;/p>
&lt;ul>
&lt;li>&lt;code>get_absolute_path(command)&lt;/code> &amp;ndash; そのコマンドの絶対パスを調べる&lt;/li>
&lt;li>&lt;code>command_exists?(command)&lt;/code> &amp;ndash; そのコマンドが実行可能か調べる&lt;/li>
&lt;/ul>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">which.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Which&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># PATH の通ったディレクトリのリスト&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@paths&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ENV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;PATH&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">PATH_SEPARATOR&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># OS がサポートしている拡張子のリスト&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@extensions&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@extensions&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="no">ENV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;PATHEXT&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="no">ENV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;PATHEXT&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 指定したコマンドの絶対パスを調べる（見つからない場合は nil）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">get_absolute_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@paths&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@extensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">ext&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exe&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="si">}#{&lt;/span>&lt;span class="n">ext&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">exe&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">executable?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">exe&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kp">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 指定したコマンドが実行可能か調べる（パスが通っているか調べる）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">command_exists?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">!!&lt;/span>&lt;span class="n">get_absolute_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">private&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">executable?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">executable?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">directory?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>下記は &lt;code>Which&lt;/code> クラスの使用例です。&lt;code>ruby&lt;/code>、&lt;code>python&lt;/code>、&lt;code>perl&lt;/code> コマンドの絶対パスと、それぞれのコマンドが実行可能かを調べています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">main.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">require_relative&lt;/span> &lt;span class="s1">&amp;#39;which&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">which&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">command_exists?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ruby&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">command_exists?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;python&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">command_exists?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;perl&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_absolute_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ruby&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;C:\Ruby\bin\ruby.exe&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_absolute_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;python&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;C:\Python35\python.exe&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">which&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get_absolute_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;perl&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; nil&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="which-クラスの実践的な使用例">Which クラスの実践的な使用例&lt;/h2>
&lt;p>下記は、任意のコマンドがある場合（ここでは &lt;code>adb&lt;/code> コマンドが使用できる場合）にのみ処理を継続するというプログラムの例です。&lt;/p></description></item><item><title>Rubyメモ: コマンドライン引数によるオプションに対応する (optparse)</title><link>https://maku77.github.io/p/r2ryc4t/</link><pubDate>Mon, 18 Apr 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/r2ryc4t/</guid><description>&lt;h2 id="optionparser-の基本">OptionParser の基本&lt;/h2>
&lt;p>&lt;code>OptionParser&lt;/code> クラスを使用すると、&lt;code>-a&lt;/code> や &lt;code>--add&lt;/code> といった形式のコマンドラインオプションを簡単に扱えます。&lt;/p>
&lt;p>&lt;code>OptionParser&lt;/code> で処理すべきオプションは、下記の &lt;code>on&lt;/code> メソッドで設定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">on&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">short&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">long&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">desc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="o">...&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">on&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">short&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">desc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="o">...&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">on&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">long&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">desc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="o">...&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>short&lt;/code> はショートオプションを表し、&lt;code>-a&lt;/code> や &lt;code>-d&lt;/code> のように指定します。
&lt;code>long&lt;/code> はロングオプションを表し、&lt;code>--add&lt;/code> や &lt;code>--delete&lt;/code> のように指定します。
&lt;code>desc&lt;/code> はそのオプションの説明文で、&lt;code>--help&lt;/code> オプションを指定して実行した場合に表示される説明文を設定します。
後ろのブロックには、そのオプションが指定された場合に実行されるコードを記述します。
オプションごとのパラメータを受け取ることもできます。&lt;/p>
&lt;p>すべてのオプションについて &lt;code>on&lt;/code> メソッドによる定義を完了したら、&lt;code>parse(ARGV)&lt;/code> を実行すれば、指定したオプションに一致するブロックが実行されていきます。&lt;/p>
&lt;h2 id="簡単なサンプル">簡単なサンプル&lt;/h2>
&lt;p>下記の例では、&lt;code>OptionParser&lt;/code> を使用して、&lt;code>-a (--add)&lt;/code> オプションと、&lt;code>-d (--delete)&lt;/code> オプションを処理しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;optparse&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">opt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">OptionParser&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">opt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;-a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--add&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;add an item&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Added&amp;#39;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">opt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;-d&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;--del&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;delete an item&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Deleted&amp;#39;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">opt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">ARGV&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下記は、それぞれのオプションを指定してプログラムを実行したときの実行例です。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ruby sample.rb -a
Added

$ ruby sample.rb -d
Deleted

$ ruby sample.rb -a -d
Added
Deleted
&lt;/code>&lt;/pre>&lt;p>&lt;code>OptionParser&lt;/code> を使用すると、デフォルトで &lt;code>-h (--help)&lt;/code> オプションが定義され、&lt;code>on&lt;/code> メソッドの &lt;code>desc&lt;/code> オプションで指定した説明文が表示されます。&lt;/p></description></item><item><title>Rubyメモ: グローバルスコープな実行コードを記述しない</title><link>https://maku77.github.io/p/yum82jz/</link><pubDate>Tue, 08 Dec 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/yum82jz/</guid><description>&lt;p>下記は、&lt;code>greet&lt;/code> メソッドだけを持つ簡単なクラスです。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">hello.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Hello&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello!&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">obj&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">greet&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>一見何の問題もないように見えますが、グローバルなスコープに実行可能なメインロジックが含まれているため、下記のような問題があります。&lt;/p>
&lt;ul>
&lt;li>他のコードからこのクラスを &lt;code>require_relative&lt;/code> で読み込んだときにメインロジックが実行されてしまう&lt;/li>
&lt;li>ユニットテストコードからこのクラスを読み込んだ場合もメインロジックが実行されてしまう&lt;/li>
&lt;/ul>
&lt;p>これを防ぐには、下記のようにメインロジックを &lt;code>if $0 == __FILE__&lt;/code> という条件で囲みます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Hello&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello!&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vg">$0&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="bp">__FILE__&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">obj&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">greet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>こうしておくと、&lt;code>ruby hello.rb&lt;/code> としたときだけメインロジックが実行され、別のファイルから &lt;code>require_relative&lt;/code> で読み込まれた場合には実行されないようになります。
&lt;code>$0&lt;/code> の値は &lt;code>ruby&lt;/code> コマンドに渡したファイル名になり、&lt;code>__FILE__&lt;/code> の値は記述されているスクリプトファイル自身の名前になるため、上記のようにしておけば、別ファイル経由で &lt;code>require_relative&lt;/code> した場合に、条件式が一致しなくなるという仕組みです。&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>実行するコマンド&lt;/th>
 &lt;th>&lt;code>$0&lt;/code> の値&lt;/th>
 &lt;th>&lt;code>__FILE__&lt;/code> の値&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;code>ruby hello.rb&lt;/code>&lt;/td>
 &lt;td>hello.rb&lt;/td>
 &lt;td>hello.rb&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>ruby other.rb&lt;/code>&lt;/td>
 &lt;td>other.rb&lt;/td>
 &lt;td>hello.rb&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>Ruby だけでなく、Perl や Python など、他のスクリプト言語でもほぼ同様の書き方をします。&lt;/p></description></item><item><title>Rubyメモ: 一時ディレクトリ／一時ファイルを使用する</title><link>https://maku77.github.io/p/vrcmada/</link><pubDate>Tue, 08 Dec 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/vrcmada/</guid><description>&lt;h1 id="一時ディレクトリテンポラリディレクトリ">一時ディレクトリ（テンポラリディレクトリ）&lt;/h1>
&lt;h2 id="os-の一時ディレクトリのパスを取得する">OS の一時ディレクトリのパスを取得する&lt;/h2>
&lt;p>&lt;code>tmpdir&lt;/code> ライブラリが提供する &lt;code>Dir.tmpdir&lt;/code> メソッドを使用すると、現在のシステム上で使用可能なテンポラリディレクトリのパスを取得することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;tmpdir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tmpdir&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;C:/Users/maku/AppData/Local/Temp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="一時ディレクトリを作成する">一時ディレクトリを作成する&lt;/h2>
&lt;p>&lt;code>Dir.mktmpdir&lt;/code> メソッドを使用すると、適切なパスにテンポラリディレクトリを作成し、そのパスを返してくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;tmpdir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mktmpdir&lt;/span> &lt;span class="c1">#=&amp;gt; C:/Users/maku/AppData/Local/Temp/d20151208-8924-qjbjiq&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ただし、上記のように単純に &lt;code>Dir.mktmpdir&lt;/code> を呼び出してしまうと、後片付けをするためには自力でそのディレクトリを削除しなければいけません。
下記のようにブロックを渡してやると、そのブロックを抜けた時に自動的にテンポラリディレクトリを削除してくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;tmpdir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mktmpdir&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">dir&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># dir の示すディレクトリの中で一時作業を行う&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">dir&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vg">$path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">dir&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exist?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vg">$path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; false（きれいさっぱり消されている）&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="一時ファイルテンポラリファイル">一時ファイル（テンポラリファイル）&lt;/h1>
&lt;p>&lt;code>tempfile&lt;/code> ライブラリの提供する &lt;code>Tempfile&lt;/code> クラスを使用すると、テンポラリファイルを簡単に作成することができます。
&lt;code>Tempfile.open&lt;/code> メソッドの戻り値は、通常の &lt;code>File&lt;/code> オブジェクトと同じように扱うことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;tempfile&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Tempfile&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;foo&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># テンポラリファイルを使用した処理&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;C:/Users/maku/AppData/Local/Temp/foo20151208-7572-u08rd5&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">ensure&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unlink&lt;/span> &lt;span class="c1"># 必要なくなったら削除するのが望ましい&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の例では &lt;code>unlink&lt;/code> メソッドでテンポラリファイルを削除していますが、&lt;code>unlink&lt;/code> せずに &lt;code>close&lt;/code> だけしておくと、後から再び &lt;code>open&lt;/code> して、テンポラリファイルに書き込んだ内容を読み出すことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;tempfile&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Tempfile&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;foo&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># テンポラリファイルに書き込む&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;BBB&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;CCC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">ensure&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span> &lt;span class="c1"># 閉じるだけで unlink はしない&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># テンポラリファイルの内容を読み込む&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: Gem パッケージを作成する (1) 基本</title><link>https://maku77.github.io/p/k6gcrgj/</link><pubDate>Fri, 04 Dec 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/k6gcrgj/</guid><description>&lt;h2 id="作成する-gem-パッケージのゴール">作成する Gem パッケージのゴール&lt;/h2>
&lt;p>ここでは、&lt;strong>hello_gem&lt;/strong> という名前の Gem パッケージを作成してみます。
下記ができることをゴールとします。&lt;/p>
&lt;ol>
&lt;li>&lt;code>gem install&lt;/code> コマンドで Gem をインストールできる&lt;/li>
&lt;li>Ruby スクリプトの中から &lt;code>require 'hello_gem'&lt;/code> と読み込むと、&lt;code>HelloGem&lt;/code> クラスを参照できるようになる&lt;/li>
&lt;/ol>
&lt;p>Gem に関する命名規則などは、&lt;a href="../p/7wv9hrf/">Ruby のコーディングスタイル&lt;/a> を参照してください。&lt;/p>
&lt;h2 id="gem-パッケージを作成する">Gem パッケージを作成する&lt;/h2>
&lt;h3 id="gem-パッケージ内部の構成">Gem パッケージ内部の構成&lt;/h3>
&lt;p>Gem パッケージには、&lt;code>xxx.gemspec&lt;/code> というファイルを作成する必要があります。
Ruby のソースコード自体は &lt;code>lib&lt;/code> ディレクトリに格納するので、プロジェクトのディレクトリには下記のようなファイルが配置されることになります。&lt;/p>
&lt;ul>
&lt;li>hello_gem.gemspec&lt;/li>
&lt;li>lib/hello_gem.rb&lt;/li>
&lt;/ul>
&lt;p>上記のように &lt;code>hello_gem.rb&lt;/code> を配置しておくことで、Gem のユーザは、&lt;code>require 'hello_gem'&lt;/code> とロードできるようになります。&lt;/p>
&lt;h3 id="スクリプトを作成する">スクリプトを作成する&lt;/h3>
&lt;p>下記は、メインのライブラリとなる &lt;code>hello_gem.rb&lt;/code> の内容です。
単純に挨拶テキストを出力するだけの機能を提供します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">lib/hello_gem.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">HelloGem&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nc">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Hello &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>クラス名が複数の単語で構成される場合は、ファイル名の中ではアンダースコア (&lt;code>_&lt;/code>) で単語を区切って表現するのが Gem の世界の慣例です。
上記の場合では、クラス名が &lt;code>HelloGem&lt;/code> なので、ファイル名は &lt;code>hello_gem.rb&lt;/code> となっています。
詳しいネーミングルールは&lt;a href="../p/7wv9hrf/">こちら&lt;/a>を参照してください。&lt;/p>
&lt;p>ライブラリの作成が完了したら、簡単にテストしておきましょう。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ irb -Ilib
irb(main):001:0&amp;gt; require &amp;#39;hello_gem&amp;#39;
=&amp;gt; true
irb(main):002:0&amp;gt; HelloGem.greet(&amp;#39;maku&amp;#39;)
Hello maku!
=&amp;gt; nil
&lt;/code>&lt;/pre>&lt;p>&lt;code>irb&lt;/code> コマンドのパラメータに、&lt;code>-Ilib&lt;/code> を指定していることに注意してください。
これは、&lt;code>hello_gem.rb&lt;/code> の格納されている &lt;code>lib&lt;/code> ディレクトリをロードパスに追加するためです。&lt;/p></description></item><item><title>Rubyメモ: Gem パッケージを作成する (2) 実行可能コマンドを追加する</title><link>https://maku77.github.io/p/sf4zv8i/</link><pubDate>Fri, 04 Dec 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sf4zv8i/</guid><description>&lt;p>RubyGems には、実行可能なコマンドをインストールできるという面白い仕組みが備わっています。
ここでは、下記のようなことを実現してみます。&lt;/p>
&lt;ol>
&lt;li>&lt;code>gem install&lt;/code> コマンドでインストール可能な Gem パッケージを作成する&lt;/li>
&lt;li>Gem をインストールし終わったら、&lt;code>hello&lt;/code> というコマンドが使えるようになる&lt;/li>
&lt;/ol>
&lt;h2 id="gem-に実行可能コマンドを追加する">Gem に実行可能コマンドを追加する&lt;/h2>
&lt;h3 id="gem-パッケージ内部の構成">Gem パッケージ内部の構成&lt;/h3>
&lt;p>実行可能コマンドをインストールできる Gem を作成するには、&lt;code>bin&lt;/code> ディレクトリに実行可能ファイルを格納し、gemspec ファイルの &lt;code>executables&lt;/code> フィールドにそのパスを登録するだけです。
プロジェクトのディレクトリ構成は、例えば以下のようになります。&lt;/p>
&lt;ul>
&lt;li>bin/hello（実行可能なコマンド）&lt;/li>
&lt;li>lib/hello_gem.rb（スクリプト本体）&lt;/li>
&lt;li>hello_gem.gemspec（Gem 仕様）&lt;/li>
&lt;/ul>
&lt;h3 id="実行ファイルの作成">実行ファイルの作成&lt;/h3>
&lt;p>実行可能ファイルは、どのような形式でもよいですが、ここでは Ruby スクリプトとして作成します。
Ruby スクリプトで作成しておけば、&lt;strong>Linux、macOS、Windows、どのプラットフォームでも実行可能&lt;/strong>なコマンドとして作成できます。
Ruby スクリプトの中では、&lt;code>lib/hello_gem.rb&lt;/code> が読み込めることを前提に記述して構いません。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">bin/hello&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/env ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;hello_gem&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">HelloGem&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">greet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;maku&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>スクリプトを直接実行できるようにするために、実行権限を付与しておきます（Linux のみ）。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ chmod a+x bin/hello
&lt;/code>&lt;/pre>&lt;p>実行できるか確認します。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ruby -Ilib bin/hello
Hello maku!
&lt;/code>&lt;/pre>&lt;h3 id="gemspec-に実行可能ファイルを追加する">gemspec に実行可能ファイルを追加する&lt;/h3>
&lt;p>作成した実行可能ファイル &lt;code>hello&lt;/code> を gemspec ファイルに登録します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">hello_gem.gemspec&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Gem&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Specification&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;hello_gem&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;0.0.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">date&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;2015-12-04&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">summary&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Hello Gem!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">description&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;The first Gem package for practice&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">authors&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;Maku Makkuma&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">email&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;maku@example.com&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">homepage&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;http://example.com/hello_gem&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">license&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;MIT&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">files&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;lib/hello_gem.rb&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">executables&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;hello&amp;#39;&lt;/span> &lt;span class="c1"># これを追加&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>実行可能ファイルが格納されているディレクトリのパスはどこにも指定されていないことに注目してください。
デフォルトでは &lt;code>bin&lt;/code> ディレクトリが使用されるため、上記のように何も指定しなくて問題ありませんが、ディレクトリを変更する場合は、&lt;code>bindir&lt;/code> フィールドで指定してください。&lt;/p></description></item><item><title>Rubyメモ: RubyGems とは</title><link>https://maku77.github.io/p/ega8g26/</link><pubDate>Sun, 22 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ega8g26/</guid><description>&lt;h2 id="rubygems-とは">RubyGems とは&lt;/h2>
&lt;p>RubyGems は、Ruby の世界で標準となっている&lt;strong>パッケージ管理システム&lt;/strong>です。
&lt;strong>Gem&lt;/strong> と呼ばれる単位のパッケージを、依存関係を自動的に解決しながらインストールできます。
多くの Gem パッケージが &lt;a href="https://rubygems.org/">RubyGems.org&lt;/a> のリポジトリで管理されており、&lt;strong>gem&lt;/strong> コマンドを使用して検索やインストールを簡単に行えます。
RubyGems の詳しい説明は、下記の RubyGems ガイドでひととおり確認できます。&lt;/p>
&lt;ul>
&lt;li>参考: &lt;a href="http://guides.rubygems.org/">RubyGems Guides&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>RubyGems の興味深いところは、プログラムから使用するライブラリだけではなく、端末から実行可能なコマンドをインストールする機能があるところです。
例えば、下記のように &lt;code>rake&lt;/code> という Gem パッケージをインストールすると、プログラムから利用する API がインストールされるだけでなく、&lt;code>rake&lt;/code> というコマンドも実行できるようになります。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem install rake
&lt;/code>&lt;/pre>&lt;h2 id="gem-コマンドの使用例">gem コマンドの使用例&lt;/h2>
&lt;h3 id="gem-の検索">Gem の検索&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gem search travis &lt;span class="c1"># travis という名前を含む Gem を検索&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem search ^rails &lt;span class="c1"># rails という名前で始まる Gem を検索&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem search ^rails$ &lt;span class="c1"># rails という名前に完全一致する Gem を検索&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem search ^rails$ -d &lt;span class="c1"># 詳細情報付きで表示&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="インストール済みの-gem-を調べる">インストール済みの Gem を調べる&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gem list &lt;span class="c1"># インストール済みの Gem をすべて表示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem list http &lt;span class="c1"># インストール済みの Gem のうち http という名前を含むものを検索&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="gem-のインストール">Gem のインストール&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gem install rvm &lt;span class="c1"># rvm という Gem をインストール&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem install rvm --no-doc &lt;span class="c1"># ドキュメントの生成はしない&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="gem-のアンインストール">Gem のアンインストール&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gem uninstall rvm &lt;span class="c1"># rvm という Gem をアンインストール&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ gem clean &lt;span class="c1"># インストール済み Gem のうち最新バージョンを残してアンインストール&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ドキュメント用-web-サーバを起動">ドキュメント用 Web サーバを起動&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gem server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記を実行してから http://localhost:8808 にアクセスすれば、インストール済みの Gem のドキュメントを一覧で確認できます。&lt;/p></description></item><item><title>Rubyメモ: 勉強用に Gem パッケージをダウンロードする</title><link>https://maku77.github.io/p/ovi2oa5/</link><pubDate>Sun, 22 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ovi2oa5/</guid><description>&lt;p>単純に、ある Gem のソースコードを確認してみたい場合などは、&lt;code>gem fetch&lt;/code> コマンドを使用すると、Gem ファイルそのものをカレントディレクトリにダウンロードできます。
下記の例では、&lt;code>rvm&lt;/code> パッケージの Gem ファイルをダウンロードしています。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem fetch rvm
Fetching: rvm-1.11.3.9.gem (100%)
Downloaded rvm-1.11.3.9
&lt;/code>&lt;/pre>&lt;p>ダウンロードされた Gem ファイルを展開するには、&lt;code>gem unpack&lt;/code> コマンドを使用します。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem unpack rvm
Unpacked gem: &amp;#39;/Users/maku/sand-box/rvm-1.11.3.9&amp;#39;
&lt;/code>&lt;/pre>&lt;p>これで、Gem のソースコードを参照できます。
Gem のソースコードは、通常 &lt;code>lib&lt;/code> ディレクトリ以下に格納されています。&lt;/p></description></item><item><title>Rubyメモ: 知っておくべき Ruby 関連ツール</title><link>https://maku77.github.io/p/wj4bj3p/</link><pubDate>Sun, 22 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wj4bj3p/</guid><description>&lt;h2 id="すべては-rubygems-から始まる">すべては RubyGems から始まる&lt;/h2>
&lt;p>&lt;strong>RubyGems&lt;/strong> は、デファクトスタンダードとなった Ruby のパッケージ管理システムです。&lt;code>gem&lt;/code> コマンドで &lt;strong>Gem&lt;/strong> というパッケージをインストールします。Ruby 関連の多くのライブラリやコマンドは、今やこの &lt;code>gem&lt;/code> コマンドでインストールすることができるようになっており、後述の &lt;code>rdoc&lt;/code>, &lt;code>yard&lt;/code>, &lt;code>rake&lt;/code>, &lt;code>rvm&lt;/code> などは全て &lt;strong>Gem&lt;/strong> として提供されています。&lt;/p>
&lt;h2 id="知っておくべき-gem-の紹介">知っておくべき Gem の紹介&lt;/h2>
&lt;h3 id="環境関連">環境関連&lt;/h3>
&lt;h4 id="bundlerhttpsrubygemsorggemsbundler">&lt;a href="https://rubygems.org/gems/bundler/">bundler&lt;/a>&lt;/h4>
&lt;p>プロジェクトで使用する Gem パッケージを一括でインストールできるようにするツールです。&lt;code>Gemfile&lt;/code> というファイルに必要な Gem を記述しておくと、&lt;code>bundle install&lt;/code> コマンドで一括インストールできるようになります。&lt;/p>
&lt;p>&lt;code>gem install&lt;/code> コマンドが、システム全体で使用する Gem をインストールするのに比べ、&lt;code>bundle install&lt;/code> コマンドは、特定のプロジェクト用に限られたスコープで使用する Gem をインストールします。&lt;/p>
&lt;h4 id="rakehttpsrubygemsorggemsrake">&lt;a href="https://rubygems.org/gems/rake/">rake&lt;/a>&lt;/h4>
&lt;p>C/C++ の世界でいう Make の Ruby 版です（Java であれば ant や Gradle に相当するもの、JavaScript であれば Grunt や gulp に相当するものです）。&lt;code>Rakefile&lt;/code> という Ruby 構文で記述されたファイルにビルドタスクを定義していくことができます。例えば、rdoc による API ドキュメント生成、RSpec によるユニットテスト実行、Gem のパッケージング処理といったタスクを定義することができます。&lt;/p>
&lt;h4 id="rvmhttpsrubygemsorggemsrvm">&lt;a href="https://rubygems.org/gems/rvm/">rvm&lt;/a>&lt;/h4>
&lt;p>Ruby 実行環境を管理するツールです。複数バージョンの Ruby 処理系を切り替えて使うことができるようになるので、様々なバージョンの Ruby でプログラムの実行テストを行うことができます。&lt;/p></description></item><item><title>Rubyメモ: Gem パッケージのインストール先を調べる</title><link>https://maku77.github.io/p/p2ib8fk/</link><pubDate>Sat, 21 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/p2ib8fk/</guid><description>&lt;h2 id="gem-パッケージのインストール先ディレクトリを調べる">Gem パッケージのインストール先ディレクトリを調べる&lt;/h2>
&lt;p>&lt;code>gem install&lt;/code> コマンドで Gem をインストールしたときに、どのディレクトリにインストールされるかを調べるには以下のようにします。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem environment gemdir
/Users/maku/.rvm/gems/ruby-2.2.1
&lt;/code>&lt;/pre>&lt;p>&lt;code>gem environment&lt;/code> コマンドでは、RubyGems 関連のさまざまな情報を調べることができます。
一度パラメータなしで実行してみるとよいでしょう。&lt;/p>
&lt;h2 id="特定の-gem-パッケージの場所を調べる">特定の Gem パッケージの場所を調べる&lt;/h2>
&lt;p>指定した Gem パッケージが実際にどこにインストールされているかを調べるには、&lt;code>gem which&lt;/code> コマンドを使用します。
下記の例では、&lt;code>test-unit&lt;/code> パッケージの実体がどこにあるかを調べています。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem which test-unit
/Users/maku/.rvm/gems/ruby-2.2.1/gems/test-unit-3.1.5/lib/test-unit.rb
&lt;/code>&lt;/pre></description></item><item><title>Rubyメモ: require で他のライブラリを読み込む</title><link>https://maku77.github.io/p/f49nx8n/</link><pubDate>Sat, 21 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/f49nx8n/</guid><description>&lt;p>&lt;code>require&lt;/code> メソッドを使用すると、システムにインストールされたライブラリや、相対パス指定でライブラリを読み込むことができます。&lt;/p>
&lt;h2 id="システムにインストールされたライブラリを読み込む-require">システムにインストールされたライブラリを読み込む (require)&lt;/h2>
&lt;p>下記は、システムにインストールされたライブラリを読み込む例です。
この構文では、組み込み変数の &lt;code>$LOAD_PATH&lt;/code> に設定されたディレクトリ以下にインストールされたライブラリをロードできます。
読み込むファイルの拡張子 &lt;code>.rb&lt;/code> は省略することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;sample&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考: &lt;a href="../p/pgsu6vb/">ユーザライブラリの検索パスを調べる&lt;/a>&lt;/p>
&lt;h2 id="相対パスでライブラリを読み込む-require_relative">相対パスでライブラリを読み込む (require_relative)&lt;/h2>
&lt;p>例えば、下記のような &lt;code>greet&lt;/code> メソッドを提供するライブラリがあるとします。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">mylib.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">greet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>同じディレクトリにある別のスクリプトから、この &lt;code>mylib.rb&lt;/code> というライブラリを読み込んで使用するには、以下のように &lt;code>require_relative&lt;/code> メソッドでライブラリ名を指定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">require_relative&lt;/span> &lt;span class="s1">&amp;#39;mylib&amp;#39;&lt;/span> &lt;span class="c1"># 同じディレクトリ内の mylib.rb を読み込む&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">greet&lt;/span> &lt;span class="c1"># 上記のライブラリが提供する関数の呼び出し&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello!&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>もちろん、上位のディレクトリのファイルや、下位のディレクトリのファイルも読み込むことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">require_relative&lt;/span> &lt;span class="s1">&amp;#39;../mylib&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">require_relative&lt;/span> &lt;span class="s1">&amp;#39;foo/mylib&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="コラム-ruby-18-以前の場合">コラム: Ruby 1.8 以前の場合&lt;/h3>
&lt;p>Ruby 1.8 以前には、&lt;code>require_relative&lt;/code> メソッドがなかったため、&lt;code>require&lt;/code> メソッドを使用して、相対パスによるライブラリのロードなどを行っていました。
その際に、ありがちな間違いは、下記のように記述してしまうことです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;./mylib&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のようなパス指定をすると、そのファイルからの相対パスではなく、&lt;code>ruby&lt;/code> コマンドを実行したディレクトリからの相対パスという意味になってしまうため、実行するディレクトリによって動作が変わってしまいます。
これを防ぐためには、下記のように記述しなければいけませんでした。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dirname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">__FILE__&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s1">&amp;#39;mylib&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ruby 1.9 以降では、&lt;code>require_relative&lt;/code> が使用できるため、このような面倒な記述は必要なくなりました。&lt;/p></description></item><item><title>Rubyメモ: test-unit によるユニットテスト</title><link>https://maku77.github.io/p/wshqogt/</link><pubDate>Sat, 21 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wshqogt/</guid><description>&lt;p>Ruby のユニットテストフレームワークとして、&lt;strong>test-unit&lt;/strong> という RubyGems モジュールが提供されています。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.rubydoc.info/gems/test-unit/">http://www.rubydoc.info/gems/test-unit/&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://test-unit.rubyforge.org/test-unit/ja/Test/Unit.html">http://test-unit.rubyforge.org/test-unit/ja/Test/Unit.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="test-unit-のインストール">test-unit のインストール&lt;/h1>
&lt;p>test-unit は &lt;code>gem&lt;/code> コマンドで簡単にインストールできます。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem install test-unit
&lt;/code>&lt;/pre>&lt;p>インストールが完了すると、Ruby スクリプトの中から &lt;code>require 'test/unit'&lt;/code> できるようになります。&lt;/p>
&lt;h1 id="test-unit-の基本的な使い方">test-unit の基本的な使い方&lt;/h1>
&lt;p>test-unit によるユニットテストを記述するには、下記のようにコードを記述していきます。&lt;/p>
&lt;ul>
&lt;li>&lt;code>require 'test/unit'&lt;/code> する&lt;/li>
&lt;li>&lt;code>Test::Unit::TestCase&lt;/code> を継承したクラスを作る&lt;/li>
&lt;li>&lt;code>test&lt;/code> で始まるテストメソッドを作る&lt;/li>
&lt;li>&lt;code>assert_xxx&lt;/code> メソッドで実行結果と期待結果を比較する&lt;/li>
&lt;/ul>
&lt;p>下記はとても簡単なユニットテストの例です。
この例では、&lt;code>1 + 2&lt;/code> という足し算の計算結果が、&lt;code>3&lt;/code> という期待値と等しいか（あるいは引き算の結果が正しいか）をテストしています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample_test.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;test/unit&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">SampleTest&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="no">Test&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Unit&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">TestCase&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">test_add&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assert_equal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">test_subtract&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assert_equal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>このコードは、そのままテストコードとして実行することができるようになっています（&lt;code>require 'test/unit'&lt;/code> による効果）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">テスト実行&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample_test.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Loaded suite sample_test
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Started
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">..
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Finished in 0.000548 seconds.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">---------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">2 tests, 2 assertions, 0 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">100% passed
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">---------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">3649.64 tests/s, 3649.64 assertions/s
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>無事、2 つのテストメソッドをパスしました。&lt;/p></description></item><item><title>Rubyメモ: ユーザライブラリの検索パスを調べる</title><link>https://maku77.github.io/p/pgsu6vb/</link><pubDate>Sat, 21 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/pgsu6vb/</guid><description>&lt;p>Ruby を実行しているとき &lt;code>$LOAD_PATH&lt;/code> という変数を参照すると、Ruby の実行環境がどのようなディレクトリからライブラリを検索するかを調べることができます。
下記は、著者の macOS で確認したときの例です。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ruby -e &amp;#39;puts $LOAD_PATH&amp;#39;
/Library/Ruby/Site/2.0.0
/Library/Ruby/Site/2.0.0/x86_64-darwin15
/Library/Ruby/Site/2.0.0/universal-darwin15
/Library/Ruby/Site
...
&lt;/code>&lt;/pre>&lt;p>通常のユーザライブラリは、&lt;code>Site&lt;/code> や &lt;code>site_ruby&lt;/code> といったディレクトリに置きます。
その下の &lt;code>2.0.0&lt;/code> というディレクトリは、Ruby のバージョンに依存したユーザライブラリを格納します。
&lt;code>x86_64-darwin15&lt;/code> や &lt;code>i386-cygwin&lt;/code> といったディレクトリには、CPU アーキテクチャや OS に依存したユーザライブラリを格納します。&lt;/p></description></item><item><title>Rubyメモ: 文字列を結合する</title><link>https://maku77.github.io/p/y2qwaqw/</link><pubDate>Sat, 21 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/y2qwaqw/</guid><description>&lt;h2 id="2-つの文字列の結合">2 つの文字列の結合&lt;/h2>
&lt;p>Ruby で文字列を結合するには、&lt;code>+&lt;/code> 演算子を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;BBB&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">s1&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">s2&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;AAABBB&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="末尾への結合">末尾への結合&lt;/h2>
&lt;p>既存の文字列変数の末尾に、別の文字列を追加するには &lt;code>concat&lt;/code> メソッド、あるいは &lt;code>&amp;lt;&amp;lt;&lt;/code> や &lt;code>+=&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;BBB&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;CCC&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;AAABBBCCC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="先頭への結合">先頭への結合&lt;/h2>
&lt;p>既存の文字列変数の先頭に、別の文字列を追加するには以下のように &lt;code>insert&lt;/code> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">insert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;BBB&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;BBBAAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="文字列リテラルの結合">文字列リテラルの結合&lt;/h2>
&lt;p>文字列リテラル同士をスペースで区切って並べておくと、それらはコンパイル時に結合されます。
ダブルクォーテーションで囲まれた文字列内では、適切に式展開が行われます。
間のスペースの数は結合結果に影響しません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;maku&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;BBB&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;AAABBBmaku&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: ruby-mp3info で MP3 ファイルのタグ情報を取得／修正する</title><link>https://maku77.github.io/p/25f969i/</link><pubDate>Wed, 28 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/25f969i/</guid><description>&lt;h1 id="mp3-ファイルの-id3-タグについて">MP3 ファイルの ID3 タグについて&lt;/h1>
&lt;p>MP3 の ID3 タグ (ID3v1/ID3v2) に関しては、下記の Wikipedia のサイトがわかりやすいです。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ja.wikipedia.org/wiki/ID3%E3%82%BF%E3%82%B0">ID3タグ - Wikipedia&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="タグ内のエンコーディング形式">タグ内のエンコーディング形式&lt;/h2>
&lt;ul>
&lt;li>ID3v1 &amp;ndash; 定義なし&lt;/li>
&lt;li>ID3v1.1 &amp;ndash; 定義なし&lt;/li>
&lt;li>ID3v2.2 &amp;ndash; UTF-16&lt;/li>
&lt;li>ID3v2.3 &amp;ndash; UTF-16&lt;/li>
&lt;li>ID3v2.4 &amp;ndash; UTF-16 および UTF-8&lt;/li>
&lt;/ul>
&lt;p>ID3v1 規格の頃のエンコーディング形式には規定がなく、昔 Windows で作成した MP3 ファイルが Shift_JIS でタグ情報を保存していたりすると、Unicode を前提とした音楽プレイヤーなどで文字化けが発生したりします。
現状では、最も普及している ID3v2.3 を使い、UTF-16 で保存しておくのがよいようです。&lt;/p>
&lt;h1 id="ruby-mp3info-のインストール">ruby-mp3info のインストール&lt;/h1>
&lt;p>moumar さんの &lt;strong>ruby-mp3info&lt;/strong> という Gem パッケージを使用すると、MP3 ファイルのタグ情報を簡単に扱うことができます。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.rubydoc.info/github/moumar/ruby-mp3info/">Documentation for ruby-mp3info&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Ruby スクリプトから &lt;code>require 'mp3info'&lt;/code> とするためには、まずは Gem パッケージをインストールしておく必要があります。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ sudo gem install mp3info
&lt;/code>&lt;/pre>&lt;h1 id="タグ情報の取得">タグ情報の取得&lt;/h1>
&lt;p>&lt;code>Mp3Info&lt;/code> クラスを使って MP3 ファイルをオープンすると、タグ情報（ID3v1 および ID3v2）にアクセスすることができます。&lt;/p></description></item><item><title>Rubyメモ: 環境変数を扱う</title><link>https://maku77.github.io/p/jijhyxm/</link><pubDate>Fri, 16 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/jijhyxm/</guid><description>&lt;h1 id="環境変数を参照する">環境変数を参照する&lt;/h1>
&lt;p>Ruby で環境変数を参照するには、組み込みで用意されている &lt;code>ENV&lt;/code> をハッシュとしてアクセスします。
下記の例では、環境変数 &lt;code>HOME&lt;/code> の内容を取得しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">ENV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;HOME&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="環境変数の列挙">環境変数の列挙&lt;/h1>
&lt;p>すべての環境変数は、例えば下記のように列挙できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">ENV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> : &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="環境変数が設定されているか調べる">環境変数が設定されているか調べる&lt;/h1>
&lt;p>&lt;code>ENV&lt;/code> はハッシュのようにアクセスできるので、下記のようにして特定の環境変数が設定されているかを調べることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="no">ENV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">has_key?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;HOME&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;OK&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: Ruby の対話型プログラムを起動する</title><link>https://maku77.github.io/p/scxfak3/</link><pubDate>Thu, 15 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/scxfak3/</guid><description>&lt;h2 id="irb-を使用する">irb を使用する&lt;/h2>
&lt;p>Ruby には、標準の対話型プログラムとして &lt;code>irb&lt;/code> コマンドが搭載されています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="n">irb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">irb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">):&lt;/span>&lt;span class="mo">001&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">30&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">irb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">):&lt;/span>&lt;span class="mo">002&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;ABC&amp;#39;&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s2">&amp;#34;ABCABCABC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">irb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">):&lt;/span>&lt;span class="mo">003&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="pry-を使用する">pry を使用する&lt;/h2>
&lt;p>&lt;code>irb&lt;/code> よりもカラフルな出力を行ってくれる &lt;code>pry&lt;/code> というコマンドが提供されています。
&lt;code>pry&lt;/code> は、RubyGems で簡単にインストールすることができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">pry のインストール&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ gem install pry&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>起動するときは、単純に &lt;code>pry&lt;/code> と実行するだけです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span> &lt;span class="n">pry&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="n">pry&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;ABC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">ABC&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="kp">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="n">pry&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nb">p&lt;/span> &lt;span class="s1">&amp;#39;ABC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;ABC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s2">&amp;#34;ABC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="n">pry&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: キーボードからの入力を取得する (STDIN.gets/readline)</title><link>https://maku77.github.io/p/yf9e2j2/</link><pubDate>Thu, 15 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/yf9e2j2/</guid><description>&lt;h2 id="stdin-でキーボードからの入力を取得する">STDIN でキーボードからの入力を取得する&lt;/h2>
&lt;p>キーボードからのユーザー入力を一行分取得するには、&lt;code>STDIN.gets&lt;/code> を使用します。
取得した入力の末尾には改行文字が残ったままであることに注意してください。
改行文字は &lt;code>chomp&lt;/code> を利用して削除できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">STDIN&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;ABC\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chomp&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;ABC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>キーボードからの入力を繰り返し取得したい場合は、下記のような &lt;code>while&lt;/code> ループで処理できます。
&lt;code>Ctrl-Z&lt;/code> などで入力を終了させたときに、&lt;code>IO#gets&lt;/code> が &lt;code>nil&lt;/code> を返すことを利用してループを終了しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">STDIN&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="readline-モジュールでキーボードからの入力を取得する">readline モジュールでキーボードからの入力を取得する&lt;/h2>
&lt;p>readline モジュールを使用すると、プロンプトを表示しながらユーザー入力を取得する処理を簡単に記述できます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;readline&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Readline&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">readline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;gt; &amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gp">&amp;gt;&lt;/span> AAA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">AAA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="gp">&amp;gt;&lt;/span> BBB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BBB
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="gp">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>また、readline モジュールでキーボード入力を取得している最中は、&lt;code>Ctrl-A&lt;/code> によるカーソルジャンプなど、&lt;strong>Emacs 風のキーボードショートカットが使える&lt;/strong>ようになります。
さらに、下記のように第 2 引数を &lt;code>true&lt;/code> にして呼び出すことで、&lt;code>Ctrl-P&lt;/code>、&lt;code>Ctrl-N&lt;/code> で入力履歴をたどれるようになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Readline&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">readline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;gt; &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kp">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: キーボードからパスワードの入力を取得する</title><link>https://maku77.github.io/p/xmkp7u4/</link><pubDate>Thu, 15 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/xmkp7u4/</guid><description>&lt;h1 id="ionoecho-による入力表示の抑制">IO#noecho による入力表示の抑制&lt;/h1>
&lt;p>&lt;code>IO#noecho&lt;/code> を利用すると、キーボードから入力した内容を画面上に表示させずに、入力を取得することができます。
下記のようにして、パスワードの入力プロンプトを表示することができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;io/console&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">read_password&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="s1">&amp;#39;Input your password: &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">password&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">STDIN&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">noecho&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="ss">:gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">password&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chomp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">read_password&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Input your password: （キーボードから ABC と入力しても、その文字は表示されない）
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">ABC
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>STDIN.noecho&lt;/code> でパスワードを入力した後は、改行が出力されないので、自力で &lt;code>puts&lt;/code> を呼び出しています。また、&lt;code>gets&lt;/code> で取得したパスワードの末尾には改行文字が残っているので、&lt;code>chomp&lt;/code> で削除していることに注意してください。&lt;/p></description></item><item><title>Rubyメモ: プロキシ経由で gem コマンドを利用する</title><link>https://maku77.github.io/p/gsmh9o2/</link><pubDate>Thu, 15 Oct 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/gsmh9o2/</guid><description>&lt;p>&lt;code>gem&lt;/code> コマンドはインターネット上のサーバーから Ruby のパッケージをダウンロードしますが、プロキシ環境下で接続がうまくいかない場合は下記のようなエラーが発生します。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ gem install pry
ERROR: Could not find a valid gem &amp;#39;pry&amp;#39; (&amp;gt;= 0), here is why:
 Unable to download data from https://rubygems.org/
 - no such name (https://rubygems.org/latest_specs.4.8.gz)
&lt;/code>&lt;/pre>&lt;p>&lt;code>gem&lt;/code> コマンドのプロキシ設定は下記のように行います。&lt;/p>
&lt;h3 id="gem-コマンドのパラメータで指定する方法">gem コマンドのパラメータで指定する方法&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ gem install &amp;lt;packageName&amp;gt; -p http://proxy.example.com
$ gem install &amp;lt;packageName&amp;gt; -p http://proxy.example.com:port
$ gem install &amp;lt;packageName&amp;gt; -p http://user:pass@proxy.example.com:port
&lt;/code>&lt;/pre>&lt;h3 id="環境変数で指定する方法">環境変数で指定する方法&lt;/h3>
&lt;p>環境変数 &lt;code>http_proxy&lt;/code> にプロキシの設定を行っておけば、&lt;code>gem install&lt;/code> の際にプロキシを指定する必要がなくなります。&lt;/p></description></item><item><title>Rubyメモ: 配列の要素をランダムに取得する</title><link>https://maku77.github.io/p/ggqktqi/</link><pubDate>Tue, 01 May 2012 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ggqktqi/</guid><description>&lt;p>下記の例では、&lt;code>rand()&lt;/code> を利用して配列内の要素をランダムに取得しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="nb">rand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 配列をランダムに並び替える (sort_by)</title><link>https://maku77.github.io/p/rdck2o4/</link><pubDate>Tue, 01 May 2012 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/rdck2o4/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort_by!&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nb">rand&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/xt2xzxi/">配列をソートする（昇順ソート／降順ソート）(sort)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 指定した値と同じ値を持つ要素を削除する</title><link>https://maku77.github.io/p/kjxrxs6/</link><pubDate>Sun, 29 Jan 2012 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/kjxrxs6/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1"># =&amp;gt; [2, 3, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Array#delete&lt;/code> は、指定した値に一致する要素をすべて削除します。
配列そのものを変更することに注意してください。&lt;/p></description></item><item><title>Rubyメモ: 複数バージョンの Ruby をインストールする (RVM)</title><link>https://maku77.github.io/p/q75ofiy/</link><pubDate>Sat, 28 Jan 2012 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/q75ofiy/</guid><description>&lt;p>&lt;strong>RVM (Ruby Version Manager)&lt;/strong> というツールを使うと、簡単に複数バージョンの Ruby を切り替えて使用できるようになります。&lt;/p>
&lt;h1 id="rvm-のインストール">RVM のインストール&lt;/h1>
&lt;p>まずは RVM 本家のスクリプトを使って RVM をインストールします。
コマンド一発でインストールする方法が、本家のサイトに書いてあります。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://rvm.io/">https://rvm.io/&lt;/a> （2015-11-21 アドレス更新）&lt;/li>
&lt;/ul>
&lt;p>記述されている通り実行すると、&lt;code>rvm&lt;/code> コマンドが使えるようになります（正確には、自動で修正された &lt;code>~/.bash_profile&lt;/code> を再読み込みする必要があるかもしれません）。&lt;/p>
&lt;h1 id="rvm-を使って複数の-ruby-をインストールする">RVM を使って複数の Ruby をインストールする&lt;/h1>
&lt;pre tabindex="0">&lt;code>$ rvm list known
&lt;/code>&lt;/pre>&lt;p>とすると、インストールできる Ruby のバージョンが一覧表示されます。
ここでは、Ruby 1.8.7 と Ruby 1.9.3 をインストールしてみます。
ソースコードからインストールするので数分かかります。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ rvm install 1.8.7
$ rvm install 1.9.3
&lt;/code>&lt;/pre>&lt;p>既に Ruby 1.8.7 (&lt;code>/usr/bin/ruby&lt;/code>) がインストールされている場合でも、&lt;strong>RVM で管理する Ruby は別物としてインストールする&lt;/strong>必要があります。
RVM でインストールされた Ruby は、&lt;code>$HOME/.rvm/rubies&lt;/code> の下にバージョンごとに格納されていきます。&lt;/p>
&lt;h1 id="使用する-ruby-のバージョンを切り替える">使用する Ruby のバージョンを切り替える&lt;/h1>
&lt;p>複数の Ruby がインストールされている場合は、使用するバージョンを選択しておきます。
RVM で管理されている Ruby のバージョンは以下のように &lt;code>rvm list&lt;/code> コマンドで確認できます。&lt;/p></description></item><item><title>Rubyメモ: 重複順列 (repeated permutation) を作成する</title><link>https://maku77.github.io/p/dh49opn/</link><pubDate>Sat, 28 Jan 2012 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/dh49opn/</guid><description>&lt;h2 id="arrayrepeated_permutation-で重複順列を作成する">Array#repeated_permutation() で重複順列を作成する&lt;/h2>
&lt;p>&lt;code>Array#repeated_permutation()&lt;/code> は、与えられた配列要素から重複を許す順列を作成します (Ruby 1.9.2〜)。
例えば、&lt;code>[1, 2]&lt;/code> という配列から、長さ 3 の重複順列を作成すると、以下のような組み合わせが得られます。&lt;/p>
&lt;pre tabindex="0">&lt;code>[1, 1, 1], [1, 1, 2], [1, 2, 1], [1, 2, 2]
[2, 1, 1], [2, 1, 2], [2, 2, 1], [2, 2, 2]
&lt;/code>&lt;/pre>&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 順番に配列として処理する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">repeated_permutation&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">perm&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">p&lt;/span> &lt;span class="n">perm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 順番に各値を取得しながら処理する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">repeated_permutation&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;h2 id="自力で重複順列を作成する">自力で重複順列を作成する&lt;/h2>
&lt;p>以下のような多重ループを使えば、&lt;code>repeated_permutation&lt;/code> と同じ結果を簡単に得られます。
ただし、Ruby 1.9.2 以上を使用できるのなら、素直に &lt;code>repeated_permutation&lt;/code> を使った方がシンプルに記述できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="関連記事">関連記事&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../cpp/number/permutation.html">順列 (permutation) を作成する (C++)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../p/wk75ra7/">順列 (permutation) を作成する (Ruby)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../java/numstr/permutation.html">順列 (permutation) を作成する (Java)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../p/ef785b3/">組み合わせ (combination) を作成する (Ruby)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../cpp/number/combination.html">組み合わせ (combination) を作成する (C++)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 組み合わせ (combination) を作成する</title><link>https://maku77.github.io/p/ef785b3/</link><pubDate>Fri, 23 Dec 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ef785b3/</guid><description>&lt;h2 id="arraycombination-を使って組み合わせを作成する">Array#combination() を使って組み合わせを作成する&lt;/h2>
&lt;p>Ruby の &lt;code>Array#combination&lt;/code> メソッドは、与えられた配列要素の組み合わせ (Combination) を作成します。
順序は保証されないので、小さい順に組み合わせを取り出したい場合は、生成後にソートする必要があります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">comb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">combination&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">comb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1">#=&amp;gt; [[1, 2], [1, 3], [1, 4], [2, 3], [2, 4], [3, 4]]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="自力で組み合わせを作成する再帰による実装">自力で組み合わせを作成する（再帰による実装）&lt;/h2>
&lt;p>自力で &lt;code>combination&lt;/code> を実装する場合は、以下のような単純なバックトラック（再帰）で実装できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">combination&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">seed_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">comb_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">comb&lt;/span>&lt;span class="o">=[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]*&lt;/span>&lt;span class="n">comb_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">count&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">comb_size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">p&lt;/span> &lt;span class="n">comb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">start_index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">count&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">comb&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]+&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="n">start_index&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="n">seed_size&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">comb&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">count&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">combination&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">seed_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">comb_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">comb&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">combination&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 5C4&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">[0, 1, 2, 3]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[0, 1, 2, 4]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[0, 1, 3, 4]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[0, 2, 3, 4]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[1, 2, 3, 4]&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;h2 id="関連記事">関連記事&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/wk75ra7/">順列 (permutation) を作成する (Ruby)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../java/numstr/permutation.html">順列 (permutation) を作成する (Java)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../cpp/number/permutation.html">順列 (permutation) を作成する (C++)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../p/dh49opn/">重複順列 (repeated permutation) を作成する (Ruby)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../cpp/number/combination.html">組み合わせ (combination) を作成する (C++)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 配列内で最大値を持つ要素のインデックスを取得する</title><link>https://maku77.github.io/p/9xi4svg/</link><pubDate>Sat, 10 Dec 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/9xi4svg/</guid><description>&lt;p>以下は、配列の中の最大値のインデックスを探すいろいろな方法を示しています。&lt;/p>
&lt;h2 id="最速の方法index-と-max-を組み合わせる">最速の方法（index と max を組み合わせる）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="やや遅い方法自力でループ">やや遅い方法（自力でループ）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">max_i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">max_val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">max_val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">max_i&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="遅い方法each_with_index-と-max-を組み合わせる">遅い方法（each_with_index と max を組み合わせる）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_with_index&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">max&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: ASCII コードと文字を変換する (ord, chr, bytes, unpack, codepoints)</title><link>https://maku77.github.io/p/cbif895/</link><pubDate>Mon, 05 Dec 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/cbif895/</guid><description>&lt;h2 id="前提知識ruby-における文字の表現方法">前提知識（Ruby における文字の表現方法）&lt;/h2>
&lt;p>Ruby には 1 文字だけを表すクラスが存在しないため、例えば &lt;code>A&lt;/code> という 1 文字を扱いたい場合は、&lt;code>'A'[0]&lt;/code> のように記述する必要があります。
また、Ruby 1.8 と 1.9 では、&lt;code>'A'[0]&lt;/code> と記述した場合の意味が異なることに注意してください。&lt;/p>
&lt;pre tabindex="0">&lt;code>（Ruby 1.8 の場合） &amp;#39;A&amp;#39;[0] # =&amp;gt; 65 （文字コード）
（Ruby 1.9 の場合） &amp;#39;A&amp;#39;[0] # =&amp;gt; &amp;#34;A&amp;#34; （1 文字の部分文字列）
&lt;/code>&lt;/pre>&lt;h2 id="文字--ascii-コード">文字 → ASCII コード&lt;/h2>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">Ruby 1.8 / 1.9 共通の方法&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">ord&lt;/span> &lt;span class="c1"># =&amp;gt; 65&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; 65&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">Ruby 1.8 以下でのみ使用できる方法&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; 65&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">Ruby 1.9 以上でのみ使用できる方法&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ord&lt;/span> &lt;span class="c1"># =&amp;gt; 65&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;div class="note">
&lt;code>ord&lt;/code> は実際には ASCII コードではなく、コードポイントを表しています。
Unicode などで、1 文字が複数バイトで表現されている場合は、&lt;code>ord&lt;/code> の返す値も 2 バイト以上の整数値になります。
&lt;/div>
&lt;h2 id="ascii-コード--文字">ASCII コード → 文字&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="mi">65&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chr&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;A&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="文字列--ascii-コードの配列">文字列 → ASCII コードの配列&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;ABC&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span> &lt;span class="c1"># =&amp;gt; [65, 66, 67]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;ABC&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unpack&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;c*&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; [65, 66, 67]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>String#bytes()&lt;/code> は &lt;code>Enumerator&lt;/code> オブジェクトを返すので、ASCII コードを順番に取得したければ、以下のようにブロックを使って処理できます。&lt;/p></description></item><item><title>Rubyメモ: 文字列を逆順にする (reverse)</title><link>https://maku77.github.io/p/hwuci5s/</link><pubDate>Mon, 05 Dec 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/hwuci5s/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ABCDE&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">reverse!&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#39;EDCBA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配列要素を逆順に並び替えるときも、&lt;code>reverse&lt;/code> を使用することができます。&lt;/p></description></item><item><title>Rubyメモ: Ruby のループ構文</title><link>https://maku77.github.io/p/9gg57ac/</link><pubDate>Thu, 01 Dec 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/9gg57ac/</guid><description>&lt;p>C/C++ の &lt;code>for (int i = 0; i &amp;lt; N; ++i)&lt;/code> に相当することは、Ruby では times, Range#each, upto, downto, step を使って直感的に表現できます。
配列の要素を順番に処理するには、for x in arr を使うか、arr.each を使用します。&lt;/p>
&lt;p>次のループ内では以下のジャンプ命令が使用できます。redo や retry は C や Java にはない機能です。&lt;/p>
&lt;ul>
&lt;li>&lt;code>break&lt;/code> &amp;ndash; ループを抜ける&lt;/li>
&lt;li>&lt;code>next&lt;/code> &amp;ndash; 次のステップへ&lt;/li>
&lt;li>&lt;code>redo&lt;/code> &amp;ndash; ループブロックの先頭へジャンプ&lt;/li>
&lt;li>&lt;code>retry&lt;/code> &amp;ndash; 最初からやり直し&lt;/li>
&lt;/ul>
&lt;h1 id="無限ループbreak-するまで">無限ループ（break するまで）&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="kp">loop&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">...&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kp">loop&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="指定した回数の繰り返し">指定した回数の繰り返し&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">print&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; 012&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="x-から-y-までインクリメントしながら">x から y までインクリメントしながら&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="mi">0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">upto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">print&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; 0123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">print&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; 0123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="c1">#=&amp;gt; 0123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="x-から-y-までデクリメントしながら">x から y までデクリメントしながら&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">downto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">print&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c1">#=&amp;gt; 3210&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意: &lt;code>(a..b)&lt;/code> で表す Range オブジェクトは単調増加なので、以下のようにはできません。&lt;/p></description></item><item><title>Rubyメモ: 独自オブジェクトの配列から最小値、最大値を求める (min_by/max_by)</title><link>https://maku77.github.io/p/b22gfoi/</link><pubDate>Sun, 27 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/b22gfoi/</guid><description>&lt;p>任意のオブジェクトの配列から最大値/最小値を持つ要素を取り出すには、大小の判断をどのフィールドで行うかを指定しなければいけません。
&lt;code>min_by&lt;/code>/&lt;code>max_by&lt;/code> メソッドには、大小比較に使用する値を指定するためのブロックを渡せます。&lt;/p>
&lt;p>下記の例では、独自クラス &lt;code>Num&lt;/code> の &lt;code>val&lt;/code> フィールドの値を大小の判断基準として、最大値を持つ要素を検索しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Num&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">attr_reader&lt;/span> &lt;span class="ss">:val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="no">Num&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="no">Num&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="no">Num&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">max&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">max_by&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">val&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">max&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">val&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">3
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 重複する要素を削除する (uniq)</title><link>https://maku77.github.io/p/r894npf/</link><pubDate>Wed, 16 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/r894npf/</guid><description>&lt;p>配列内の重複する要素を取り除くには &lt;code>Array#uniq&lt;/code> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">uniq!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 2 つの変数の値をスワップする</title><link>https://maku77.github.io/p/55yq5h2/</link><pubDate>Sat, 05 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/55yq5h2/</guid><description>&lt;p>Ruby では以下のように記述すれば、一時変数を使わずに値をスワップできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>例えば、Array クラスを以下のように拡張しておくと、配列の任意の 2 要素を簡単に入れ替えることができるようになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Array&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">swap!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">self&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">self&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">self&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">self&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 使用例&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">swap!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; [5, 2, 3, 4, 1]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: Ruby でヒアドキュメント</title><link>https://maku77.github.io/p/6tow6i5/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6tow6i5/</guid><description>&lt;p>Ruby のヒアドキュメント定義は、下記のような構文で行います（Perl とほぼ同じ）。
以下のサンプルでは、&lt;code>split&lt;/code> で行ごとに分割して配列に格納しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">input&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;lt;&amp;lt;END
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&lt;/span>&lt;span class="mi">08&lt;/span> &lt;span class="mo">02&lt;/span> &lt;span class="mi">22&lt;/span> &lt;span class="mi">97&lt;/span> &lt;span class="mi">38&lt;/span> &lt;span class="mi">15&lt;/span> &lt;span class="mo">00&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mo">00&lt;/span> &lt;span class="mi">75&lt;/span> &lt;span class="mo">04&lt;/span> &lt;span class="mo">05&lt;/span> &lt;span class="mo">07&lt;/span> &lt;span class="mi">78&lt;/span> &lt;span class="mi">52&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="mi">50&lt;/span> &lt;span class="mi">77&lt;/span> &lt;span class="mi">91&lt;/span> &lt;span class="mi">08&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">49&lt;/span> &lt;span class="mi">49&lt;/span> &lt;span class="mi">99&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mi">17&lt;/span> &lt;span class="mi">81&lt;/span> &lt;span class="mi">18&lt;/span> &lt;span class="mi">57&lt;/span> &lt;span class="mi">60&lt;/span> &lt;span class="mi">87&lt;/span> &lt;span class="mi">17&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mi">98&lt;/span> &lt;span class="mi">43&lt;/span> &lt;span class="mi">69&lt;/span> &lt;span class="mi">48&lt;/span> &lt;span class="mo">04&lt;/span> &lt;span class="mi">56&lt;/span> &lt;span class="mi">62&lt;/span> &lt;span class="mo">00&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">81&lt;/span> &lt;span class="mi">49&lt;/span> &lt;span class="mi">31&lt;/span> &lt;span class="mi">73&lt;/span> &lt;span class="mi">55&lt;/span> &lt;span class="mi">79&lt;/span> &lt;span class="mi">14&lt;/span> &lt;span class="mi">29&lt;/span> &lt;span class="mi">93&lt;/span> &lt;span class="mi">71&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mi">67&lt;/span> &lt;span class="mi">53&lt;/span> &lt;span class="mi">88&lt;/span> &lt;span class="mi">30&lt;/span> &lt;span class="mo">03&lt;/span> &lt;span class="mi">49&lt;/span> &lt;span class="mi">13&lt;/span> &lt;span class="mi">36&lt;/span> &lt;span class="mi">65&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">52&lt;/span> &lt;span class="mi">70&lt;/span> &lt;span class="mi">95&lt;/span> &lt;span class="mi">23&lt;/span> &lt;span class="mo">04&lt;/span> &lt;span class="mi">60&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">42&lt;/span> &lt;span class="mi">69&lt;/span> &lt;span class="mi">24&lt;/span> &lt;span class="mi">68&lt;/span> &lt;span class="mi">56&lt;/span> &lt;span class="mo">01&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">56&lt;/span> &lt;span class="mi">71&lt;/span> &lt;span class="mi">37&lt;/span> &lt;span class="mo">02&lt;/span> &lt;span class="mi">36&lt;/span> &lt;span class="mi">91&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">22&lt;/span> &lt;span class="mi">31&lt;/span> &lt;span class="mi">16&lt;/span> &lt;span class="mi">71&lt;/span> &lt;span class="mi">51&lt;/span> &lt;span class="mi">67&lt;/span> &lt;span class="mi">63&lt;/span> &lt;span class="mi">89&lt;/span> &lt;span class="mi">41&lt;/span> &lt;span class="mi">92&lt;/span> &lt;span class="mi">36&lt;/span> &lt;span class="mi">54&lt;/span> &lt;span class="mi">22&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mi">40&lt;/span> &lt;span class="mi">28&lt;/span> &lt;span class="mi">66&lt;/span> &lt;span class="mi">33&lt;/span> &lt;span class="mi">13&lt;/span> &lt;span class="mi">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">END&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">lines&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">input&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">lines&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 先頭から n 個の要素を削除する</title><link>https://maku77.github.io/p/fofgyfx/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/fofgyfx/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">drop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; [4, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 先頭から条件を満たす範囲の配列を取得する</title><link>https://maku77.github.io/p/kmuzhww/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/kmuzhww/</guid><description>&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 先頭から見て、0 以下の値をすべて取得する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">take_while&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">new_arr&lt;/span> &lt;span class="c1"># =&amp;gt; [-3, -2, -1, 0]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="関連">関連&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/jqimc9v/">先頭から条件を満たす間だけ要素を削除する&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 先頭から条件を満たす間だけ要素を削除する</title><link>https://maku77.github.io/p/jqimc9v/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/jqimc9v/</guid><description>&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 先頭から見て、0 以下の要素が続く限り削除する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">drop_while&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, -1, -2, -3]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>元の配列の内容は保持されます。&lt;/p>
&lt;h2 id="関連">関連&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/kmuzhww/">先頭から条件を満たす範囲の配列を取得する&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 文字列をインクリメントする (succ/next)</title><link>https://maku77.github.io/p/z8te97w/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/z8te97w/</guid><description>&lt;p>Ruby では、文字列も数値と同じような感覚でインクリメント／デクリメントすることができます。&lt;/p>
&lt;pre tabindex="0">&lt;code>String#succ =&amp;gt; String
String#next =&amp;gt; String
&lt;/code>&lt;/pre>&lt;p>下記の例では、アルファベットで構成された文字列に &lt;code>succ&lt;/code> メソッドを適用しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;z&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;aa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;A&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;B&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;Z&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;AA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;aaa&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;aab&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;AAz&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;ABa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;aaZ&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;abA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文字列内に数値が含まれている場合は、それっぽく動作してくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;9&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;-1&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;-2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;-999&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;-1000&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;A9&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">succ&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;B0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列配列から正規表現に一致する要素を検索する (grep)</title><link>https://maku77.github.io/p/ynufrhd/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ynufrhd/</guid><description>&lt;h2 id="文字列配列を-grep-する">文字列配列を grep する&lt;/h2>
&lt;p>下記の例では、文字列配列の中から、特定の文字を含むものを抽出しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 文字列配列から ab という文字列を含む要素を抽出&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sx">%w{ aaa abc bbb bab cca ccc dab ddd }&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">newArr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">grep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/ab/&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;abc&amp;#34;, &amp;#34;bab&amp;#34;, &amp;#34;dab&amp;#34;]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="テキストファイルを-grep-する">テキストファイルを grep する&lt;/h2>
&lt;p>テキストファイルを文字列配列として読み込めば、同様に grep できます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: input.txt というファイルから ABC という文字列を含む行を抽出&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">lines&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">readlines&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">grep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/ABC/&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">lines&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">lines&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chomp&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c1"># 各行の末尾の改行文字を削除する&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="n">lines&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;ABC123&amp;#34;, &amp;#34;dsdfasABCsdf&amp;#34;, &amp;#34;sFOAIABCAF&amp;#34;]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 条件を満たす要素と満たさない要素の配列に分割する (partition)</title><link>https://maku77.github.io/p/inqqbua/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/inqqbua/</guid><description>&lt;p>&lt;code>Array&lt;/code> クラスの下記のメソッドを使用すると、指定した条件に一致するかどうかで、配列を 2 つに分割できます。&lt;/p>
&lt;pre tabindex="0">&lt;code>Array#partition {|x| ...} =&amp;gt; [arr1, arr2]
&lt;/code>&lt;/pre>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 1〜10 の数を、2 で割り切れる数と割り切れない数の配列に分割&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">a2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">partition&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1"># =&amp;gt; [[2, 4, 6, 8, 10], [1, 3 ,5, 7, 9]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">a1&lt;/span> &lt;span class="c1"># =&amp;gt; [2, 4, 6, 8, 10]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">a2&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 3, 5, 7, 9]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 条件を満たす要素を削除する</title><link>https://maku77.github.io/p/4k4e4nv/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/4k4e4nv/</guid><description>&lt;p>条件を指定して配列内の要素を削除するには、&lt;code>Array&lt;/code> クラスの下記のようなメソッドを使用します。&lt;/p>
&lt;pre tabindex="0">&lt;code>Array#delete_if {|x| ...} # 元の配列が変更される
Array#reject {|x| ...} # 元の配列は変更されない
&lt;/code>&lt;/pre>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: 配列内の偶数の値を削除する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete_if&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 3, 5, 7, 9]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>delete_if&lt;/code> は、元の配列が変更されることに注意してください。
元の配列を保持したまま、条件を満たす要素を除外した新しい配列を作成したい場合は &lt;code>reject&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">new_arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">reject&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 配列を結合する</title><link>https://maku77.github.io/p/satzyck/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/satzyck/</guid><description>&lt;h2 id="元の配列に結合する元の配列を変更">元の配列に結合する（元の配列を変更）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4, 5, 6, 7]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="配列を結合して新しい配列を作る元の配列は保持">配列を結合して新しい配列を作る（元の配列は保持）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4, 5, 6]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>+&lt;/code> の右側は要素が 1 つだけの場合も &lt;code>[]&lt;/code> で囲む必要があります。&lt;/p></description></item><item><title>Rubyメモ: 順列 (permutation) を作成する</title><link>https://maku77.github.io/p/wk75ra7/</link><pubDate>Fri, 04 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wk75ra7/</guid><description>&lt;h2 id="arraypermutation-を使って順列を作成する">Array#permutation() を使って順列を作成する&lt;/h2>
&lt;p>&lt;code>Array#permutation()&lt;/code> は、各要素を 1 回ずつ使用した順列を作成します。
n 個の要素からなる順列の数は n! になります（例: 7! = 5040）。&lt;/p>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">配列要素からなる順列を作成する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">permutation&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">p&lt;/span> &lt;span class="n">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;p>&lt;code>permutation()&lt;/code> のパラメータとして、各順列の要素数を指定できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">permutation&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">p&lt;/span> &lt;span class="n">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>[1, 2]
[1, 3]
[2, 1]
[2, 3]
[3, 1]
[3, 2]
&lt;/code>&lt;/pre>&lt;p>以下のように &lt;code>Enumerator#to_a&lt;/code> を使い、順列を配列として取得することもできますが、順列が大きくなると効率が悪くなるので、できるだけブロックで処理するのがよいでしょう。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">perm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">permutation&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">perm&lt;/span> &lt;span class="c1"># =&amp;gt; [[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1]]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>以下、参考までに自力で permutation を実装する例をいくつか示しますが、組み込みの &lt;code>Array#permutation&lt;/code> を使った方が全然速いです（特に、再帰で独自実装するとかなり遅くなってしまいます）。&lt;/p>
&lt;h2 id="順列を自力で実装する方法再帰による実装-1">順列を自力で実装する方法（再帰による実装 1）&lt;/h2>
&lt;p>ここでは、seed となる配列から順番に要素を取り出して、新たな配列を組み立てるという実装をしています。&lt;/p></description></item><item><title>Rubyメモ: 文字列からある文字を取り除く (delete/gsub)</title><link>https://maku77.github.io/p/6fpfhwj/</link><pubDate>Wed, 02 Nov 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6fpfhwj/</guid><description>&lt;p>文字列内の指定した文字を取り除くには、&lt;code>String#delete&lt;/code> を使用するか、&lt;code>String#gsub&lt;/code> で指定した文字を空文字に置換します。&lt;/p>
&lt;pre tabindex="0">&lt;code>String#delete!(&amp;#39;A&amp;#39;)
String#gsub!(&amp;#39;A&amp;#39;, &amp;#39;&amp;#39;)
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;lt;&amp;lt;END
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&lt;/span>&lt;span class="n">aaaaaaaaaaaa&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">bbbbbbbbbbbb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cccccccccccccc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">END&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 配列をソートする（昇順ソート／降順ソート）(sort)</title><link>https://maku77.github.io/p/xt2xzxi/</link><pubDate>Sun, 30 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/xt2xzxi/</guid><description>&lt;h2 id="昇順ソート">昇順ソート&lt;/h2>
&lt;p>&lt;code>Array#sort&lt;/code> メソッドは、デフォルトで昇順ソートを行います。
下記のコードでは、自分自身の配列を書き換えるために &lt;code>!&lt;/code> を付けて &lt;code>sort&lt;/code> を実行しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1">#=&amp;gt; [1, 2, 3, 4, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="降順ソート">降順ソート&lt;/h2>
&lt;p>&lt;code>Array#sort&lt;/code> にソートロジックを表すコードを渡すことで、ソート方法をカスタマイズできます。
下記の例では、&lt;strong>降順ソート&lt;/strong>を行っています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort!&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="o">&amp;lt;=&amp;gt;&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>実は、上記のようにするよりも、単純に昇順ソートしてから逆順に並べ替えたほうがずっと高速です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sort!&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">reverse!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1">#=&amp;gt; [5, 4, 3, 2, 1]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>破壊メソッドをチェーンして実行するときは、上記のように &lt;code>sort&lt;/code> と &lt;code>reverse&lt;/code> の両方にびっくりマーク &lt;code>!&lt;/code> を付けることに注意してください。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="../p/rdck2o4/">配列をランダムに並び替える (sort_by)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: 最大値／最小値を求める (min/max/minmax)</title><link>https://maku77.github.io/p/dgjggob/</link><pubDate>Sat, 15 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/dgjggob/</guid><description>&lt;h2 id="配列内の値の最大値最小値を求める">配列内の値の最大値／最小値を求める&lt;/h2>
&lt;p>配列に対して &lt;code>min&lt;/code>, &lt;code>max&lt;/code> を使用できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; 1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; 5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; 1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; 5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;a&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39;c&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配列が空の場合は &lt;code>nil&lt;/code> を返します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="kp">nil&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="kp">nil&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>異なる型のオブジェクトが配列内に含まれているとエラーになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="kp">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; Error!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="kp">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; Error!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">min&lt;/span> &lt;span class="c1"># =&amp;gt; Error!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">max&lt;/span> &lt;span class="c1"># =&amp;gt; Error!&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="最大値最小値を同時に求める">最大値／最小値を同時に求める&lt;/h2>
&lt;p>&lt;code>minmax&lt;/code> メソッドを使うと、最小値と最大値を同時に求めることもできます。
戻り値はサイズ &lt;code>2&lt;/code> の配列になります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">minmax&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="独自オブジェクトを比較できるようにする">独自オブジェクトを比較できるようにする&lt;/h2>
&lt;p>配列の中に独自オブジェクトを含んでいる場合は、比較方法をブロックで定義できます（&lt;code>min&lt;/code>, &lt;code>max&lt;/code>, &lt;code>minmax&lt;/code> すべて共通）。
&lt;code>a &amp;gt; b&lt;/code> のときに正、&lt;code>a == b&lt;/code> のときに 0、&lt;code>a &amp;lt; b&lt;/code> のときに負の値を返すように実装します。&lt;/p></description></item><item><title>Rubyメモ: 配列をコピーする</title><link>https://maku77.github.io/p/exp3jnw/</link><pubDate>Sat, 15 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/exp3jnw/</guid><description>&lt;h1 id="配列のコピーは-arraydup">配列のコピーは Array#dup&lt;/h1>
&lt;p>配列を &lt;code>=&lt;/code> 演算子で別の変数に代入しても、参照がコピーされるだけなので、新しい配列オブジェクトは作成されません。
下記の例で、変数 &lt;code>a&lt;/code> と &lt;code>b&lt;/code> は同じものを指していることが分かります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;modified&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;modified&amp;#34;, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;modified&amp;#34;, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配列の要素そのものをコピーして新しい配列を作成するには、&lt;code>Array#dup()&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;AAA&amp;#34;, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: クラスメソッドを定義する</title><link>https://maku77.github.io/p/p2acsia/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/p2acsia/</guid><description>&lt;p>Ruby でクラスメソッドを定義するには、下記のように &lt;strong>クラス名.メソッド名&lt;/strong> という名前でメソッドを定義します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nc">MyClass&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">classMethod&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">MyClass&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">classMethod&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">#=&amp;gt; Hello&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>あるいは以下のように &lt;strong>self.メソッド名&lt;/strong> と書くこともできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nc">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">classMethod&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: クラス定数を定義する</title><link>https://maku77.github.io/p/cbiwibv/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/cbiwibv/</guid><description>&lt;p>下記の &lt;code>MAX_VALUE&lt;/code> はクラス定数を表しています。
先頭の文字を大文字で始めるとクラス定数となり、値を変更できなくなります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">MAX_VALUE&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nc">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">printMaxValue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="no">MAX_VALUE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>クラス定数の可視性はデフォルトで public になり、クラスの外からは &lt;code>MyClass::MAX_VALUE&lt;/code> のような形で参照できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">MyClass&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printMaxValue&lt;/span> &lt;span class="c1">#=&amp;gt; 500&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">MyClass&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">MAX_VALUE&lt;/span> &lt;span class="c1">#=&amp;gt; 500&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: メソッドの可視性を設定する（メソッドのアクセス制御）</title><link>https://maku77.github.io/p/h4ugjqd/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/h4ugjqd/</guid><description>&lt;p>&lt;strong>デフォルトでは Ruby のメソッドは public&lt;/strong> になります（&lt;code>initialize&lt;/code> メソッドだけは private）。
メソッドの可視性を設定するには、&lt;code>public&lt;/code>、&lt;code>protected&lt;/code>、&lt;code>private&lt;/code> キーワードを使って以下のように指定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">public&lt;/span> &lt;span class="ss">:method1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">:method2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">protected&lt;/span> &lt;span class="ss">:method3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">private&lt;/span> &lt;span class="ss">:method4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>C++ のような構文で可視性を設定することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">public&lt;/span> &lt;span class="c1"># 以下のメソッドは public&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">protected&lt;/span> &lt;span class="c1"># 以下のメソッドは protected&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">private&lt;/span> &lt;span class="c1"># 以下のメソッドは private&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">method4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 指定した位置の要素を削除する</title><link>https://maku77.github.io/p/ie33iti/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ie33iti/</guid><description>&lt;h2 id="インデックス指定で配列要素を削除">インデックス指定で配列要素を削除&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete_at&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 4, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="先頭要素の削除同時に取得">先頭要素の削除（同時に取得）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">shift&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [2, 3, 4, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="末尾要素の削除同時に取得">末尾要素の削除（同時に取得）&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 擬似コンストラクタを定義する</title><link>https://maku77.github.io/p/2kz4x74/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/2kz4x74/</guid><description>&lt;p>コンストラクタに複数パターンのパラメータを持たせたい場合、通常はコンストラクタ &lt;code>initialize&lt;/code> をオーバーロードしますが、以下のようにクラスメソッド内で &lt;code>new&lt;/code> を実行することで、擬似的なコンストラクタとして使用できます。
インスタンスの生成パラメータを簡略化したい場合や、シングルトンを作成するときなどに利用できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyValue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 擬似コンストラクタ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nc">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nf">createBig&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">99999&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">printValue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="vi">@val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">val1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyValue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 通常のコンストラクタ呼び出し&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">val1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printValue&lt;/span> &lt;span class="c1"># 100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">val2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyValue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">createBig&lt;/span> &lt;span class="c1"># 擬似コンストラクタ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">val2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">printValue&lt;/span> &lt;span class="c1"># 99999&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列をコピーする (dup)</title><link>https://maku77.github.io/p/wkqctke/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wkqctke/</guid><description>&lt;p>Ruby では、文字列変数を下記のように代入すると、参照を代入することになります。
つまり、&lt;code>s1&lt;/code> と &lt;code>s2&lt;/code> の参照先として、同じ文字列情報を指すようになるだけで、文字列の実体がコピーされて 2 つに増えているわけではありません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>s1&lt;/code> と &lt;code>s2&lt;/code> は同じ実体を指し示しているので、どちらかから文字列を操作すると、両方から見える文字列が変化することになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;BAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;BAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文字列の実体をコピーして、別々の文字列情報として保持するには、&lt;code>dup&lt;/code> メソッドで文字列をコピーします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;BAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;AAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 条件に一致する要素を検索する (find/find_all)</title><link>https://maku77.github.io/p/zph2i79/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/zph2i79/</guid><description>&lt;p>配列内から任意の条件に一致する要素を抜き出すには以下のいずれかを使用します。&lt;/p>
&lt;ul>
&lt;li>&lt;code>arr.find {|x| ... }&lt;/code> &amp;ndash; ブロックで true を返した要素を 1 つ返す&lt;/li>
&lt;li>&lt;code>arr.find_all {|x| ... }&lt;/code> &amp;ndash; ブロックで true を返したすべての要素を配列で返す&lt;/li>
&lt;/ul>
&lt;p>下記は、独自クラス &lt;code>Person&lt;/code> のオブジェクトを格納した配列から、条件に一致する要素を検索する例です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Person&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">attr_accessor&lt;/span> &lt;span class="ss">:name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">to_s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="vi">@name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Andrew&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Makkuma&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Mike&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;John&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 名前が M で始まる要素を１つだけ抽出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="sr">/^M/&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="c1"># =&amp;gt; #&amp;lt;Person:0x100167578 @name=&amp;#34;Makkuma&amp;#34;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 名前が M で始まる要素をすべて抽出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find_all&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="sr">/^M/&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="c1"># =&amp;gt; [#&amp;lt;Person:0x100167578 @name=&amp;#34;Makkuma&amp;#34;&amp;gt;, #&amp;lt;Person:0x100167528 @name=&amp;#34;Mike&amp;#34;&amp;gt;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 部分配列を取得する（配列スライシング）</title><link>https://maku77.github.io/p/jrf5596/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/jrf5596/</guid><description>&lt;p>部分配列のアクセス方法には以下の３種類があります。
文字列変数から部分文字列を取得する場合も同様にアクセスできます。&lt;/p>
&lt;ul>
&lt;li>&lt;code>arr[startIndex, count]&lt;/code> &amp;ndash; 指定した文字数を取得&lt;/li>
&lt;li>&lt;code>arr[startIndex..endIndex]&lt;/code> &amp;ndash; 指定した位置まで取得（endIndex を含む）&lt;/li>
&lt;li>&lt;code>arr[startIndex...endIndex]&lt;/code> &amp;ndash; 指定した位置まで取得（endIndex を含まない）&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;ABCDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEF&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;ABCDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">..-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">..-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;FGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;ABCDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CD&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEFGH&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">...-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;CDEFG&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">[-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">...-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;FG&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 配列に要素を追加する</title><link>https://maku77.github.io/p/76ga4od/</link><pubDate>Mon, 10 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/76ga4od/</guid><description>&lt;h2 id="配列の末尾に要素を挿入">配列の末尾に要素を挿入&lt;/h2>
&lt;p>配列の末尾に要素を挿入するには、&lt;code>push&lt;/code> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, &amp;#34;A&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, &amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>C++ 風に &lt;code>&amp;lt;&amp;lt;&lt;/code> 演算子でも末尾に要素を追加できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, &amp;#34;A&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, &amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>別の配列の要素を末尾に追加&lt;/strong>する場合は、&lt;code>+=&lt;/code> 演算子を使用できます。
右辺には配列を指定する必要があります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, &amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="配列の先頭に要素を挿入">配列の先頭に要素を挿入&lt;/h2>
&lt;p>配列の先頭に要素を挿入するには、以下のいずれかを使用します。&lt;/p>
&lt;ul>
&lt;li>&lt;code>arr.unshift(...)&lt;/code>&lt;/li>
&lt;li>&lt;code>arr.insert(0, ...)&lt;/code>&lt;/li>
&lt;li>&lt;code>arr[0, 0] = ...&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>複数の値を一度に追加したい場合は、単純にカンマで区切って並べます（配列を渡してしまうと、要素として 1 つの配列が追加されてしまうので注意）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unshift&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;A&amp;#34;, 1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unshift&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [&amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;, &amp;#34;A&amp;#34;, 1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">unshift&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;D&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;E&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="c1"># =&amp;gt; [[&amp;#34;D&amp;#34;, &amp;#34;E&amp;#34;], &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;, &amp;#34;A&amp;#34;, 1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="インデックス指定で配列に要素を挿入">インデックス指定で配列に要素を挿入&lt;/h2>
&lt;p>要素の挿入位置をインデックス指定して配列に要素を追加するには、以下のいずれかを使用します。&lt;/p></description></item><item><title>Rubyメモ: クラスを継承する</title><link>https://maku77.github.io/p/9pjsrsu/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/9pjsrsu/</guid><description>&lt;p>Ruby は単一継承に制限されているので、多重継承はできません。
派生クラスのコンストラクタ (&lt;code>initialize&lt;/code>) から基底クラスのコンストラクタ (&lt;code>initialize&lt;/code>) を呼び出すには、&lt;code>super&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Base&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Derived&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="no">Base&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">age&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">super&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@age&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">age&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">d&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Derived&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;makkuma&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">d&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">inspect&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>super&lt;/code> というキーワードは、&lt;code>initialize&lt;/code> メソッドに限らず、親クラスの同名メソッドを呼び出す目的で使用できます。
&lt;code>super&lt;/code> に渡すパラメータを省略すると、呼び出し元のメソッドに渡されたものと同じパラメータが渡されます。&lt;/p></description></item><item><title>Rubyメモ: コンストラクタを定義する</title><link>https://maku77.github.io/p/wiegfcm/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wiegfcm/</guid><description>&lt;h2 id="コンストラクタの定義は-initialize">コンストラクタの定義は initialize&lt;/h2>
&lt;p>Ruby のクラスでコンストラクタを定義したいときは、&lt;code>initialize&lt;/code> というメソッドを使用します。
ここでインスタンス変数などを初期化します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">クラスの定義&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Person&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="インスタンスの生成は-new">インスタンスの生成は new&lt;/h2>
&lt;p>&lt;code>initialize&lt;/code> メソッド自体は private メソッドとして定義されるので、インスタンスを作成するときは暗黙的に定義されている &lt;code>new&lt;/code> メソッドを呼び出します。
&lt;code>new&lt;/code> を呼び出すと、Ruby 内部では、初期化されていないオブジェクトが生成されて、&lt;code>initialize&lt;/code> メソッドが呼び出されます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">インスタンスの生成&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Person&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;makkuma&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">inspect&lt;/span> &lt;span class="c1"># =&amp;gt; #&amp;lt;Person:0x10016a160 @name=&amp;#34;makkuma&amp;#34;&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記の例では、Object クラスに定義されている &lt;code>inspect&lt;/code> メソッドを使ってオブジェクトの内容を取得しています。&lt;/p></description></item><item><title>Rubyメモ: ハッシュのデフォルト値を設定する</title><link>https://maku77.github.io/p/n3na2tg/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/n3na2tg/</guid><description>&lt;p>Ruby のハッシュは、存在しないキーで値を参照しようとすると、デフォルトでは &lt;code>nil&lt;/code> を返すようになっています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1">#=&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>デフォルト値を &lt;code>nil&lt;/code> 以外の値に変更したい場合は、ハッシュの生成時にデフォルト値を指定します。
例えば、単語数をカウントしたりする場合に、ハッシュのデフォルト値を 0 に設定するとスマートに記述できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hash&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># 0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">h&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="c1"># デフォルト値として 0 が入っているため、最初から +1 できる。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">h&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># 1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: ハッシュの基本</title><link>https://maku77.github.io/p/k65kjdt/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/k65kjdt/</guid><description>&lt;h2 id="ハッシュとは">ハッシュとは&lt;/h2>
&lt;p>ハッシュ (&lt;code>Hash&lt;/code>) は、キーと値のペアを格納するコレクションであり、配列 (&lt;code>Array&lt;/code>) と似ていますが、任意の型のオブジェクトをキーとすることができます。&lt;/p>
&lt;h2 id="空のハッシュを作成する">空のハッシュを作成する&lt;/h2>
&lt;p>Ruby でハッシュを生成するときは &lt;code>{}&lt;/code> を使用します（配列を生成するときは &lt;code>[]&lt;/code> を使用します）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hash&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="初期値を与えてハッシュを生成する">初期値を与えてハッシュを生成する&lt;/h2>
&lt;p>ハッシュを生成するときに、キーと値のペアを &lt;code>=&amp;gt;&lt;/code> で並べて指定することで、ハッシュの初期値を設定できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">person_info&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;makkuma&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;age&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;mail&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;makkuma@example.com&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>一行で記述することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;val1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;val2&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記では、文字列をキーとしてハッシュを扱っていますが、別の型のオブジェクトをキーとして扱うこともできます。&lt;/p>
&lt;h2 id="ハッシュ要素の参照">ハッシュ要素の参照&lt;/h2>
&lt;p>ハッシュの要素を参照するときは、配列の要素を参照するときと同様に &lt;code>[]&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">person_info&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;makkuma&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">person_info&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;age&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>存在しないキーで値を取得しようとすると、&lt;code>nil&lt;/code> が返されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">person_info&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1">#=&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>参考: &lt;a href="../p/n3na2tg/">ハッシュのデフォルト値を設定する&lt;/a>&lt;/p>
&lt;h2 id="クラスメソッド--によるハッシュの生成">クラスメソッド &lt;code>[]&lt;/code> によるハッシュの生成&lt;/h2>
&lt;p>&lt;code>Hash&lt;/code> クラスのクラスメソッドである &lt;code>[]&lt;/code> を使ってハッシュを初期化することもできます。
クラスメソッド &lt;code>[]&lt;/code> を使用すると、&lt;code>=&amp;gt;&lt;/code> でキーと値を並べる代わりに、&lt;code>キー, 値, キー, 値&lt;/code> というカンマ区切りで交互に並べる初期化構文を使用できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hash&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;val1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="s1">&amp;#39;val2&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hash&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;val1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;val2&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>アスタリスク &lt;code>*&lt;/code> による配列要素の展開機能と組み合わせれば、配列に格納された値からハッシュを生成できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;key1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;val1&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;key2&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;val2&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">my_hash&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Hash&lt;/span>&lt;span class="o">[*&lt;/span>&lt;span class="n">my_arr&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 属性を定義する（アクセサメソッド）</title><link>https://maku77.github.io/p/trm7osx/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/trm7osx/</guid><description>&lt;h1 id="setter-と-getter-を同時に定義">Setter と Getter を同時に定義&lt;/h1>
&lt;p>クラスのメンバ変数は&lt;strong>デフォルトでは private&lt;/strong> になっているので、外部から参照できません。
値の読み書きともにできる属性を定義したい場合は、&lt;code>attr_accessor&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyPoint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">attr_accessor&lt;/span> &lt;span class="ss">:posX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">:posY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyPoint&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posX&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posY&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posX&lt;/span> &lt;span class="c1">#=&amp;gt; 100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posY&lt;/span> &lt;span class="c1">#=&amp;gt; 200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="getter-の定義">Getter の定義&lt;/h1>
&lt;p>外部からは、メンバ変数の参照だけできるようにしたいときは、&lt;code>attr_reader&lt;/code> で対象となるメンバ変数を列挙します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyPoint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">attr_reader&lt;/span> &lt;span class="ss">:posX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">:posY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">initialize&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">posX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">posY&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@posX&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">posX&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@posY&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">posY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyPoint&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posX&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">, &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posY&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="c1">#=&amp;gt; 10, 20&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>あるいは、以下のようにメンバ変数を参照するためのメソッドを明示的に定義しても、&lt;code>attr_reader&lt;/code> と同様の効果が得られます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">posX&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="vi">@posX&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="setter-の定義">Setter の定義&lt;/h1>
&lt;p>外部からメンバ変数を書き換えできるようにするには、&lt;code>attr_writer&lt;/code> で公開したいメンバ変数を列挙します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyPoint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kp">attr_writer&lt;/span> &lt;span class="ss">:posX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">:posY&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyPoint&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">posX&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">30&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>あるいは、以下のようにメンバ変数に代入するための &lt;code>=&lt;/code> 演算子を定義しても、&lt;code>attr_writer&lt;/code> と同様の効果が得られます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">posX&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">posX&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@posX&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">posX&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列を置換する (sub/gsub)</title><link>https://maku77.github.io/p/upbbkhw/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/upbbkhw/</guid><description>&lt;h2 id="最初に見つかった文字列だけ置換-sub">最初に見つかった文字列だけ置換 (sub)&lt;/h2>
&lt;p>&lt;code>String#sub(pattern, replace)&lt;/code> は、文字列の中でパターンに一致した&lt;strong>最初の文字列&lt;/strong>を、指定した文字列 &lt;code>replace&lt;/code> に置換した文字列を返します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAABBBCCCAAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sub&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;XXX&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;XXXBBBCCCAAA&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>sub&lt;/code> の代わりに &lt;code>sub!&lt;/code> を使用すると、自分自身の文字列を書き換えます。&lt;/p>
&lt;h2 id="すべての文字列を置換-gsub">すべての文字列を置換 (gsub)&lt;/h2>
&lt;p>&lt;code>String#sub&lt;/code> の代わりに、&lt;code>String#gsub&lt;/code> を使用すると、パターンに一致した&lt;strong>すべての文字列を置換&lt;/strong>します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAABBBCCCAAA&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gsub&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;XXX&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;XXXBBBCCCXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>gsub&lt;/code> の代わりに &lt;code>gsub!&lt;/code> を使用すると、自分自身の文字列を書き換えます。&lt;/p>
&lt;h2 id="正規表現でパターンを指定して置換する">正規表現でパターンを指定して置換する&lt;/h2>
&lt;p>検索するパターンに &lt;code>/pattern/&lt;/code> という形式で正規表現を指定することもできます。
パターン内の任意の部分を &lt;code>(&lt;/code> と &lt;code>)&lt;/code> で囲んでおくことにより、置換文字列でその文字列を参照 (&lt;code>\1&lt;/code>, &lt;code>\2&lt;/code>, &lt;code>\3&lt;/code>, &amp;hellip;) できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Hello &amp;lt;b&amp;gt;maku&amp;lt;/b&amp;gt;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gsub&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/&amp;lt;(.+?)&amp;gt;/&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;[\1]&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;Hello [b]maku[/b]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>最短一致させるために、&lt;code>.+&lt;/code> でなく &lt;code>.+?&lt;/code> と指定していることに注意してください。
この &lt;code>?&lt;/code> を忘れると、&lt;code>&amp;lt;b&amp;gt;&lt;/code> ではなく、&lt;code>&amp;lt;b&amp;gt;maku&amp;lt;/b&amp;gt;&lt;/code> にマッチしてしまいます。&lt;/p>
&lt;h2 id="ブロックを指定して柔軟な置換処理を行う">ブロックを指定して柔軟な置換処理を行う&lt;/h2>
&lt;p>&lt;code>String#sub&lt;/code> や &lt;code>String#gsub&lt;/code> の第 2 パラメータで置き換え後の文字列を指定する代わりに、置換処理を表すブロックを指定することもできます。
ブロックの評価結果が置換後の文字列として使われるため、非常に柔軟な置換処理を記述することができます。&lt;/p>
&lt;p>ブロックの中で部分一致文字列（パターン内で &lt;code>(&lt;/code> と &lt;code>)&lt;/code> で囲んだ部分）を参照するには、Ruby の組み込み変数である &lt;code>$1&lt;/code> や &lt;code>$2&lt;/code> を使用します（正規表現の場合の &lt;code>\1&lt;/code> や &lt;code>\2&lt;/code> とは異なるので注意してください）。&lt;/p></description></item><item><title>Rubyメモ: 配列を作成する</title><link>https://maku77.github.io/p/wwn5oef/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wwn5oef/</guid><description>&lt;h1 id="空の配列を作成">空の配列を作成&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="初期値を与えて作成">初期値を与えて作成&lt;/h1>
&lt;h2 id="各要素の値を与えて配列を作成する">各要素の値を与えて配列を作成する&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;aaa&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;bbb&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;ccc&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="同じ値の繰り返しの配列を作成する">同じ値の繰り返しの配列を作成する&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="c1"># =&amp;gt; [0, 0, 0, 0, 0]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">Array&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; [0, 0, 0, 0, 0]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="クォーテーションマークを省略して配列要素を指定する">クォーテーションマークを省略して配列要素を指定する&lt;/h2>
&lt;p>単語の配列を作りたい場合は、&lt;code>%w&lt;/code> を使用すると、それぞれの単語をクォーテーションで囲まなくても済み、単語間のカンマも必要なくなります（逆に、カンマを入れてしまうと、カンマも値として含まれてしまうので注意してください）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sx">%w{aaa bbb ccc}&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;aaa&amp;#34;, &amp;#34;bbb&amp;#34;, &amp;#34;ccc&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意: &lt;code>%w{&lt;/code> の 3 文字の間にスペースが入ると構文エラーになります。&lt;/p>
&lt;h1 id="数値の羅列からなる配列を作成する">数値の羅列からなる配列を作成する&lt;/h1>
&lt;p>&lt;code>Range#to_a&lt;/code> を使って、ある範囲の数値の羅列を作成できます。
さらに &lt;code>step&lt;/code> を組み合わせることで、飛び飛びの値からなる配列を簡単に作成できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4, 5]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">step&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_a&lt;/span> &lt;span class="c1"># =&amp;gt; [10, 8, 6, 4, 2, 0]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Range#map&lt;/code> (&lt;code>Range#collect&lt;/code>) を使うと、数値の羅列を加工しながら配列を作成できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 2, 3, 4, 5] # これをやるなら (1..5).to_a で！&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1"># =&amp;gt; [2, 4, 6, 8, 10]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>以下のように実行するよりも、シンプルなコードで配列を作成できます。&lt;/p></description></item><item><title>Rubyメモ: 関数にコードブロックを渡す（yield による呼び出し）</title><link>https://maku77.github.io/p/qae23vv/</link><pubDate>Fri, 07 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/qae23vv/</guid><description>&lt;h1 id="yield-の基本">yield の基本&lt;/h1>
&lt;p>メソッド内で &lt;code>yield&lt;/code> を呼び出すと、そのメソッドを呼び出すときに与えられたコードブロック（&lt;code>{...}&lt;/code> で囲まれたコード）をその位置で実行することができます。
下記の例では、&lt;code>puts 'Hello'&lt;/code> を実行するコードブロックを関数に渡しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">hoge&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">yield&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">yield&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h1 id="コードブロックにパラメータを渡す">コードブロックにパラメータを渡す&lt;/h1>
&lt;p>&lt;code>yield&lt;/code> をパラメータを付けて実行すると、そのパラメータがコードブロックに渡されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">hoge&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">yield&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">yield&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="go">300
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">500
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>コードブロックは、&lt;code>{...}&lt;/code> の形式でなく、&lt;code>do ... end&lt;/code> の形式で記述することもできます。
コードブロックが複数行に渡る場合は、&lt;code>do ... end&lt;/code> の形式を使うことが多いようです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>データのリストを保持するクラスなどは、&lt;code>each&lt;/code> メソッドが定義されていることが多く、
このメソッドは各データを 1 つずつ処理するための &lt;strong>each イテレータ&lt;/strong> として働きます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyList&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">each&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="o">].&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">yield&lt;/span> &lt;span class="n">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">myList&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyList&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">myList&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="go">100
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">200
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">300
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 複数の戻り値を返す関数を定義する</title><link>https://maku77.github.io/p/dx4jebd/</link><pubDate>Mon, 03 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/dx4jebd/</guid><description>&lt;p>関数で配列を &lt;code>return&lt;/code> することで、複数の戻り値を返したのと同様なことを行えます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">foo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下記のように省略して書くことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">foo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>呼び出し側では、配列で受け取ることもできるし、多重代入を利用して、それぞれの値を別々に受け取ることもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># arr=&amp;gt;[100, 200, 300]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">z&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">foo&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># x=&amp;gt;100, y=&amp;gt;200, z=&amp;gt;300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 可変長引数を扱う関数を定義する</title><link>https://maku77.github.io/p/ykhgcoz/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ykhgcoz/</guid><description>&lt;p>Ruby の可変長引数は、最後のパラメータに &lt;code>*&lt;/code> を付けることで定義できます。
関数の内部では、配列として参照します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">arg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">rest_args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># do something&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;aaa&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># rest_args =&amp;gt; [1, 2, 3]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;aaa&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># rest_args =&amp;gt; [1]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;aaa&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># rest_args =&amp;gt; []&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># ERROR!&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 数値と文字列を変換する (to_i, to_f, to_s)</title><link>https://maku77.github.io/p/m9pkr73/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/m9pkr73/</guid><description>&lt;p>Ruby で数値と文字列の変換を行う場合は、下記のメソッドでほぼ事足ります。&lt;/p>
&lt;ul>
&lt;li>&lt;strong>to_i&lt;/strong>: 文字列 → 数値（整数）への変換&lt;/li>
&lt;li>&lt;strong>to_f&lt;/strong>: 文字列 → 数値（浮動小数点数）への変換&lt;/li>
&lt;li>&lt;strong>to_s&lt;/strong>: 数値 → 文字列への変換&lt;/li>
&lt;/ul>
&lt;p>&lt;code>to_i&lt;/code> と &lt;code>to_s&lt;/code> はデフォルトで十進数として処理しようとしますが、パラメータで任意の基数 (base) を指定することもできます。&lt;/p>
&lt;h2 id="2-進数表記の文字列--数値">2 進数表記の文字列 → 数値&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;1111&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;0b1111&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 15&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="8-進数表記の文字列--数値">8 進数表記の文字列 → 数値&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;1000&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 512&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;01000&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 512&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="16-進数表記の文字列--数値">16 進数表記の文字列 → 数値&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;FFFF&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 65535&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;0xFFFF&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; 65535&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文字列を &lt;code>to_i&lt;/code> で数値に変換する場合、先頭の連続した 0 は無視されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;00001234&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span> &lt;span class="c1"># =&amp;gt; 1234&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="数値--2-進数表記の文字列">数値 → 2 進数表記の文字列&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">bin&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_s&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;1111&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">bin&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;%08b&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;00001111&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 数値のインクリメントとデクリメント</title><link>https://maku77.github.io/p/fdx622r/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/fdx622r/</guid><description>&lt;p>Ruby で数値変数のインクリメントやデクリメントを行うには、&lt;code>+=&lt;/code> 演算子や &lt;code>-=&lt;/code> 演算子を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">num&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">num&lt;/span> &lt;span class="o">-=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>C/C++ や Java とは異なり、&lt;strong>Ruby では以下のように記述することはできません&lt;/strong>。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">++&lt;/span>&lt;span class="n">num&lt;/span> &lt;span class="c1"># 間違った書き方&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">num&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="c1"># 間違った書き方&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列をデリミタで分割する</title><link>https://maku77.github.io/p/hd66e3i/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/hd66e3i/</guid><description>&lt;p>&lt;code>String#split&lt;/code> は指定したデリミタ文字列（正規表現による区切り文字列の指定も可能）で文字列を分割し、その結果を配列で返します。&lt;/p>
&lt;h2 id="デリミタを省略した場合連続するスペースで区切る">デリミタを省略した場合（連続するスペースで区切る）&lt;/h2>
&lt;p>デリミタを省略すると、文字列の先頭と末尾のスペースを取り除いた上で、連続した空白文字で分割してくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A B C&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A B C &amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;A&lt;/span>&lt;span class="se">\t&lt;/span>&lt;span class="s2"> B &lt;/span>&lt;span class="se">\t&lt;/span>&lt;span class="s2">C&lt;/span>&lt;span class="se">\t&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>デリミタとして &lt;code>nil&lt;/code> や &lt;code>' '&lt;/code>（1 文字の半角スペース）を指定した場合も、省略時と同様に振る舞います。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A B C &amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kp">nil&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="デリミタを指定した場合">デリミタを指定した場合&lt;/h2>
&lt;p>下記は、連続するスペースの代わりにカンマで区切る例です。
文字列の末尾に連続して現れるデリミタは無視されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A,B,C&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A, B, C&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34; B&amp;#34;, &amp;#34; C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A,,B,C&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;,,A,B,C&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;&amp;#34;, &amp;#34;&amp;#34;, &amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A,B,C,,,&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;] ★末尾の連続するセパレータは無視される&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;A,B,C, , &amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; [&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;, &amp;#34; &amp;#34;, &amp;#34; &amp;#34;] ★セパレータ間にスペースがあれば無視されない&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下記のようにすれば、文字列の先頭と末尾、各セパレータの前後のスペースを取り除きつつ分割することができます。&lt;/p></description></item><item><title>Rubyメモ: 標準出力へ出力する (puts/print/printf)</title><link>https://maku77.github.io/p/a2zcbyr/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/a2zcbyr/</guid><description>&lt;h2 id="単純な出力-puts--print">単純な出力 (puts / print)&lt;/h2>
&lt;p>標準出力へ文字列を出力するには、組み込みの &lt;code>puts&lt;/code> 関数を使用します。
代わりに &lt;code>print&lt;/code> を使用すると、最後に改行を行いません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Hello, Ruby!&amp;#39;&lt;/span> &lt;span class="c1"># 改行あり&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="s1">&amp;#39;Hello, Ruby!&amp;#39;&lt;/span> &lt;span class="c1"># 改行なし&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>文字列をダブルクォーテーションで囲むと、変数展開を行って出力できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;val = &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>以下のようにカンマで引数を区切ると、&lt;code>puts&lt;/code> の場合は各値が改行付きで出力され、&lt;code>print&lt;/code> の場合は連結されて出力されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="nb">print&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">123&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="書式指定して出力-printf--puts--">書式指定して出力 (printf / puts + %)&lt;/h2>
&lt;p>&lt;code>printf&lt;/code> は C 言語の &lt;code>printf&lt;/code> と同様に書式付き文字列を使用してデータを出力します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Line: %d says %s&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;hello&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>puts&lt;/code> と &lt;code>%&lt;/code> を組み合わせて、書式付き文字列を扱うこともできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;%4d-%02d-%02d&amp;#39;&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="n">year&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">month&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">day&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 配列をループで処理する</title><link>https://maku77.github.io/p/4uubbev/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/4uubbev/</guid><description>&lt;h1 id="配列内の要素を順番に処理">配列内の要素を順番に処理&lt;/h1>
&lt;p>配列内の値だけを順番に処理したい場合は、&lt;strong>Array#each&lt;/strong> を使用するのが一番簡単です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">reverse_each&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1"># 逆順に処理&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="インデックスと値を同時に取得しながらループ">インデックスと値を同時に取得しながらループ&lt;/h1>
&lt;p>ループ中にインデックスも同時に使いたい場合は、&lt;strong>Array#each_with_index&lt;/strong> が使えます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_with_index&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">val&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">0: elem1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1: elem2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2: elem3&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h1 id="インデックスだけでループ">インデックスだけでループ&lt;/h1>
&lt;p>C 言語風に、インデックスベースでループを回したい場合は、&lt;strong>upto&lt;/strong>、&lt;strong>for~in&lt;/strong>、&lt;strong>times&lt;/strong> など、いろいろな方法が使えます。&lt;/p>
&lt;h2 id="upto-を使う方法">upto を使う方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="mi">0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">upto&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="for--in-を使う方法">for ~ in を使う方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>配列サイズ - 1&lt;/code> のインデックスまでループさせるために、ドットの数は 3 つ (&lt;code>...&lt;/code>) になることに注意してください。
ドットの数を 2 つ (&lt;code>..&lt;/code>) にすると、配列サイズと同じインデックス位置の要素までアクセスしてしまいます（結果として最後に &lt;code>nil&lt;/code> が取得されます）。&lt;/p>
&lt;h2 id="times-を使う方法">times を使う方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>times&lt;/code> のブロックに渡されるパラメータは &lt;code>0&lt;/code> からスタートするので、配列インデックスとして使用できます。&lt;/p></description></item><item><title>Rubyメモ: 配列を展開して関数に渡す</title><link>https://maku77.github.io/p/eqa98oa/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/eqa98oa/</guid><description>&lt;p>配列を関数に渡すときに頭に &lt;code>*&lt;/code> を付けて渡すと、配列が展開されて渡されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hoge&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">arr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 関数を一行で定義する</title><link>https://maku77.github.io/p/r7nk7ap/</link><pubDate>Sat, 01 Oct 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/r7nk7ap/</guid><description>&lt;p>各行をセミコロンでつなげば、関数を一行で定義できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>プログラミングコンテストなどで、コードを短く書きたい場合にマクロ風に使うと便利です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">readInt&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">gets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chomp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">to_i&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">readInts&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">gets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chomp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="ss">:to_i&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: インデント用の文字列を作成する</title><link>https://maku77.github.io/p/s84ydu4/</link><pubDate>Fri, 29 Jul 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/s84ydu4/</guid><description>&lt;p>Ruby では文字列に対して &lt;code>*&lt;/code> 演算子を適用することで、その文字列を指定回数だけ繰り返した文字列を生成することができます。
下記の &lt;code>indent_str&lt;/code> 関数は、指定されたレベルのインデント用スペース文字列を作成します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">indent_str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">level&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s1">&amp;#39; &amp;#39;&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">level&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">indent_str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#39; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 外部プログラムを呼び出す</title><link>https://maku77.github.io/p/85axqoj/</link><pubDate>Fri, 29 Jul 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/85axqoj/</guid><description>&lt;h2 id="バッククォートを使用する方法">バッククォートを使用する方法&lt;/h2>
&lt;p>下記は Ruby プログラムの中から &lt;code>/bin/ls&lt;/code> を実行して、その出力結果を取得するサンプルです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sb">`/bin/ls`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">result&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>外部プログラムに対してパラメータを渡すこともできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sb">`/bin/ls &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">result&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>外部プログラムの出力結果を 1 行ずつ処理することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/ruby&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sb">`/bin/ls`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">result&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_line&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;===&amp;gt; &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>実行するコマンドを文字列変数に格納している場合は、下記のように実行時に展開できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">command&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;date /t&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sb">`&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="system-を使用する方法出力が必要ない場合">system を使用する方法（出力が必要ない場合）&lt;/h2>
&lt;p>ただ単に、外部のプログラムを呼び出すだけでよい場合は、&lt;code>system&lt;/code> を使用するのが手っ取り早いです。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ruby_version.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">system&lt;/span> &lt;span class="s1">&amp;#39;ruby -v&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>system&lt;/code> は与えられたプログラムを、新しいプロセスで実行します。
自分自身のプロセスを置き換える形でプログラムを実行したい場合は、&lt;code>Process.exec&lt;/code> を使用します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">my_ls.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Process&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ls&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="no">ARGV&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>自分自身のプロセスで外部プログラムを実行すれば、その実行を &lt;code>Ctrl-C&lt;/code> で強制終了できます。
（ただし、「MSDOS 環境の場合、command はサブシェル経由で実行されます」という記載がありました。
結局 Windows の場合は別のプロセスが起動してしまうようです。）&lt;/p>
&lt;h2 id="iopopen-を使用する方法">IO.popen を使用する方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">IO&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">popen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;dir&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;===&amp;gt; &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 文字列から正規表現にマッチする部分を取り出す (String#slice, Regexp#match, String#scan)</title><link>https://maku77.github.io/p/has6rjr/</link><pubDate>Fri, 29 Jul 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/has6rjr/</guid><description>&lt;h2 id="stringslice-で文字列の一部を簡単に抽出する">String#slice で文字列の一部を簡単に抽出する&lt;/h2>
&lt;p>ある文字列リテラル、あるいは文字列変数の中から、正規表現に一致する部分文字列を抽出するには、&lt;code>String#slice(Regexp)&lt;/code> を使用できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ABCDEFG&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">m&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/C.+/&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">m&lt;/span> &lt;span class="c1">#=&amp;gt; &amp;#34;CDEFG&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Not found&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>正規表現に一致する文字列が見つからない場合は、&lt;code>slice&lt;/code> メソッドは &lt;code>nil&lt;/code> を返します。&lt;/p>
&lt;h2 id="regexp-クラスを使う方法">Regexp クラスを使う方法&lt;/h2>
&lt;p>&lt;code>Regexp&lt;/code> クラスを使用すると、もう少し柔軟に部分文字列を抽出することができます。
下記の例では、最初に見つかった数値と、2 番目に見つかった数値を抽出しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">re&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Regexp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;(\d+)[^\d]+(\d+)&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;AAA123BBB456CCC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">m&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">re&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">match&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;123BBB456&amp;#34; # パターン全体と一致した部分文字列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;123&amp;#34; # 1番目のカッコ内と一致した部分文字列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;456&amp;#34; # 2番目のカッコ内と一致した部分文字列&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">m&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># =&amp;gt; nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;Not found&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>パターンに一致する部分文字列が見つからない場合は、&lt;code>Regexp#match&lt;/code> の戻り値は &lt;code>nil&lt;/code> になるので、上記のように必ず &lt;code>if&lt;/code> で分岐して処理しましょう。&lt;/p>
&lt;h2 id="stringscan-で同じパターンに一致する部分文字列をすべて配列で取得する">String#scan で同じパターンに一致する部分文字列をすべて配列で取得する&lt;/h2>
&lt;p>同じパターンで繰り返し出現する文字列を、配列の形ですべて抽出したいときは &lt;code>String#scan&lt;/code> を使用するのが簡単です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;AAA BBB CCC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">scan&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/\w+/&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="nb">puts&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>AAA
BBB
CCC
&lt;/code>&lt;/pre>&lt;p>正規表現パターン内を括弧（&lt;code>(&lt;/code> と &lt;code>)&lt;/code>）でグルーピングすれば、その単位で一致部分を抽出することができます。
パターン内に括弧を含む場合は、&lt;code>String#scan&lt;/code> の戻り値は 2 次元配列になることに注意してください。
2 次元目の各要素が、グループごとに一致した部分文字列になります。&lt;/p></description></item><item><title>Rubyメモ: REXML で XML ファイルを読み込む</title><link>https://maku77.github.io/p/a3z2tp7/</link><pubDate>Wed, 22 Jun 2011 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/a3z2tp7/</guid><description>&lt;h2 id="document-オブジェクトを作成する">Document オブジェクトを作成する&lt;/h2>
&lt;h3 id="xml-ファイルから作成">XML ファイルから作成&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;rexml/document&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">doc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Document&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.xml&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="n">doc&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="xml-文字列から作成">XML 文字列から作成&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;rexml/document&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">xml&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;lt;&amp;lt;EOL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">tree&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">trunk&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">leaf&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="no">Leaf&lt;/span> &lt;span class="n">A&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr"> &amp;lt;leaf id=&amp;#34;2&amp;#34;&amp;gt;Leaf B&amp;lt;/&lt;/span>&lt;span class="n">leaf&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">leaf&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="no">Leaf&lt;/span> &lt;span class="n">C&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr"> &amp;lt;/&lt;/span>&lt;span class="n">trunk&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/tree&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">EOL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">doc = REXML::Document.new xml
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">print doc
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="特定の要素を繰り返し処理する">特定の要素を繰り返し処理する&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;rexml/document&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">xml&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;lt;&amp;lt;EOL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">tree&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">trunk&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">leaf&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="no">Leaf&lt;/span> &lt;span class="n">A&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr"> &amp;lt;leaf id=&amp;#34;2&amp;#34;&amp;gt;Leaf B&amp;lt;/&lt;/span>&lt;span class="n">leaf&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">leaf&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="no">Leaf&lt;/span> &lt;span class="n">C&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr"> &amp;lt;/&lt;/span>&lt;span class="n">trunk&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sr">/tree&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">EOL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">doc = REXML::Document.new(xml)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sr">doc.elements.each(&amp;#39;tree/&lt;/span>&lt;span class="n">trunk&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">leaf&lt;/span>&lt;span class="s1">&amp;#39;) { |element|
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> puts element
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> puts element.text
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> puts element.attributes[&amp;#39;&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">出力結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">&amp;lt;leaf id=&amp;#39;1&amp;#39;&amp;gt;Leaf A&amp;lt;/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Leaf A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;leaf id=&amp;#39;2&amp;#39;&amp;gt;Leaf B&amp;lt;/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Leaf B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;leaf id=&amp;#39;3&amp;#39;&amp;gt;Leaf C&amp;lt;/leaf&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Leaf C
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>指定する要素の階層が決まっていない場合は、&lt;code>REXML::XPath.each()&lt;/code> を使えば、位置に関係なくすべての要素を処理できます。&lt;/p></description></item><item><title>Rubyメモ: REXML で XML ファイルを作成する</title><link>https://maku77.github.io/p/sapxuyk/</link><pubDate>Sun, 13 Jun 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sapxuyk/</guid><description>&lt;h1 id="xml-ファイルの出力基本">XML ファイルの出力（基本）&lt;/h1>
&lt;p>下記のプログラムは、XML の宣言要素だけを出力するサンプルです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;rexml/document&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">doc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Document&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">doc&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">XMLDecl&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;1.0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;UTF-8&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;output.xml&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;w&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">indent&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">出力結果 (output.xml)&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;?xml version=&amp;#39;1.0&amp;#39; encoding=&amp;#39;UTF-8&amp;#39;?&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>出力をファイルではなく、標準出力に変更したい場合は、下記のようにします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">doc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">STDOUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="子要素を追加する">子要素を追加する&lt;/h1>
&lt;p>要素を追加していくには、&lt;code>REXML::Element&lt;/code> オブジェクトを作成します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ルートノードを作成&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Element&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Root&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">doc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ルートノードの下に子ノードを追加&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Element&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Child&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">REXML&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Element&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Child&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Text1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Text2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_attribute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;attr&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value1&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">child2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_attribute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;attr&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value2&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">child1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">root&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_element&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">child2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>以下のような XML が生成されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;?xml version=&amp;#39;1.0&amp;#39; encoding=&amp;#39;UTF-8&amp;#39;?&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;Root&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Child&lt;/span> &lt;span class="na">attr=&lt;/span>&lt;span class="s">&amp;#39;value1&amp;#39;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Text1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Child&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;Child&lt;/span> &lt;span class="na">attr=&lt;/span>&lt;span class="s">&amp;#39;value2&amp;#39;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Text2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/Child&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">&amp;lt;/Root&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: REXML とは</title><link>https://maku77.github.io/p/wmrawp3/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wmrawp3/</guid><description>&lt;p>Ruby 1.8 以上には XML のパーサライブラリである &lt;strong>REXML&lt;/strong> が標準で添付されています。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.germane-software.com/software/rexml/">REXML&lt;/a>
&lt;ul>
&lt;li>&lt;a href="http://www.germane-software.com/software/rexml/docs/tutorial.html">REXML - Tutorial&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.germane-software.com/software/XML/rexml/doc/">REXML - API Document&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>REXML は以下のような種類のパーサに対応しており、XPath もサポートしています。&lt;/p>
&lt;ul>
&lt;li>DOM 風パーサ&lt;/li>
&lt;li>SAX2 パーサ&lt;/li>
&lt;li>Pull パーサ&lt;/li>
&lt;li>Stream パーサ&lt;/li>
&lt;/ul></description></item><item><title>Rubyメモ: ディレクトリを作成／削除する</title><link>https://maku77.github.io/p/rsiaoio/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/rsiaoio/</guid><description>&lt;h1 id="ディレクトリ作成削除のための-api">ディレクトリ作成／削除のための API&lt;/h1>
&lt;p>ディレクトリの作成や削除を行いたい場合は、&lt;code>Dir&lt;/code> クラスの下記のメソッドを使用します。&lt;/p>
&lt;ul>
&lt;li>ディレクトリの作成
&lt;ul>
&lt;li>&lt;code>Dir.mkdir(path)&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ディレクトリの削除
&lt;ul>
&lt;li>&lt;code>Dir.delete(path)&lt;/code>&lt;/li>
&lt;li>&lt;code>Dir.rmdir(path)&lt;/code>&lt;/li>
&lt;li>&lt;code>Dir.unlink(path)&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h1 id="ディレクトリ作成の例">ディレクトリ作成の例&lt;/h1>
&lt;h2 id="カレントディレクトリ以下にディレクトリを作成する">カレントディレクトリ以下にディレクトリを作成する&lt;/h2>
&lt;p>下記は、カレントディレクトリに sample ディレクトリを作成する例です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;./sample&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>すでにディレクトリがあるなどの理由で、ディレクトリの作成に失敗した場合は、&lt;code>SystemCallError&lt;/code> が発生します。
この例外を捕捉する必要がある場合は、以下のようにします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;./sample&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">rescue&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="n">e&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">STDERR&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">message&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ディレクトリの有無を先にチェックしておけば、すでに存在する場合のエラーを防止することができます。
この場合でも、ディレクトリの作成に失敗することはある（権限がないなど）ので、きちんと例外処理をしておくのが望ましいです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exist?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">rescue&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="n">e&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">STDERR&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">puts&lt;/span> &lt;span class="s1">&amp;#39;エラー: ディレクトリを作成できません&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="c1"># 継続不能であればプログラム終了&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="home-ディレクトリ以下にディレクトリを作成する">HOME ディレクトリ以下にディレクトリを作成する&lt;/h2>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: ~/.myconf ディレクトリをパーミッション 0700 で作成&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;.myconf&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mo">0700&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exist?&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: ディレクトリ内のファイルを列挙する</title><link>https://maku77.github.io/p/kzuq3cd/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/kzuq3cd/</guid><description>&lt;h1 id="ディレクトリ内のファイルディレクトリを列挙する一階層のみ">ディレクトリ内のファイル／ディレクトリを列挙する（一階層のみ）&lt;/h1>
&lt;h2 id="dirforeach-を使用する方法">Dir.foreach を使用する方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">foreach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>カレントディレクトリを示す &lt;code>.&lt;/code> や親ディレクトリを示す &lt;code>..&lt;/code> が含まれてしまうので、これらを除いて列挙したい場合は、下記のように除外する必要があります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">foreach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">next&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;..&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="diropen-を使用する方法">Dir.open を使用する方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">dir&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">item&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="n">dir&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>この方法では、&lt;code>Dir.foreach&lt;/code> を用いた場合と同様の結果が得られます。&lt;/p>
&lt;h2 id="dirglob-を使用する方法">Dir.glob を使用する方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;*&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Dir.glob&lt;/code> では、ファイルパターンを指定してファイルを列挙することができます。
列挙される要素には &lt;code>.&lt;/code> や &lt;code>..&lt;/code> などのディレクトリや、ドットで始まるファイルは含まれません。&lt;/p>
&lt;h1 id="下位ディレクトリを再帰的に列挙する">下位ディレクトリを再帰的に列挙する&lt;/h1>
&lt;h2 id="dirglob-を使用する方法-1">Dir.glob を使用する方法&lt;/h2>
&lt;p>ディレクトリ内のファイルとディレクトリを再帰的に列挙したい場合は、&lt;code>Dir.glob&lt;/code> を使用すると簡単です。
&lt;code>Dir.glob&lt;/code> の検索パターンに &lt;code>**&lt;/code> を含めると、深い階層のディレクトリに含まれるファイルまで検索してくれます。
下記のようにすると、カレントディレクトリ以下のファイルをすべて列挙します（ただし、ドットで始まるファイルは含まれません）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;**/*&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="findrb-を使用する方法">find.rb を使用する方法&lt;/h2>
&lt;p>Ruby に標準で付属している &lt;code>find.rb&lt;/code> が提供する &lt;code>Find.find&lt;/code> メソッドを使用してファイルを再帰的に列挙する方法もあります。&lt;/p>
&lt;p>&lt;code>Find.find&lt;/code> メソッドの結果には、親ディレクトリ (&lt;code>..&lt;/code>) は含まれませんが、自分自身のディレクトリ (&lt;code>.&lt;/code>) や、ドットファイルは含まれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;find&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">Find&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>下記は少し応用して、次の処理を行うサンプルです。&lt;/p>
&lt;ul>
&lt;li>スクリプトの引数でディレクトリを指定&lt;/li>
&lt;li>ファイルのベース名だけを表示&lt;/li>
&lt;li>ファイルの種類をファイル名の後ろに表示&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">require&lt;/span> &lt;span class="s1">&amp;#39;find&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">?&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">Find&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">find&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">base&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">basename&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">base&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="se">\t&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ftype&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="自力で再帰処理を記述する方法">自力で再帰処理を記述する方法&lt;/h2>
&lt;p>自力でディレクトリ内のファイルを再帰的に列挙すると、次のような感じになります。&lt;/p></description></item><item><title>Rubyメモ: ディレクトリ内のファイルを検索する</title><link>https://maku77.github.io/p/zpoj5yq/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/zpoj5yq/</guid><description>&lt;p>&lt;code>Dir[pattern]&lt;/code> や &lt;code>Dir.glob(pattern)&lt;/code> を使うと、ワイルドカードでファイルを検索して列挙することができます。
検索パターンの中では &lt;code>*&lt;/code>、&lt;code>?&lt;/code>、&lt;code>[]&lt;/code>、&lt;code>{}&lt;/code> などを使用できます。
以下の例では、カレントディレクトリ以下の html ファイル (&lt;code>*.html&lt;/code>) を検索しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;**/*.html&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>もちろん、指定したディレクトリを起点にして検索することもできます。
下記の例では、コマンドライン引数で指定したディレクトリを起点にして html ファイルを再帰的に検索します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">?&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/**/*.html&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">item&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">item&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>複数のパターンで OR 検索したい場合は、それぞれのパターンを &lt;code>\0&lt;/code> で区切って指定します。
下記の例では、カレントディレクトリ以下の cpp ファイルと h ファイルを検索します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">Dir&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;**/*.cpp&lt;/span>&lt;span class="se">\0&lt;/span>&lt;span class="s2">**/*.h&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>大量のファイルを含むディレクトリから &lt;code>Dir.glob&lt;/code> を使用してファイルを検索しようとすると、結果が返ってくるまでに非常に時間がかかります。
そのような場合は、&lt;code>Dir.foreach&lt;/code> などを使用して自力で再帰検索することを検討してください。&lt;/p></description></item><item><title>Rubyメモ: テキストファイルを読み込む</title><link>https://maku77.github.io/p/wzbqu3e/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wzbqu3e/</guid><description>&lt;h1 id="テキストファイルを一行ずつ読み込む">テキストファイルを一行ずつ読み込む&lt;/h1>
&lt;h2 id="c-言語的な書き方">C 言語的な書き方&lt;/h2>
&lt;p>下記のように &lt;code>open&lt;/code> 関数を単独で使用する場合は、明示的な &lt;code>close&lt;/code> 処理が必要です。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">IO#each を使う方法&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">IO#gets を使う方法&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ブロックパラメータを使用する書き方">ブロックパラメータを使用する書き方&lt;/h2>
&lt;p>ファイルの &lt;code>open&lt;/code> 時にブロックを指定すると、自動で &lt;code>close&lt;/code> 処理を行ってくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のように、ブロックパラメータである &lt;code>file&lt;/code> 変数を一度しか参照しないのであれば、下記のように &lt;code>open&lt;/code> と &lt;code>each&lt;/code> をチェーンすることで、より簡潔に記述することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="fileforeach-を使う方法">File.foreach を使う方法&lt;/h2>
&lt;p>テキストファイルを 1 行ずつ処理する場合は、&lt;code>File.foreach&lt;/code> を使用すると、とてもシンプルに記述できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">File&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">foreach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="テキストファイルから最初の一行だけ読み込む">テキストファイルから最初の一行だけ読み込む&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;input.txt&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 様々なディレクトリのパスを取得する／パスを加工する</title><link>https://maku77.github.io/p/vynqmh5/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/vynqmh5/</guid><description>&lt;h1 id="ディレクトリパスを取得するためのメソッド">ディレクトリパスを取得するためのメソッド&lt;/h1>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>取得したいディレクトリ&lt;/th>
 &lt;th>メソッド&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>カレントディレクトリ&lt;/td>
 &lt;td>&lt;code>Dir.pwd&lt;/code>&lt;br>&lt;code>Dir.getwd&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>ホームディレクトリ&lt;/td>
 &lt;td>&lt;code>Dir.home&lt;/code>&lt;br>&lt;code>ENV['HOME']&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;h1 id="パス文字列を加工するためのメソッド">パス文字列を加工するためのメソッド&lt;/h1>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>操作&lt;/th>
 &lt;th>メソッド&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>パスの結合&lt;/td>
 &lt;td>&lt;code>File.join(path1, path2)&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>パス → ディレクトリ名&lt;/td>
 &lt;td>&lt;code>File.dirname(path)&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>パス → ファイル名&lt;/td>
 &lt;td>&lt;code>File.basename(path)&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>パス → ファイル名&lt;br>（指定したサフィックスを除いたもの）&lt;/td>
 &lt;td>&lt;code>File.basename(path, '.rb')&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>パス → 拡張子名&lt;/td>
 &lt;td>&lt;code>File.extname(path)&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>相対パス → 絶対パス&lt;/td>
 &lt;td>&lt;code>File.expand_path(filename)&lt;/code> ※1&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>※1 … スクリプト実行時のカレントディレクトリを単純にプレフィックスとして付加するだけなので、ディレクトリを再帰処理するような場合は、&lt;code>File.expand_path&lt;/code> は正しく動作しません。このような場合は、&lt;code>File.join(dir_path, filename)&lt;/code> のように自力で結合すれば OK です。&lt;/p></description></item><item><title>Rubyメモ: 標準入力から読み込む (gets)</title><link>https://maku77.github.io/p/h3uzf9m/</link><pubDate>Fri, 07 May 2010 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/h3uzf9m/</guid><description>&lt;h2 id="標準入力からの読み込み">標準入力からの読み込み&lt;/h2>
&lt;p>下記のように、リダイレクトやパイプで渡されたテキスト（標準入力）を読み込みたい場合のお話です。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ./main.rb &amp;lt; input.txt
$ cat input.txt | ./main.rb
&lt;/code>&lt;/pre>&lt;h2 id="標準入力からすべての行を一行ずつ読み込む">標準入力からすべての行を一行ずつ読み込む&lt;/h2>
&lt;p>標準入力から次の一行を読み込むには、&lt;code>ARGF.gets&lt;/code> を使用します。
&lt;code>ARGF.gets&lt;/code> は &lt;code>gets&lt;/code> と省略できます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">方法 (1) ARGF.gets&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="s1">&amp;#39;&amp;gt; &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>ARGF.each&lt;/code> でループ処理させることもできます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">方法 (2) ARGF.each&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">ARGF&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="s1">&amp;#39;&amp;gt; &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="インデックスを付けながら一行ずつ読み込む">インデックスを付けながら一行ずつ読み込む&lt;/h2>
&lt;p>&lt;code>ARGF.each&lt;/code> の代わりに、&lt;code>ARGF.each_with_index&lt;/code> を使用すると、インデックスを取得しながらループ処理を行えます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">ARGF&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each_with_index&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">: &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">line&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="argf-はフィルタプログラム作成用に便利">ARGF はフィルタプログラム作成用に便利&lt;/h2>
&lt;p>&lt;code>ARGF&lt;/code> (&lt;code>$&amp;lt;&lt;/code>) は、コマンドライン引数にファイル名を指定した場合は、ファイルの内容を読み出すための仮想ファイルハンドルとして働き、ファイル名を指定しなかった場合は標準入力から内容を読み出すために使用できます。&lt;/p>
&lt;p>例えば、テキストに行番号を付加するフィルタプログラムは以下のように記述できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGF&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="vg">$.&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>コマンドライン引数に複数のファイル名を指定した場合も、&lt;code>ARGF&lt;/code> は連結されたテキストデータとして読み込んでくれます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb input1.txt input2.txt input3.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>つまり、&lt;code>ARGF&lt;/code> を使ったコーディングを行うことによって、テキストファイルや標準入力からの入力テキストを一気に加工して出力するフィルタプログラムを簡単に作成できるようになっています。&lt;/p></description></item><item><title>Rubyメモ: プロファイラを使用してボトルネックを探る</title><link>https://maku77.github.io/p/fydda5r/</link><pubDate>Fri, 16 May 2008 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/fydda5r/</guid><description>&lt;p>&lt;code>ruby&lt;/code> コマンドを実行するときに、&lt;code>-rprofile&lt;/code> オプションを指定すると、各関数呼び出しにどれだけ時間がかかっているかのプロファイル情報を表示してくれるようになります。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ruby -rprofile sample.rb
 % cumulative self self total
 time seconds seconds calls ms/call ms/call name
100.00 0.02 0.02 17 0.94 0.94 Array#each
 0.00 0.02 0.00 1 0.00 0.00 Fixnum#to_s
 0.00 0.02 0.00 18 0.00 0.00 Thread.current
 0.00 0.02 0.00 6 0.00 0.00 Mutex#lock
 0.00 0.02 0.00 6 0.00 0.00 MonitorMixin#mon_enter
 0.00 0.02 0.00 8 0.00 0.00 Kernel#respond_to_missing?
 0.00 0.02 0.00 6 0.00 0.00 Kernel#respond_to?
 0.00 0.02 0.00 6 0.00 0.00 Gem.suffixes
 0.00 0.02 0.00 24 0.00 0.00 Gem.find_unresolved_default_spec
 ...
&lt;/code>&lt;/pre>&lt;p>プロファイルオプションを有効にすると、全体の実行時間は遅くなります。
あくまで、相対的な呼び出し時間の割合を見ることでボトルネックを探すためのものです。&lt;/p></description></item><item><title>Rubyメモ: 配列の各要素の値を変更する (collect)</title><link>https://maku77.github.io/p/eoudxxo/</link><pubDate>Wed, 10 Oct 2007 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/eoudxxo/</guid><description>&lt;p>&lt;code>Array#collect&lt;/code> メソッドを使用すると、配列の各要素に対して任意の計算を行った結果の配列を作成できます。
末尾に &lt;code>!&lt;/code> を付けて実行すると、自分自身の配列を書き換えます。
下記の例では、配列の各要素の値を 2 乗しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">arr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">collect!&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">**&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="n">arr&lt;/span> &lt;span class="c1"># =&amp;gt; [1, 4, 9, 16, 25]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: コマンドライン引数を扱う</title><link>https://maku77.github.io/p/btwa5fv/</link><pubDate>Fri, 16 Jun 2006 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/btwa5fv/</guid><description>&lt;h1 id="コマンドライン引数を取得する">コマンドライン引数を取得する&lt;/h1>
&lt;p>&lt;code>ARGV&lt;/code> を使用して、コマンドライン引数の数や、値を取得することができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">size&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb AAA BBB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">AAA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BBB
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">nil
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>指定したインデックスに対応するコマンドライン引数が存在しない場合は、&lt;code>nil&lt;/code> を返します。&lt;/p>
&lt;h1 id="コマンドライン引数をループで処理する">コマンドライン引数をループで処理する&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">arg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">shift&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">arg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ARGV&lt;/code> は配列としてアクセスできるので、&lt;code>Array#shift&lt;/code> メソッドを使って、コマンドライン引数を一つずつ取得することができます。
&lt;code>shift&lt;/code> メソッドは要素が空 (&lt;code>[]&lt;/code>) になると最後に &lt;code>nil&lt;/code> を返すので、上記のように &lt;code>while&lt;/code> ループで列挙できます。&lt;/p>
&lt;h1 id="コマンドライン引数が-0-個の場合に-usage-を表示して終了">コマンドライン引数が 0 個の場合に Usage を表示して終了&lt;/h1>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.rb&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">show_usage&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s2">&amp;#34;Usage: &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="vg">$0&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;lt;InputFile&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">show_usage&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="no">ARGV&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">empty?&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ruby sample.rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Usage: sample.rb &amp;lt;InputFile&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 乱数（ランダムな数値）を生成する</title><link>https://maku77.github.io/p/rbcp4ou/</link><pubDate>Fri, 17 Oct 2003 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/rbcp4ou/</guid><description>&lt;h2 id="整数の乱数">整数の乱数&lt;/h2>
&lt;p>&lt;code>rand&lt;/code> 関数の引数 (max) に 1 以上の整数を指定すると、&lt;strong>0 以上 max 未満の整数&lt;/strong>をランダムに作成します。
乱数の種（シード）を指定したい場合は、&lt;code>srand&lt;/code> 関数を使います。
&lt;code>rand&lt;/code> 関数を呼び出す前に &lt;code>srand&lt;/code> を実行していなかった場合は自動的に実行してくれるので、通常は明示的に &lt;code>srand&lt;/code> を呼び出す必要はありません。&lt;/p>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">0 以上 100 未満の整数 (0〜99)&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="nb">rand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#=&amp;gt; 87&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">50 以上 150 未満の整数 (50〜149)&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="nb">rand&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">50&lt;/span> &lt;span class="c1">#=&amp;gt; 115&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;h2 id="実数浮動小数点数の乱数">実数（浮動小数点数）の乱数&lt;/h2>
&lt;p>&lt;code>rand&lt;/code> 関数の引数 (max) に &lt;code>nil&lt;/code> または &lt;code>0&lt;/code> を指定すると、&lt;strong>0 以上 1 未満の実数値 Float&lt;/strong> をランダムに生成します。
引数を省略した場合も同様です。&lt;/p>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">0 以上 1 未満の実数&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span> &lt;span class="nb">rand&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">#=&amp;gt; 0.608581543&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: Ruby のコーディングスタイル</title><link>https://maku77.github.io/p/7wv9hrf/</link><pubDate>Tue, 14 Oct 2003 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/7wv9hrf/</guid><description>&lt;h2 id="命名規則">命名規則&lt;/h2>
&lt;p>Ruby では変数名のプレフィックスに記号をつけることにより、グローバル変数、インスタンス変数、クラス変数を区別します。&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>タイプ&lt;/th>
 &lt;th>変数名のルール&lt;/th>
 &lt;th>例&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>ローカル変数&lt;/td>
 &lt;td>英数字で始まる&lt;/td>
 &lt;td>&lt;code>local_var&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>グローバル変数&lt;/td>
 &lt;td>&lt;code>$&lt;/code> で始まる&lt;/td>
 &lt;td>&lt;code>$global_var&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>インスタンス変数&lt;/td>
 &lt;td>&lt;code>@&lt;/code> で始まる&lt;/td>
 &lt;td>&lt;code>@instance_var&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>クラス変数&lt;/td>
 &lt;td>&lt;code>@@&lt;/code> で始まる&lt;/td>
 &lt;td>&lt;code>@@class_var&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>大文字、小文字の使い分けについては次のようにすることが多いようです。&lt;/p>
&lt;ul>
&lt;li>クラス名は大文字で始める（例: &lt;code>MyClass&lt;/code>）&lt;/li>
&lt;li>変数名、メソッドは小文字で始める（例: &lt;code>my_var&lt;/code>、&lt;code>my_method&lt;/code>）&lt;/li>
&lt;li>定数名はすべて大文字（例: &lt;code>MY_CONSTANT&lt;/code>）&lt;/li>
&lt;/ul>
&lt;h2 id="インデントスペース">インデント／スペース&lt;/h2>
&lt;ul>
&lt;li>インデントはスペース &lt;strong>2 文字&lt;/strong>（Ruby 公式サイトと同様）&lt;/li>
&lt;li>一行は &lt;strong>80 文字&lt;/strong>まで&lt;/li>
&lt;/ul>
&lt;h2 id="文字列リテラル">文字列リテラル&lt;/h2>
&lt;ul>
&lt;li>式展開の必要のない文字列リテラルは&lt;strong>シングルクォーテーション&lt;/strong>で囲む（例: &lt;code>'abc'&lt;/code>）&lt;/li>
&lt;li>式展開の必要がある文字列リテラルは&lt;strong>ダブルクォーテーション&lt;/strong>で囲む（例: &lt;code>&amp;quot;Hello #{name}&amp;quot;&lt;/code>）&lt;/li>
&lt;/ul>
&lt;h2 id="ファイル名">ファイル名&lt;/h2>
&lt;p>ファイル名はすべて小文字で、クラス名などの単語の区切りはアンダースコア (&lt;code>_&lt;/code>) を使用する。
モジュールの階層はディレクトリ階層で表現する。&lt;/p>
&lt;ul>
&lt;li>&lt;code>test_case.rb&lt;/code>（TestCase クラス）&lt;/li>
&lt;li>&lt;code>unit/test_case.rb&lt;/code>（Unit モジュール以下の TestCase クラス）&lt;/li>
&lt;/ul>
&lt;p>このルールは、下記の RubyGems の命名規則を考慮しています。&lt;/p>
&lt;h2 id="rubygems-で公開する-gem-パッケージの命名規則">RubyGems で公開する Gem パッケージの命名規則&lt;/h2>
&lt;p>RubyGems.org などで公開する Gem の名前は、フラットなファイル名で一意に命名する必要があるため、アンダースコアやハイフンの使い方がルール化されています。&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>Gem name&lt;/th>
 &lt;th>Require statement&lt;/th>
 &lt;th>Main class or module&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;code>ruby_parser&lt;/code>&lt;/td>
 &lt;td>&lt;code>require 'ruby_parser'&lt;/code>&lt;/td>
 &lt;td>&lt;code>RubyParser&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>rdoc-data&lt;/code>&lt;/td>
 &lt;td>&lt;code>require 'rdoc/data'&lt;/code>&lt;/td>
 &lt;td>&lt;code>RDoc::Data&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>net-http-persistent&lt;/code>&lt;/td>
 &lt;td>&lt;code>require 'net/http/persistent'&lt;/code>&lt;/td>
 &lt;td>&lt;code>Net::HTTP::Persistent&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;code>net-http-digest_auth&lt;/code>&lt;/td>
 &lt;td>&lt;code>require 'net/http/digest_auth'&lt;/code>&lt;/td>
 &lt;td>&lt;code>Net::HTTP::DigestAuth&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>ファイルシステムへの依存を防ぐため、Gem 名はすべて小文字。&lt;/li>
&lt;li>モジュール名やクラス名の単語の区切りはアンダースコア (&lt;code>_&lt;/code>) 。&lt;/li>
&lt;li>既存モジュールを拡張する場合の区切りはハイフン (&lt;code>-&lt;/code>)。実際のモジュールファイルはディレクトリ構造を作って格納する。&lt;/li>
&lt;li>拡張が複数階層になった場合は、その分だけディレクトリ構造を掘り下げればよい。&lt;/li>
&lt;/ul>
&lt;p>例えば、&lt;code>net-http-digest_auth&lt;/code> という名前の Gem が提供する &lt;code>DigestAuth&lt;/code> クラスは、実際には下記のようなファイルとして作成されています。&lt;/p></description></item><item><title>Rubyメモ: クラスとメソッドを定義する</title><link>https://maku77.github.io/p/twb57kz/</link><pubDate>Mon, 13 Oct 2003 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/twb57kz/</guid><description>&lt;h1 id="クラスとメソッドの定義">クラスとメソッドの定義&lt;/h1>
&lt;p>下記は、メソッドを 1 つだけ持つクラスの例です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">MyClass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>定義したクラスを利用するには、&lt;code>new&lt;/code> メソッドによりインスタンスを作成します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># インスタンス化&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">obj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">MyClass&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># メソッドの呼び出し&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">obj&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 関数定義の基本</title><link>https://maku77.github.io/p/3sgsrtu/</link><pubDate>Mon, 13 Oct 2003 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/3sgsrtu/</guid><description>&lt;p>Ruby の関数は、下記のように &lt;code>def&lt;/code> キーワードを使用して定義します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># メソッドの定義&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># メソッドの呼び出し&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>戻り値は &lt;code>return&lt;/code> を使って明示できますが、最後に評価した値が関数の戻り値として扱われるので、多くの場合は &lt;code>return&lt;/code> を省略できます。
むしろ &lt;code>return&lt;/code> を省略した方が少しだけ処理が速いらしいです（『Ruby ソースコード完全解説』より）。&lt;/p></description></item><item><title>Rubyメモ: ソースコード内にテキストデータを埋め込む</title><link>https://maku77.github.io/p/m6zz7z2/</link><pubDate>Sun, 05 Oct 2003 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/m6zz7z2/</guid><description>&lt;p>&lt;code>DATA&lt;/code> 変数を参照すると、ソースコード内の &lt;code>__END__&lt;/code> 行以下に配置されたテキストデータを参照することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="n">line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">DATA&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span> &lt;span class="n">line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">__END__
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">埋め込みテキストデータ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">埋め込みテキストデータ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">埋め込みテキストデータ
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 複数の値を同時に代入する（多重代入）</title><link>https://maku77.github.io/p/ggekbmf/</link><pubDate>Mon, 02 Sep 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ggekbmf/</guid><description>&lt;h2 id="多重代入の基本">多重代入の基本&lt;/h2>
&lt;p>Ruby の代入式は、複数の左辺値や右辺値をとることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のような代入式を記述すると、次のように個別に代入するのと同様の結果になります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>多重代入によるそれぞれの代入処理は並列に行われるため、次のように変数の値をスワップできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="左辺値の方が多いとき">左辺値の方が多いとき&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の場合、&lt;code>c&lt;/code> の値は &lt;code>nil&lt;/code> となります。&lt;/p>
&lt;h2 id="右辺値の方が多いとき">右辺値の方が多いとき&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の場合、右辺値の 300 は単純に破棄されます。&lt;/p>
&lt;p>左辺値の 1 つにプレフィックスとしてアスタリスク &lt;code>*&lt;/code> を付けることにより、過剰な右辺値をまとめて配列の形で受け取ることができます。
アスタリスクはどの変数に付けても構いませんが、左辺値のうち 1 つにしか付けられません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="c1"># a=100, b=[200,300]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">*&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="c1"># a=[100,200], b=300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">*&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="c1"># シンタックスエラー&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>アスタリスクの付いた変数は必ず配列の形になります。
これは、左辺値と右辺値の数が等しい場合や、左辺値の方が多い場合も同様です。
アスタリスクの付いた変数は空配列 &lt;code>[]&lt;/code> になることはありますが、&lt;code>nil&lt;/code> になることはありません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span> &lt;span class="c1"># a=100, b=[200], c=300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="c1"># a=100, b=[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">*&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="c1"># a=[], b=100&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="右辺値に配列を指定した場合">右辺値に配列を指定した場合&lt;/h2>
&lt;p>右辺値として配列を 1 つだけ指定した場合は、配列要素が展開されてから代入処理が実行されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="c1"># a=100, b=200, c=300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>右辺値が 2 つ以上あり、その中に配列が含まれる場合は、配列のまま代入されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">400&lt;/span> &lt;span class="c1"># a=100, b=[200,300], c=400&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>右辺値が 2 つ以上ある場合でも、配列のプレフィックスとしてアスタリスク &lt;code>*&lt;/code> を付けると、明示的にその配列要素を展開してから代入できます。&lt;/p></description></item><item><title>Rubyメモ: 文字列内のある文字を指定した文字に置換する (tr)</title><link>https://maku77.github.io/p/uuyzqx7/</link><pubDate>Sun, 01 Sep 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/uuyzqx7/</guid><description>&lt;p>下記の例では、文字列中で見つかった &lt;code>a&lt;/code> という文字を、すべて &lt;code>x&lt;/code> に置換した文字列を作成しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;abcabc&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;xbcxbc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>String#tr&lt;/code> メソッドでは、置換する文字を複数同時に指定することもできます。
下記のようにすると、&lt;code>a&lt;/code> を &lt;code>x&lt;/code> に、&lt;code>b&lt;/code> を &lt;code>y&lt;/code> に置換するという意味になります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="s1">&amp;#39;abcabc&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ab&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;xy&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># =&amp;gt; &amp;#34;xycxyc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>tr&lt;/code> メソッドは、置換後の文字列を戻り値として返します。
文字列変数の内容を書き換える場合は、&lt;code>tr&lt;/code> の代わりに &lt;code>tr!&lt;/code> を使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;abcabc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tr!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># 自分自身を書き換え&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="c1"># &amp;#39;xbcxbc&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: case による分岐</title><link>https://maku77.github.io/p/2qpgt7a/</link><pubDate>Thu, 22 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/2qpgt7a/</guid><description>&lt;h1 id="case-の構文">case の構文&lt;/h1>
&lt;p>C/C++ や Java の switch 文のような分岐を行いたい場合は、Ruby では &lt;code>case&lt;/code> を使用します。
Ruby の &lt;code>case&lt;/code> では、下記のように複数の値をカンマで指定することで、いずれかの値に一致した場合の処理を記述できます。&lt;/p>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: a の値により分岐&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">case&lt;/span> &lt;span class="n">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">when&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">when&lt;/span> &lt;span class="s1">&amp;#39;aaa&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;bbb&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Rubyメモ: 範囲指定によるループ (for, each, step)</title><link>https://maku77.github.io/p/wtng2tw/</link><pubDate>Thu, 22 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/wtng2tw/</guid><description/></item><item><title>Rubyメモ: 繰り返し処理 (while, until, times, for, each, step)</title><link>https://maku77.github.io/p/b4ra4pj/</link><pubDate>Thu, 22 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/b4ra4pj/</guid><description>&lt;h2 id="条件指定によるループ-while-と-until">条件指定によるループ (while と until)&lt;/h2>
&lt;h3 id="while-の構文">while の構文&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="err">条件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ループを途中で抜ける場合は、&lt;strong>&lt;code>break&lt;/code>&lt;/strong> を使用します。&lt;/p>
&lt;h3 id="until-の構文">until の構文&lt;/h3>
&lt;p>Ruby では、&lt;code>while not&lt;/code> の省略形として &lt;strong>&lt;code>until&lt;/code>&lt;/strong> が用意されています。
&lt;code>until&lt;/code> の場合は、&lt;strong>指定した条件が満たされるまで&lt;/strong> ループを実行します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">until&lt;/span> &lt;span class="err">条件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="範囲指定によるループ-times-for-each-step">範囲指定によるループ (times, for, each, step)&lt;/h2>
&lt;h3 id="指定した回数の繰り返し-times">指定した回数の繰り返し (times)&lt;/h3>
&lt;p>&lt;code>Integer&lt;/code> クラスの &lt;code>times&lt;/code> メソッドを使うと、指定した回数だけループ処理できます。
次のようにすると、変数 &lt;code>i&lt;/code> に 0、1、2 の順に値が格納されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 0 から 2 までのループ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="n">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>現在のインデックスが必要ない場合は、変数を省略できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 単純に 3 回繰り返す&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;こんにちは&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="for--in-の構文">for ~ in の構文&lt;/h3>
&lt;p>下記の例では、&lt;code>for ~ in&lt;/code> の構文に対して &lt;a href="http://ruby-doc.org/core-2.3.0/Range.html">Range オブジェクト&lt;/a>を渡すことで、指定した整数範囲のループ処理を行っています。
範囲指定時にドットの数を 3 つにすると、ループ回数が 1 回減ることに注意してください。
マイナス方向へのループ処理も行えます。&lt;/p></description></item><item><title>Rubyメモ: Ruby の真偽値</title><link>https://maku77.github.io/p/fe3ufno/</link><pubDate>Wed, 21 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/fe3ufno/</guid><description>&lt;p>Ruby では、「偽」として評価される値は &lt;code>false&lt;/code> と &lt;code>nil&lt;/code> のみです。
例えば、他の多くの言語とは異なり、&lt;code>0&lt;/code> も「真」と評価されるため注意が必要です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">puts&lt;/span> &lt;span class="s1">&amp;#39;0 は真&amp;#39;&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: if と unless による分岐</title><link>https://maku77.github.io/p/39asp6i/</link><pubDate>Tue, 20 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/39asp6i/</guid><description>&lt;h1 id="if-の構文">if の構文&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="err">条件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">elsif&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ruby の &lt;code>if&lt;/code> 文は式として評価できるため、次のように代入文と組み合わせて使用することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="n">str&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;みかん&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elsif&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;バナナ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;りんご&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の例では、&lt;code>x == 1&lt;/code> が成立するとき、&lt;code>str&lt;/code> 変数に &amp;ldquo;みかん&amp;rdquo; が代入されます。&lt;/p>
&lt;h1 id="unless-の構文">unless の構文&lt;/h1>
&lt;p>Ruby には、&lt;code>if not&lt;/code> の省略形として &lt;code>unless&lt;/code> が用意されています。
ただし、&lt;code>unless&lt;/code> の場合は、&lt;code>elsif&lt;/code> で条件をつなげていくことはできません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="k">unless&lt;/span> &lt;span class="err">条件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">文&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Rubyメモ: 条件指定によるループ (while と until)</title><link>https://maku77.github.io/p/z4ed3ax/</link><pubDate>Tue, 20 Aug 2002 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/z4ed3ax/</guid><description/></item></channel></rss>