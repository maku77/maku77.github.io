<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Gradle on 天才まくまくノート</title><link>https://maku77.github.io/gradle/</link><description>Recent content in Gradle on 天才まくまくノート</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><lastBuildDate>Tue, 26 Aug 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://maku77.github.io/gradle/index.xml" rel="self" type="application/rss+xml"/><item><title>Groovy でパスワードなどをユーザに入力させる (readPassword)</title><link>https://maku77.github.io/p/yxha7mn/</link><pubDate>Thu, 13 Oct 2016 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/yxha7mn/</guid><description>キーボードからのパスワード入力 Groovy を使用してユーザにパスワードを入力させるには、java.io.Console オブジェクトの readPassword メソッドを使用します。
sample.groovy def password = System.console().readPassword(&amp;#39;Password? &amp;#39;) println password 実行結果 $ groovy sample.groovy Password? （キーボードから abcabc と入力） abcabc</description></item><item><title>Groovy のクロージャ</title><link>https://maku77.github.io/p/b962btg/</link><pubDate>Thu, 13 Oct 2016 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/b962btg/</guid><description>クロージャの定義 Groovy におけるクロージャは、{ と } で囲まれた無名のコードブロックであり、通常のメソッドと同様にパラメータを受け取ったり、戻り値を返したりすることができます。 また、クロージャは変数への代入や、メソッドのパラメータとして渡すことが可能です。
下記は、渡されたパラメータを二乗するだけのクロージャの定義例です。 ここでは、定義したクロージャを square という名前の変数に代入し、後からメソッド呼び出しのように実行しています。
Closure square = { it * it } println square(3) 上記のように、クロージャに渡されるパラメータがひとつだけの場合は、デフォルトで it という名前で参照することができます（パラメータが渡されずに呼び出された場合、it の値は null になります）。 複数のパラメータを渡したい場合などは、下記のように定義します。
Closure add = { a, b -&amp;gt; a + b } println add(1, 2) クロージャの利用例 クロージャは、コレクションに格納された要素に対する処理を記述する際などに使用されます。 次の例では、リストオブジェクトの each メソッドに対してクロージャを渡しています。
list = [1, 2, 3] list.each() { println it * 2 } Groovy ベースのビルドツールである Gradle では、コンフィギュレーションブロックの記述でクロージャが活用されています。 下記は、Gradle ビルドスクリプトの抜粋です。
dependencies { compile project(&amp;#39;:mylib&amp;#39;) } まるで設定ファイルの独自構文のような記述ですが、Groovy の処理系から見れば、実は dependencies というメソッドにクロージャを 1 つ渡しているだけです。</description></item><item><title>Gradle によるビルドのボトルネックを探す（プロファイリング） (--profile)</title><link>https://maku77.github.io/p/ofoencn/</link><pubDate>Fri, 09 Sep 2016 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/ofoencn/</guid><description>gradle コマンドを実行するときに、--profile オプションを追加して実行すると、ビルド中の各処理でどの程度時間がかかっているかのプロファイリング結果を出力してくれます。 プロファイリング結果は、build/reports/profile ディレクトリ以下に次のような HTML ファイルとして出力されます。
図: build/reports/profile/profile-2016-09-09-11-44-54.html Gradle によるビルドがあまりにも遅いと感じたら、このプロファイリング機能を使ってボトルネックを探るとよいです。</description></item><item><title>Gradle デーモンを使って gradle コマンドを高速化する (org.gradle.daemon)</title><link>https://maku77.github.io/p/szhzejv/</link><pubDate>Fri, 10 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/szhzejv/</guid><description>Gradle デーモンの立ち上げ gradle コマンドを実行すると、デフォルトでは毎回 Java のバーチャルマシンを起動するため、下記のような簡単なタスクを実行するだけでも 2、3 秒の実行時間がかかってしまいます。
build.gradle task hello &amp;lt;&amp;lt; { println &amp;#39;Hello&amp;#39; } 実行結果 $ gradle hello :hello Hello BUILD SUCCESSFUL Total time: 2.353 secs gradle コマンドを実行するときに、--daemon オプションを付けるようにすると、Gradle のプロセスを常駐させ（デーモン化）、そのプロセスを毎回のビルドで使いまわすようになります。 初回はデーモンの立ち上げのために時間がかかりますが、2 度目からのビルドは高速に実行することができます。 下記の実行例を見ると、1 秒以内に処理できていることがわかります。
実行結果（--daemonオプションあり） $ gradle --daemon hello :hello Hello BUILD SUCCESSFUL Total time: 0.905 secs ちなみに、常駐している Gradle のプロセスは、3 時間使用されないと自動的に終了します。 下記のように明示的に停止することもできます。
$ gradle --stop Stopping daemon(s). Gradle daemon stopped. Gradle デーモンをデフォルトで有効にする gradle コマンドに毎回 --daemon オプションを付けるのが面倒な場合は、Gradle の設定ファイル (gradle.properties) でデーモンを常に有効にすることができます。</description></item><item><title>Groovy でクラスを定義する</title><link>https://maku77.github.io/p/j5bvcq9/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/j5bvcq9/</guid><description>クラスを定義する Groovy では、クラスやメソッドの可視性はデフォルトで public になります。 下記の Book クラスは title と authors フィールドを持っており、両方とも外部から参照できます。
sample.groovy class Book { def title def authors = [] def getLabel() { title + &amp;#39;, &amp;#39; + authors } String toString() { getLabel() } } def book = new Book() book.title = &amp;#39;Title1&amp;#39; book.authors &amp;lt;&amp;lt; &amp;#39;Author1&amp;#39; &amp;lt;&amp;lt; &amp;#39;Author2&amp;#39; &amp;lt;&amp;lt; &amp;#39;Author3&amp;#39; println book 実行例 $ groovy sample.groovy Title1, [Author1, Author2, Author3] 上記の例では、book.title というプロパティに直接アクセスしているかのように見えますが、内部的には、自動的に生成された book.getTitle() という getter メソッドが呼び出されています。 同様に、book.setTitle() という setter メソッドも自動的に生成されています。</description></item><item><title>Groovy でマップ (Map) を扱う</title><link>https://maku77.github.io/p/ohhdpvf/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/ohhdpvf/</guid><description>Groovy の Map の基本 Groovy の Map インスタンスは、List インスタンスと同様に [ と ] を使用して定義することができます。 ただし、各要素はコロン (:) で区切って、キーと値を指定します。 内部的には、java.util.LinkedHashMap インスタンスが生成されています。
def map = [xxx:100, yyy:200, zzz:300] assert map.getClass() == java.util.LinkedHashMap assert map.size() == 3 assert map.xxx == 100 assert map[&amp;#39;xxx&amp;#39;] == 100 Map の要素を列挙する Map の要素は、List の要素と同様に each メソッドを使ってイテレートすることができます。
map.each { key, val -&amp;gt; println key + &amp;#39;:&amp;#39; + val } 空の Map インスタンスを生成する 空の Map インスタンスを生成するときは、ちょっと特殊ですが下記のように記述する必要があります。
def map = [:] // 空の Map 真ん中のコロン : を省略してしまうと、List オブジェクトの生成とみなされてしまいます。</description></item><item><title>Groovy でメソッドを定義する</title><link>https://maku77.github.io/p/6qzzzry/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/6qzzzry/</guid><description>下記のサンプルでは、2 つの変数を足し合わせる add メソッドを定義しています。
sample.groovy // メソッドの定義 def add(a, b) { a + b } // メソッドの呼び出し def val = add(100, 200) println val Groovy では、他の多くのスクリプト言語と同様に、メソッド内で最後に評価された式の値がそのまま戻り値となるので、return キーワードを省略することができます。 また、パラメータの型や、戻り値の型も明示する必要はありません（最初に def とだけ書けばよい）。
次のように型を明示することもできます。
int add(int a, int b) { a + b } 戻り値がないことを明示したいのであれば、Java と同様に void と定義することもできます。 戻り値の型が void のメソッドの戻り値を強引に取得しようとすると、null が返されます。
void greet(String name) { println &amp;#39;Hello, &amp;#39; + name } def val = greet(&amp;#39;Jack&amp;#39;) println val //=&amp;gt; null メソッド呼び出し時のパラメータを囲む括弧は、次のように省略することができます。
def val = add 100, 200 ただし、パラメータを 1 つも持たない場合は、呼び出し時の括弧を省略することはできません。</description></item><item><title>Groovy でリスト (List) を扱う</title><link>https://maku77.github.io/p/z9qmfd4/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/z9qmfd4/</guid><description>Groovy のリストの基本 Groovy では、[1, 2, 3] といった構文を使用して、簡単に List インスタンスを生成することができます。 内部的には java.util.ArrayList のインスタンスが生成されます。 下記の例では、3 つの要素を持つ List インスタンスを生成しています。
def list = [100, &amp;#39;AAA&amp;#39;, 0.25] assert list.getClass() == java.util.ArrayList assert list.size() == 3 assert list[0] == 100 リストへの要素の追加 リストの末尾に要素を追加する場合、&amp;lt;&amp;lt; というショートカット記法を使用することができます。
def list = [] list &amp;lt;&amp;lt; 100 list &amp;lt;&amp;lt; 200 list &amp;lt;&amp;lt; 300 println list //=&amp;gt; [100, 200, 300] これは、下記のように add メソッドを呼び出すのと同等の動作をします。
def list = [] list.add 100 list.add 200 list.add 300 println list //=&amp;gt; [100, 200, 300] あまり違いはないように見えますが、&amp;lt;&amp;lt; を使った方が可読性は若干上がるようです。 また、&amp;lt;&amp;lt; を使うことにより、下記のように連続して要素を追加することが可能です。</description></item><item><title>Groovy で文字列リテラルを扱う</title><link>https://maku77.github.io/p/v8m6rme/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/v8m6rme/</guid><description>文字列リテラルと GStrings Groovy の文字列リテラルは、シングルクォート (') あるいは、ダブルクォート (&amp;quot;) で囲んで表現します。 ダブルクォートで囲んだ文字列リテラルは、$ で始まる変数が展開されます。 このような変数を含む文字列を GStrings (Groovy Strings) と呼びます。
sample.groovy def name = &amp;#39;Britney&amp;#39; println &amp;#39;Hello $name&amp;#39; println &amp;#34;Hello $name&amp;#34; 実行結果 Hello $name Hello Britney 文字列の中の式 ${式} という構文を使用すると、文字列の中で任意の式を実行することができます。
sample.groovy def name = &amp;#39;mickey&amp;#39; println &amp;#34;Hello ${name.capitalize()}&amp;#34; 実行結果 Hello Mickey ヒアドキュメント 3 連続のクォーテーションマーク（''' あるいは &amp;quot;&amp;quot;&amp;quot;）で文字列を囲むことによって、複数行にまたがる文字列リテラル（ヒアドキュメント）を定義することができます。 通常の文字列リテラルと同様に、ダブルクォート (&amp;quot;) で囲んだ場合だけ、$ で始まる変数が展開されます。
def html = &amp;#34;&amp;#34;&amp;#34;&amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;title&amp;gt;$title&amp;lt;/title&amp;gt; &amp;lt;head&amp;gt; &amp;lt;body&amp;gt; $body &amp;lt;/body&amp;gt; &amp;lt;/html&amp;gt;&amp;#34;&amp;#34;&amp;#34;</description></item><item><title>Groovy で assert を使用する</title><link>https://maku77.github.io/p/m9veity/</link><pubDate>Tue, 07 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/m9veity/</guid><description>Groovy では、デフォルトで assert が使用できるようになっています。
sample.groovy def num = 100 assert num.getClass() == java.lang.Integer def str = &amp;#39;Hello&amp;#39; assert str.getClass() == java.lang.Integer 上記のスクリプトを実行すると、2 つ目の assert で fail して、下記のように詳細な情報が表示されます。 分かりやすいですね！
$ groovy sample.groovy Assertion failed: assert str.getClass() == java.lang.Integer | | | | | false | class java.lang.String Hello at sample.run(sample.groovy:5)</description></item><item><title>Groovy と Java の違い</title><link>https://maku77.github.io/p/som2e4k/</link><pubDate>Tue, 07 Jul 2015 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/som2e4k/</guid><description>Groovy は Java と異なり、下記のような特徴を持っています。
行末のセミコロンは省略できる クラス、コンストラクタ、メソッドはデフォルトで public となる return の記述は省略できる（最後に評価された式が戻り値となる） getter/setter メソッドが自動的に作られる（obj.prop のようにアクセスすれば obj.getProp や setProp が呼び出される） == によるオブジェクトの比較は、自動的に equals による比較となる（しかも null チェックの必要はない） assert は常に有効（Java の場合は -ea or --enable-assertion オプションの指定が必要） 変数の型や、メソッドの戻り値の型は def としておけば、自動で判別してくれる コレクション（List や Map）の扱いがシンプルで Python や Ruby に近い構文で記述できる</description></item><item><title>Gradle のプロキシを設定する (gradle.properties)</title><link>https://maku77.github.io/p/5x6qgkx/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/5x6qgkx/</guid><description>gradle コマンド実行時に Maven リポジトリにアクセスしたり、Gradle Wrapper をインストールするためのアーカイブをダウンロードしたりする際にネットワークアクセスが発生します。 これらのアクセスをプロキシ経由で行う必要がある場合は、gradle.properties ファイルにプロキシの設定を記述します。
用途 設定ファイル プロジェクトごとの設定 &amp;lt;project&amp;gt;/gradle.properties ユーザごとの設定 (macOS/Linux) $HOME/.gradle/gradle.properties ユーザごとの設定 (Windows) %USERPROFILE%/.gradle/gradle.properties 以下のように設定します。
gradle.properties systemProp.http.proxyHost=&amp;lt;ホスト&amp;gt; systemProp.http.proxyPort=&amp;lt;ポート番号&amp;gt; systemProp.http.proxyUser=&amp;lt;ユーザ&amp;gt; systemProp.http.proxyPassword=&amp;lt;パスワード&amp;gt; systemProp.https.proxyHost=&amp;lt;ホスト&amp;gt; systemProp.https.proxyPort=&amp;lt;ポート番号&amp;gt; systemProp.https.proxyUser=&amp;lt;ユーザ&amp;gt; systemProp.https.proxyPassword=&amp;lt;パスワード&amp;gt; 設定例 systemProp.http.proxyHost=proxy.example.com systemProp.http.proxyPort=8080 systemProp.https.proxyHost=proxy.example.com systemProp.https.proxyPort=8080</description></item><item><title>Gradle をインストールする (macOS/Windows)</title><link>https://maku77.github.io/p/6qdfg4d/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/6qdfg4d/</guid><description>macOS への Gradle インストール ここでは、GVM (Groovy enVironment Manager) を使って gradle コマンドをインストールします。 GVM を使うと、複数バージョンの Gradle を管理することができます。
GVM のインストール
$ curl -s get.gvmtool.net | bash GVM で gradle のインストール
$ gvm install gradle 動作確認
$ gradle --version Windows への Gradle インストール https://gradle.org/install/ から gradle-1.12-bin.zip などをダウンロードして、適当なディレクトリに配置します。 gradle コマンドを実行するには、java コマンドを実行できるようになっている必要があります。 任意のバージョンの java コマンドを使用するには、JAVA_HOME 環境変数を設定しておきます。
C:\&amp;gt; set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_05 （binまでは含めないことに注意） gradle コマンドを任意のディレクトリから実行できるように、PATH を通しておきます。
C:\&amp;gt; set PATH=%PATH%;C:\app\gradle-1.12\bin 実行テスト C:\&amp;gt; gradle -v ------------------------------------------------------------ Gradle 1.12 ------------------------------------------------------------ Build time: 2014-04-29 09:24:31 UTC Build number: none Revision: a831fa866d46cbee94e61a09af15f9dd95987421 Groovy: 1.</description></item><item><title>Gradle をインストールする (macOS/Windows)</title><link>https://maku77.github.io/p/6qdfg4d/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0000</pubDate><guid>https://maku77.github.io/p/6qdfg4d/</guid><description>macOS への Gradle インストール ここでは、GVM (Groovy enVironment Manager) を使って gradle コマンドをインストールします。 GVM を使うと、複数バージョンの Gradle を管理することができます。
GVM のインストール
$ curl -s get.gvmtool.net | bash GVM で gradle のインストール
$ gvm install gradle 動作確認
$ gradle --version Windows への Gradle インストール https://www.gradle.org/downloads から gradle-1.12-bin.zip などをダウンロードして、適当なディレクトリに配置します。 gradle コマンドを実行するには、java コマンドを実行できるようになっている必要があります。 任意のバージョンの java コマンドを使用するには、JAVA_HOME 環境変数を設定しておきます。
C:\&amp;gt; set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_05 （binまでは含めないことに注意） gradle コマンドを任意のディレクトリから実行できるように、PATH を通しておきます。
C:\&amp;gt; set PATH=%PATH%;C:\app\gradle-1.12\bin 実行テスト C:\&amp;gt; gradle -v ------------------------------------------------------------ Gradle 1.12 ------------------------------------------------------------ Build time: 2014-04-29 09:24:31 UTC Build number: none Revision: a831fa866d46cbee94e61a09af15f9dd95987421 Groovy: 1.</description></item></channel></rss>