<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Gradle on 天才まくまくノート</title><link>https://maku77.github.io/gradle/</link><description>Recent content in Gradle on 天才まくまくノート</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Wed, 03 Feb 2021 00:00:00 +0900</lastBuildDate><atom:link href="https://maku77.github.io/gradle/index.xml" rel="self" type="application/rss+xml"/><item><title>Gradle Wrapper スクリプト (gradlew) をサブプロジェクトから簡単に呼び出せるようにする</title><link>https://maku77.github.io/p/je3xamc/</link><pubDate>Mon, 07 Aug 2017 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/je3xamc/</guid><description>&lt;h2 id="gradle-wrapper-wrapper-gradleww-とは">Gradle Wrapper Wrapper (gradleww) とは&lt;/h2>
&lt;p>&lt;a href="https://github.com/maku77/gradleww">Gradle Wrapper Wrapper (gradleww)&lt;/a> を使用すると、サブプロジェクト（サブディレクトリ）で作業しているときに、プロジェクトのルートにおいてある &lt;code>gradlew&lt;/code> を簡単に呼び出すことができるようになります。&lt;/p>
&lt;p>例えば、通常はサブプロジェクトで作業しているときは、&lt;code>gradlew&lt;/code> コマンドを実行するときにこんな感じで実行することになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ../../gradlew assembleDebug
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>gradlew&lt;/code> の代わりに &lt;strong>&lt;code>gradleww&lt;/code>&lt;/strong> コマンドを実行するようにすれば、次のように簡単に呼び出すことができます（内部で自動的に上位ディレクトリの &lt;code>gradlew&lt;/code> を実行してくれます）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradleww assembleDebug
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Gradle Wrapper (gradlew) をさらにラップしたコマンドのため、Gradle Wrapper Wrapper (gradleww) と呼んでいます。&lt;/p>
&lt;h2 id="gradlew-wrapper-wrapper-gradleww-のインストール">Gradlew Wrapper Wrapper (gradleww) のインストール&lt;/h2>
&lt;p>Gradle Wrapper Wrapper（&lt;code>gradleww&lt;/code> コマンド）は、RubyGems パッケージとして配布されているため、Ruby 環境がインストールされていれば、下記のように簡単にインストールすることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gem install gradleww
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Gradle のプロパティを環境変数 (ORG_GRADLE_PROJECT) で定義する</title><link>https://maku77.github.io/p/2uxzo7h/</link><pubDate>Thu, 13 Oct 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/2uxzo7h/</guid><description>&lt;h2 id="環境変数で-gradle-プロジェクトのプロパティを設定する">環境変数で Gradle プロジェクトのプロパティを設定する&lt;/h2>
&lt;p>OS の環境変数として &lt;strong>&lt;code>ORG_GRADLE_PROJECT_&lt;/code>&lt;/strong> というプレフィックスで始まる変数を定義しておくと、Gradle のビルドスクリプト内から、プロジェクトのプロパティとして参照できるようになります。
ユーザごとに異なる値（ユーザ ID やパスワード）を設定したいときに便利です。
下記の例では、Maven サーバ用のアクセス情報を示すプロパティ（&lt;code>MAVEN_USERNAME&lt;/code> など）を設定しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">~/.bash_profile&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">ORG_GRADLE_PROJECT_MAVEN_URL&lt;/span>&lt;span class="o">=&lt;/span>http://repo.mycompany.com/maven2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">ORG_GRADLE_PROJECT_MAVEN_USERNAME&lt;/span>&lt;span class="o">=&lt;/span>xxx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">ORG_GRADLE_PROJECT_MAVEN_PASSWORD&lt;/span>&lt;span class="o">=&lt;/span>yyy&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>あとは、下記のようにビルドスクリプトの中から簡単に参照することができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">maven&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">credentials&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">username&lt;/span> &lt;span class="n">MAVEN_USERNAME&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">password&lt;/span> &lt;span class="n">MAVEN_PASSWORD&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span> &lt;span class="n">MAVEN_URL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="プロパティが設定されているかどうか確認する">プロパティが設定されているかどうか確認する&lt;/h2>
&lt;p>定義されていないプロパティを参照しようとするとエラーが発生します。
プロジェクトのプロパティが定義されているかどうかを調べるには、以下のように &lt;code>project.has&lt;/code> メソッドを使用します（&lt;code>project.&lt;/code> は省略可能です）。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">(!&lt;/span>&lt;span class="n">project&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">has&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;MAVEN_USERNAME&amp;#39;&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;ORG_GRADLE_PROJECT_MAVEN_USERNAME is not set&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>環境変数 &lt;code>ORG_GRADLE_PROJECT_xxx&lt;/code> で定義された値も、プロジェクトのプロパティとして参照できるようになるため、上記のようにして定義されているかどうかを確認することができます。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/build_environment.html#sec:gradle_properties_and_system_properties">ORG_GRADLE_PROJECT プレフィックスの環境変数について (The Build Environment - Gradle User Guide)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/dependency_management.html#sec:accessing_password_protected_maven_repositories">Maven リポジトリの Credential 設定 (Dependency Management - Gradle User Guide)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Groovy でパスワードなどをユーザに入力させる (readPassword)</title><link>https://maku77.github.io/p/yxha7mn/</link><pubDate>Thu, 13 Oct 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/yxha7mn/</guid><description>&lt;h2 id="キーボードからのパスワード入力">キーボードからのパスワード入力&lt;/h2>
&lt;p>Groovy を使用してユーザにパスワードを入力させるには、&lt;strong>&lt;code>java.io.Console&lt;/code>&lt;/strong> オブジェクトの &lt;strong>&lt;code>readPassword&lt;/code>&lt;/strong> メソッドを使用します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">System&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">console&lt;/span>&lt;span class="o">().&lt;/span>&lt;span class="na">readPassword&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Password? &amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">password&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> groovy sample.groovy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Password? （キーボードから abcabc と入力）
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">abcabc
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Groovy のクロージャ</title><link>https://maku77.github.io/p/b962btg/</link><pubDate>Thu, 13 Oct 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/b962btg/</guid><description>&lt;h2 id="クロージャの定義">クロージャの定義&lt;/h2>
&lt;p>Groovy におけるクロージャは、&lt;strong>&lt;code>{&lt;/code>&lt;/strong> と &lt;strong>&lt;code>}&lt;/code>&lt;/strong> で囲まれた無名のコードブロックであり、通常のメソッドと同様にパラメータを受け取ったり、戻り値を返したりすることができます。
また、クロージャは変数への代入や、メソッドのパラメータとして渡すことが可能です。&lt;/p>
&lt;p>下記は、渡されたパラメータを二乗するだけのクロージャの定義例です。
ここでは、定義したクロージャを &lt;code>square&lt;/code> という名前の変数に代入し、後からメソッド呼び出しのように実行しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Closure&lt;/span> &lt;span class="n">square&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">it&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">it&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="nf">square&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のように、クロージャに渡されるパラメータがひとつだけの場合は、デフォルトで &lt;code>it&lt;/code> という名前で参照することができます（パラメータが渡されずに呼び出された場合、&lt;code>it&lt;/code> の値は &lt;code>null&lt;/code> になります）。
複数のパラメータを渡したい場合などは、下記のように定義します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Closure&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">b&lt;/span> &lt;span class="o">-&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="クロージャの利用例">クロージャの利用例&lt;/h2>
&lt;p>クロージャは、コレクションに格納された要素に対する処理を記述する際などに使用されます。
次の例では、リストオブジェクトの &lt;code>each&lt;/code> メソッドに対してクロージャを渡しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">each&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="n">it&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Groovy ベースのビルドツールである Gradle では、コンフィギュレーションブロックの記述でクロージャが活用されています。
下記は、Gradle ビルドスクリプトの抜粋です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">compile&lt;/span> &lt;span class="nf">project&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;:mylib&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>まるで設定ファイルの独自構文のような記述ですが、Groovy の処理系から見れば、実は &lt;code>dependencies&lt;/code> というメソッドにクロージャを 1 つ渡しているだけです。&lt;/p></description></item><item><title>Gradle でディレクトリ内のファイルを ZIP 圧縮する (type: Zip)</title><link>https://maku77.github.io/p/p6bu2pa/</link><pubDate>Fri, 09 Sep 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/p6bu2pa/</guid><description>&lt;p>Gradle でディレクトリ内のファイルを ZIP 圧縮するには、次のように &lt;strong>&lt;code>Zip&lt;/code>&lt;/strong> 型のタスクを定義します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">createArchive&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Zip&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;docs/&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">archiveName&lt;/span> &lt;span class="s1">&amp;#39;docs.zip&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>このように定義した &lt;code>createArchive&lt;/code> タスクを実行すると、&lt;code>docs&lt;/code> ディレクトリ内のファイルをまとめた &lt;code>docs.zip&lt;/code> アーカイブファイルを作成できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradlew createArchive
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Gradle によるビルドのボトルネックを探す（プロファイリング） (--profile)</title><link>https://maku77.github.io/p/ofoencn/</link><pubDate>Fri, 09 Sep 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ofoencn/</guid><description>&lt;p>&lt;code>gradle&lt;/code> コマンドを実行するときに、&lt;strong>&lt;code>--profile&lt;/code>&lt;/strong> オプションを追加して実行すると、ビルド中の各処理でどの程度時間がかかっているかのプロファイリング結果を出力してくれます。
プロファイリング結果は、&lt;strong>&lt;code>build/reports/profile&lt;/code>&lt;/strong> ディレクトリ以下に次のような HTML ファイルとして出力されます。&lt;/p>


&lt;figure class="xImage">
 &lt;img style="" width="700" height="486" src="../p/ofoencn/img-001.png" alt="/p/ofoencn/img-001.png" />
 &lt;figcaption>図: build/reports/profile/profile-2016-09-09-11-44-54.html&lt;/figcaption>
&lt;/figure>

&lt;p>Gradle によるビルドがあまりにも遅いと感じたら、このプロファイリング機能を使ってボトルネックを探るとよいです。&lt;/p></description></item><item><title>Gradle プラグインを作成する (2) JAR へのパッケージング</title><link>https://maku77.github.io/p/dyas9zg/</link><pubDate>Fri, 19 Aug 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/dyas9zg/</guid><description>&lt;h2 id="配布可能な-gradle-プラグインを作成する">配布可能な Gradle プラグインを作成する&lt;/h2>
&lt;p>&lt;a href="../p/negnqwf/">Gradle の独自プラグインを作成&lt;/a>したら、最終的に JAR ファイルにパッケージングすることで、他のプロジェクトにも配布できるようになります。&lt;/p>
&lt;p>配布用の Gradle プラグインをビルドするときにも Gradle を利用することができます。
プラグイン作成用のプロジェクトのディレクトリ構成は下記のような感じになります。
ここでは、&lt;strong>&lt;code>com.mycompany.greeting&lt;/code>&lt;/strong> という ID のプラグインを作成することとします（作成したプラグインは、&lt;code>apply plugin: 'com.mycompany.greeting'&lt;/code> という形で適用できるようになります）。&lt;/p>
&lt;pre tabindex="0">&lt;code>GreetingPlugin
 +-- build.gradle
 +-- src/main/
 +-- groovy/com/mycompany/greeting/GreetingPlugin.groovy
 +-- resources/META-INF/gradle-plugins/com.mycompany.greeting.properties
&lt;/code>&lt;/pre>&lt;p>実装に使用する言語は Java でも構わないのですが、ここでは Groovy を使用しています。
ここからは、それぞれのファイルの内容を見ていきます。&lt;/p>
&lt;h3 id="ビルドスクリプト-buildgradle">ビルドスクリプト (build.gradle)&lt;/h3>
&lt;p>ビルドスクリプトでは、プラグインの実装で Gradle パッケージを参照するための設定と、実装言語として Groovy を使用するための設定を行います。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;groovy&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">compile&lt;/span> &lt;span class="nf">gradleApi&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// org.gradle パッケージを使用するため
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">compile&lt;/span> &lt;span class="nf">localGroovy&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// Groovy SDK を使用するため
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h3 id="プラグイン本体-greetingplugingroovy">プラグイン本体 (GreetingPlugin.groovy)&lt;/h3>
&lt;p>この Groovy スクリプトで、Gradle プラグイン本体の実装を行います。
&lt;code>Plugin&lt;/code> インタフェースを実装することで、このプラグインが適用されたときに実行される処理を定義します（ここでは、適用先のプロジェクトに &lt;code>hello&lt;/code> タスクを追加しています）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">src/main/groovy/com/mycompany/greeting/GreetingPlugin.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="n">com&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">mycompany&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">greeting&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">org.gradle.api.Plugin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">org.gradle.api.Project&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">GreetingPlugin&lt;/span> &lt;span class="kd">implements&lt;/span> &lt;span class="n">Plugin&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Project&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">apply&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Project&lt;/span> &lt;span class="n">project&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;GreetingPlugin has been applied!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">project&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">task&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;hello&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello GreetingPlugin!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h3 id="プロパティファイル-commycompanygreetingproperties">プロパティファイル (com.mycompany.greeting.properties)&lt;/h3>
&lt;p>このプロパティファイルには、Plugin インタフェースを実装したクラスの名前を指定しておきます。
プロパティファイルの名前は、プラグイン ID に合わせて付ける必要があります。&lt;/p></description></item><item><title>Gradle プラグインを作成する (1) Plugin クラスの基本</title><link>https://maku77.github.io/p/negnqwf/</link><pubDate>Tue, 16 Aug 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/negnqwf/</guid><description>&lt;h2 id="gradle-プラグイン作成の初歩">Gradle プラグイン作成の初歩&lt;/h2>
&lt;p>独自の Gradle プラグインを作成すると、下記のように各プロジェクトでプラグインを適用するだけで、そのプラグインが提供しているタスクを使えるようになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="n">MyPlugin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>プラグインの実体は &lt;code>org.gradle.api.Plugin&lt;/code> インタフェースを実装したクラスです。
上記のようにプラグインを適用すると、&lt;strong>&lt;code>Plugin#apply()&lt;/code>&lt;/strong> メソッドが呼び出されるため、例えば、その中でタスクを動的に追加するといった実装を行います。&lt;/p>
&lt;p>下記の例では、&lt;code>MyPlugin&lt;/code> というプラグイン実装を行っており、プラグインを適用したプロジェクトに対して動的に &lt;code>hello&lt;/code> というタスクを追加しています。
単純化のためにプラグインの実装と、それ使用するコード (&lt;code>apply plugin: MyPlugin&lt;/code>) を同じビルドスクリプト内に記述しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 独自プラグインの適用
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="n">MyPlugin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 独自プラグイン MyPlugin の実装
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">MyPlugin&lt;/span> &lt;span class="kd">implements&lt;/span> &lt;span class="n">Plugin&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">Project&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// プラグインを適用した時に呼び出される
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">void&lt;/span> &lt;span class="nf">apply&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">Project&lt;/span> &lt;span class="n">project&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;MyPlugin has been applied!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// プラグインを適用したプロジェクトに hello タスクを追加
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">project&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">task&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;hello&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello MyPlugin!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>プラグインによって自動的に追加された &lt;code>hello&lt;/code> タスクを実行してみます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">MyPlugin has been applied!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello MyPlugin!
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="gradle-プラグインの実装を別ディレクトリで行う-buildsrc">Gradle プラグインの実装を別ディレクトリで行う (buildSrc)&lt;/h2>
&lt;p>Gradle には、&lt;strong>&lt;code>buildSrc&lt;/code>&lt;/strong> というディレクトリ以下に配置されたソースコード（から生成されたクラス）に対して、自動的にクラスパスを通してくれるという機能があります。
これを利用して、プラグインの実装クラスを &lt;strong>&lt;code>buildSrc&lt;/code>&lt;/strong> に配置すれば、プロジェクトのメインとなるビルドスクリプトと、プラグインのコードを分けて配置することができます。&lt;/p></description></item><item><title>Gradle で独自の Maven リポジトリを使用する</title><link>https://maku77.github.io/p/tmkh8p6/</link><pubDate>Wed, 03 Aug 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/tmkh8p6/</guid><description>&lt;h2 id="maven-リポジトリの指定方法の基本">Maven リポジトリの指定方法の基本&lt;/h2>
&lt;p>Gradle はライブラリの依存関係などを処理するために、インターネット上の Maven リポジトリである JCenter や Maven Central などを簡単に利用できるようになっています。
どのリポジトリを使用するかは &lt;strong>&lt;code>repositories&lt;/code>&lt;/strong> ブロックで下記のように指定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">jcenter&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// Maven リポジトリとして JCenter を使用する
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// Maven リポジトリとして Maven Central を使用する
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ローカルリポジトリを指定する">ローカルリポジトリを指定する&lt;/h2>
&lt;p>ローカルディレクトリに Maven リポジトリを作成して、ビルド時にそこからライブラリを引っ張ってくるようにすることもできます。
ローカルの Maven リポジトリを参照するためには、&lt;code>repository&lt;/code> ブロックで &lt;strong>&lt;code>mavenLocal()&lt;/code>&lt;/strong> を実行します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">jcenter&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// Maven リポジトリとして JCenter を使用する
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">mavenLocal&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// Maven リポジトリとしてローカルディレクトリを使用する
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>デフォルトでは、下記のディレクトリがローカルの Maven リポジトリとして参照されます。&lt;/p>
&lt;ul>
&lt;li>Linux/MacOSX の場合: &lt;strong>&lt;code>$HOME/.m2&lt;/code>&lt;/strong>&lt;/li>
&lt;li>Windows の場合: &lt;strong>&lt;code>%UserProfile%\.m2&lt;/code>&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>リポジトリとするディレクトリを変更したい場合は、下記のように設定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">maven&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span> &lt;span class="s1">&amp;#39;../maven_repo&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="リモートリポジトリを指定する">リモートリポジトリを指定する&lt;/h2>
&lt;p>独自で立ち上げた Maven サーバを利用するように設定することもできます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">maven&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">url&lt;/span> &lt;span class="s1">&amp;#39;http://example.com/repo&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">credentials&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">username&lt;/span> &lt;span class="s1">&amp;#39;yourname&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">password&lt;/span> &lt;span class="s1">&amp;#39;sd$49aYd&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>Maven サーバにアクセスするためのユーザ名やパスワードは、上記のように &lt;strong>&lt;code>credentials&lt;/code>&lt;/strong> で設定できますが、ビルドスクリプト内にパスワードを記述するのは避けたほうがよいでしょう。
例えば、別ファイル（&lt;code>gradle.properties&lt;/code> など）に定義しておき、ビルドスクリプトから参照するようにします。&lt;/p></description></item><item><title>Gradle のプロジェクトとタスクとアクションを理解する</title><link>https://maku77.github.io/p/yqpxbpa/</link><pubDate>Fri, 29 Jul 2016 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/yqpxbpa/</guid><description>&lt;p>Gradle によるビルドは、少なくとも 1 つ以上の &lt;strong>「プロジェクト」&lt;/strong> から構成されます。
プロジェクトは 1 つ以上の &lt;strong>「タスク」&lt;/strong> を含み、タスク単位でビルド処理を実行できるようになっています。
各プロジェクトには &lt;code>build.gradle&lt;/code> というビルドスクリプトを配置し、その中でタスクを定義していきます。&lt;/p>
&lt;pre tabindex="0">&lt;code>ビルド構成
 +-- Project (build.gradle)
 | +-- Task
 | | +-- Action
 | | +-- Action
 | +-- Task
 | +-- Action
 | +-- Action
 +-- Project (build.gradle)
 +-- Project (build.gradle)
 +-- ...
&lt;/code>&lt;/pre>&lt;p>Gradle にはプラグインの仕組みがあり、複数のプロジェクトで再利用可能なタスクをプラグインの形で配布することができるようになっています。
インターネット上で公開されているプラグインを利用すれば、自分のプロジェクトに便利なタスクを簡単に組み込んでいくことができます（静的解析用のタスクや、デプロイ用のタスクなどを簡単に追加できる）。
タスク間に依存関係 (Dependency) を設定しておくことで、あるタスクを実行する前に先行して実行しなければいけないタスクを自動的に実行するように制御できます。&lt;/p>
&lt;p>各タスクは、実行ブロックの単位である &lt;strong>「アクション」&lt;/strong> を 1 つ以上含んでいます。
タスクを実行すると、それらのアクションが順番に実行されていくことになります。&lt;/p>
&lt;p>プロジェクト、タスク、アクションは、Gradle の処理系内部では、それぞれ &lt;code>Project&lt;/code> オブジェクト、&lt;code>Task&lt;/code> オブジェクト、&lt;code>Action&lt;/code> オブジェクトとしてインスタンス化されます。
ビルドスクリプトを記述していく上で、このようなオブジェクトが作成されていることを意識することが必要になってきます。&lt;/p></description></item><item><title>Gradle でプロパティファイル (.properties) を読み込む</title><link>https://maku77.github.io/p/quhymp7/</link><pubDate>Thu, 12 Nov 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/quhymp7/</guid><description>&lt;h2 id="独自のプロパティファイルを参照する">独自のプロパティファイルを参照する&lt;/h2>
&lt;p>Gradle ビルドスクリプトで &lt;strong>&lt;code>Properties&lt;/code>&lt;/strong> クラスを利用すると、任意の &lt;code>.properties&lt;/code> ファイルを簡単に読み込むことができます。
例えば、次のような &lt;code>sample.properties&lt;/code> をプロジェクトのルートディレクトに置いて、これを読み込んでみます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.properties&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-properties" data-lang="properties">&lt;span class="line">&lt;span class="cl">&lt;span class="na">key1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">value1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">key2&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">value2&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>下記ビルドスクリプトの &lt;code>loadProperties&lt;/code> メソッドでは、指定した &lt;code>.properties&lt;/code> ファイルを読み込んでオブジェクトとして返しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Reads properties from the specified .properties file.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="nf">loadProperties&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">props&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Properties&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="o">).&lt;/span>&lt;span class="na">withInputStream&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">props&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">load&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">it&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">props&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">props&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">loadProperties&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;$rootDir/sample.properties&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;props.key1 = ${props.key1}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;props.key2 = ${props.key2}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">props.key1 = value1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">props.key2 = value2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>読み込んだプロパティ設定を、プロジェクト全体から参照できるようにしたいときは、次のようにプロジェクトの &lt;strong>&lt;code>ext&lt;/code>&lt;/strong> プロパティに設定してしまえば OK です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="nf">loadProperties&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">props&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Properties&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="o">).&lt;/span>&lt;span class="na">withInputStream&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">props&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">load&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">it&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ext&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">props&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">props&lt;/span> &lt;span class="c1">// ★プロジェクト全体から見えるようにする
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">loadProperties&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;$rootDir/sample.properties&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;props.key1 = ${props.key1}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;props.key2 = ${props.key2}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="gradleproperties-を参照する">gradle.properties を参照する&lt;/h2>
&lt;p>プロジェクトのディレクトリに配置した &lt;strong>&lt;code>gradle.properties&lt;/code>&lt;/strong> に記述した設定内容は、自動的に &lt;code>project&lt;/code> オブジェクトのプロパティとして参照できるようになります。&lt;/p></description></item><item><title>Gradle で JUnit のカバレッジレポートを生成する (JaCoCo)</title><link>https://maku77.github.io/p/tesecus/</link><pubDate>Fri, 25 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/tesecus/</guid><description>&lt;p>JaCoCo Plugin を使用すると、JUnit などによるユニットテスト結果のカバレッジレポートを生成することができます。
カバレッジレポートは、そのままブラウザで見ることのできる HTML 形式や、Jenkins などの CI サーバで扱う exec データなどの形式で出力できます。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/jacoco_plugin.html">Gradle JaCoCo Plugin&lt;/a>&lt;/li>
&lt;/ul>


&lt;figure class="xImage">
 &lt;img style="border: solid #ccc 2px;" width="800" height="127" src="../p/tesecus/img-001_hu3540545609675257526.png" alt="/p/tesecus/img-001.png" />
 &lt;figcaption>図: HTML 形式の JaCoCo カバレッジレポートの例&lt;/figcaption>
&lt;/figure>

&lt;p>下記は &lt;code>jacoco&lt;/code> というタスクを定義する例です。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;jacoco&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">testCompile&lt;/span> &lt;span class="s1">&amp;#39;junit:junit:4.+&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jacoco&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">toolVersion&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;0.7.+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// reportsDir = file(&amp;#34;$buildDir/reports/jacoco&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">jacoco&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">JacocoReport&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">dependsOn:&lt;/span> &lt;span class="s1">&amp;#39;test&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sourceSets&lt;/span> &lt;span class="n">sourceSets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">executionData&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">files&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">tasks&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">jacocoTestReport&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">executionData&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reports&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">html&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">enabled&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">xml&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">enabled&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">csv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">enabled&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>カバレッジレポートを生成するには、ユニットテストの結果が必要なので、&lt;code>jacoco&lt;/code> タスクは &lt;code>test&lt;/code> タスクに依存するように定義しています。
テストカバレッジを生成するには、下記のように実行します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle jacoco
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:compileJava
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:processResources UP-TO-DATE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:classes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:compileTestJava
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:processTestResources UP-TO-DATE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:testClasses
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:test
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:jacoco
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">BUILD SUCCESSFUL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Total time: 8.697 secs
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>タスクの実行に成功すると、下記のようなファイルが生成されます。&lt;/p></description></item><item><title>Gradle で JUnit によるユニットテストを実行する</title><link>https://maku77.github.io/p/x6f9r2o/</link><pubDate>Thu, 24 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/x6f9r2o/</guid><description>&lt;h2 id="junit-の設定とテストコードの作成">JUnit の設定とテストコードの作成&lt;/h2>
&lt;p>Java プロジェクトにおいて JUnit を使ったユニットテストコードを記述するには、&lt;code>build.gradle&lt;/code> スクリプトに下記のように JUnit 用の設定を行っておきます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">testCompile&lt;/span> &lt;span class="s1">&amp;#39;junit:junit:4.+&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>テスト対象のプロダクトコードとそのテストコードは、下記のようなディレクトリ構成で配置します。&lt;/p>
&lt;ul>
&lt;li>&lt;code>src/main/java/com/example/Sample.java&lt;/code> &amp;hellip; プロダクトコード&lt;/li>
&lt;li>&lt;code>src/test/java/com/example/SampleTest.java&lt;/code> &amp;hellip; テストコード&lt;/li>
&lt;/ul>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">Sample.java（実装例）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">com.example&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">Sample&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">SampleTest.java（実装例）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">com.example&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kn">import&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">org.junit.Test&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kn">import static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">org.junit.Assert.*&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">SampleTest&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nd">@Test&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">testAdd&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">assertEquals&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Sample&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">2&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>ちなみに、JUnit 4.x 系では上記のようにアノテーションを使って記述しますが、JUnit 3.x までは下記のように &lt;code>TestCase&lt;/code> クラスを継承する形で記述していました。
後方互換性のため、JUnit 4.x を使っている場合でも、下記のように記述することができます。&lt;/p></description></item><item><title>Gradle でユニットテストの結果をコンソールに詳しく表示する</title><link>https://maku77.github.io/p/8ot95rq/</link><pubDate>Thu, 24 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/8ot95rq/</guid><description>&lt;p>Gradle でのユニットテストの実行結果が失敗の場合、デフォルトでは下記のようなそっけない表示しかしてくれません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle &lt;span class="nb">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">com.example.LargeTest &amp;gt; testAdd FAILED
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> java.lang.AssertionError at SampleTest.java:9
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">2 tests completed, 1 failed
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>build/reports/tests&lt;/code> 以下に生成されるテストレポートを見れば、その内容を確認できますが、コンソール上でもう少し詳しい結果を確認したい場合は、&lt;strong>&lt;code>-i&lt;/code>&lt;/strong> オプションを指定してログレベルを INFO に設定して &lt;code>test&lt;/code> タスクを実行します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle &lt;span class="nb">test&lt;/span> -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">com.example.SampleTest &amp;gt; testAdd FAILED
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> java.lang.AssertionError: expected:&amp;lt;4&amp;gt; but was:&amp;lt;3&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> at org.junit.Assert.fail(Assert.java:88)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> at org.junit.Assert.failNotEquals(Assert.java:834)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> at org.junit.Assert.assertEquals(Assert.java:645)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> at org.junit.Assert.assertEquals(Assert.java:631)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> at com.example.SampleTest.testAdd(SampleTest.java:9)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">1 test completed, 1 failed
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ただし、INFO レベルでログを出力すると、余計な出力が多く出てしまって見づらくなります。
&lt;code>build.gradle&lt;/code> スクリプトの中で、下記のように &lt;strong>&lt;code>exceptionFormat&lt;/code>&lt;/strong> を指定しておくと、上記のような例外部分だけを詳しく表示してくれるようになります（この場合 &lt;code>-i&lt;/code> オプションを付けて &lt;code>test&lt;/code> タスクを実行する必要はありません）。&lt;/p></description></item><item><title>Gradle でユニットテストを並列実行する (test.forkEvery, test.maxParallelForks)</title><link>https://maku77.github.io/p/pxkr6wv/</link><pubDate>Thu, 24 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/pxkr6wv/</guid><description>&lt;p>Gradle によるユニットテスト実行は、デフォルトではシーケンシャルに 1 つずつ行われていきます。
テストクラス数が多くなった場合は、並列実行することによって全体のテストにかかる時間を減らすことができます。&lt;/p>
&lt;p>&lt;strong>&lt;code>test.forkEvery&lt;/code>&lt;/strong> と &lt;strong>&lt;code>test.maxParallelForks&lt;/code>&lt;/strong> でテスト実行用のプロセスをどう fork するかを制御することができます。&lt;/p>
&lt;ul>
&lt;li>&lt;strong>&lt;code>test.forkEvery&lt;/code>&lt;/strong> &amp;hellip; 何個のクラスごとにテストプロセスを fork するか（どのくらい積極的に並列化するか）&lt;/li>
&lt;li>&lt;strong>&lt;code>test.maxParallelForks&lt;/code>&lt;/strong> &amp;hellip; 最大何個のテストプロセスを fork するか（最大並列実行数）&lt;/li>
&lt;/ul>
&lt;p>下記の例では、「CPU数−1」個まで同時実行することと、クラス 4 つごとにプロセスを fork することを指定しています。
例えば、クラスが 10 個あれば、3 つのプロセスが作成されます（1 つのプロセスで 4 クラスまで担当するから）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">test&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">cpus&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Runtime&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">runtime&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">availableProcessors&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">maxParallelForks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cpus&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="n">cpus&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">forkEvery&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>JUnit の代わりに TestNG を使ってユニットテストを実行する</title><link>https://maku77.github.io/p/84xtqff/</link><pubDate>Thu, 24 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/84xtqff/</guid><description>&lt;p>JUnit の代わりに &lt;strong>TestNG（テスティング）&lt;/strong> を使ってユニットテストを記述したい場合は、&lt;code>build.gradle&lt;/code> スクリプトを下記のように書き換えます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">testCompile&lt;/span> &lt;span class="s1">&amp;#39;org.testng:testng:6.+&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">useTestNG&lt;/span>&lt;span class="o">()&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>ディレクトリ構成や、&lt;code>test&lt;/code> タスクで実行できるところは JUnit を使う場合と変わりありません。
最後に &lt;strong>&lt;code>test.useTestNG()&lt;/code>&lt;/strong> の呼び出しが必要なことに注意してください。&lt;/p></description></item><item><title>Gradle で PMD による静的解析を実行する</title><link>https://maku77.github.io/p/pz9gz3h/</link><pubDate>Mon, 14 Sep 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/pz9gz3h/</guid><description>&lt;h2 id="pmd-プラグインの基本">PMD プラグインの基本&lt;/h2>
&lt;p>Gradle には標準の静的解析プラグインとして、PMD が組み込まれています。
PMD でソースコードを解析すると、潜在的な不具合や、複雑度が高く将来的に負債になりそうなコードを検出することができます。
よい設計やコーディングができているかが一目瞭然になりますので、すべての Java プロジェクトに採用したいところです。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/pmd_plugin.html">Gradle - PMD Plugin&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://pmd.github.io/">PMD&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>PMD と似たような静的解析ツールに FindBugs がありますが、FindBugs がコンパイル後のクラスコードに対する解析であるのに対し、PMD はコンパイル前のソースコードを解析します。
無駄なコードはコンパイルの段階で最適化されて削除されてしまうことがあるため、このような無駄なコードを発見するためには、PMD で解析することが必要になります。
また、本家の PMD はコードクローンの発見などの機能 (CPD: Copy/Paste Detector) も備えていますが、Gradle の PMD プラグインはまだ CPD の直接サポートはされていないようです (2015-09-14)。&lt;/p>
&lt;h2 id="pmd-の設定">PMD の設定&lt;/h2>
&lt;p>PMD による静的解析を実施するには、下記のような感じで &lt;strong>pmd&lt;/strong> プラグインを読み込んで設定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;pmd&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// PMD のコンフィギュレーション
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">pmd&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">toolVersion&lt;/span> &lt;span class="s1">&amp;#39;5.3.3&amp;#39;&lt;/span> &lt;span class="c1">// 使用する PMD のバージョン
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">ignoreFailures&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span> &lt;span class="c1">// PMD で警告が出てもビルドエラーにしない
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">consoleOutput&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span> &lt;span class="c1">// コンソールにも解析結果を出力
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">ruleSets&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="c1">// 適用する PMD ルール（プロジェクトごとに要調整）
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-basic&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// good practices which should be followed
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-braces&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// regarding the use and placement of braces
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-clone&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// questionable usages of the clone() method
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-codesize&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// problems related to code size or complexity
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-design&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// flag suboptimal code implementations
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-empty&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// empty statements of any kind
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-finalizers&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// problems that can occur with finalizers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-imports&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// problems that can occur with import statements
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-strictexception&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// strict guidelines about throwing and catching exceptions
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-strings&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// manipulation of the String, StringBuffer, or StringBuilder instances
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-sunsecure&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// check the security guidelines from Sun
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-typeresolution&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// rules which resolve java Class files for comparison
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-unnecessary&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="c1">// find useless or unnecessary code
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s1">&amp;#39;java-unusedcode&amp;#39;&lt;/span> &lt;span class="c1">// find unused or ineffective code
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>PMD プラグインによって、&lt;strong>pmdMain&lt;/strong> や &lt;strong>pmdTest&lt;/strong> などのタスクが定義されます。
これらのタスクは、&lt;strong>check&lt;/strong> タスクに依存するタスクとして定義されるので、&lt;strong>check&lt;/strong> タスクを定義する &lt;strong>java&lt;/strong> プラグインも読み込んでおく必要があります。&lt;/p></description></item><item><title>Gradle で Checkstyle による静的解析を実行する</title><link>https://maku77.github.io/p/em3rtg6/</link><pubDate>Mon, 10 Aug 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/em3rtg6/</guid><description>&lt;h2 id="checkstyle-プラグインの基本">Checkstyle プラグインの基本&lt;/h2>
&lt;p>Gradle には標準の静的解析プラグインとして、Checkstyle、PMD、CodeNarc、FindBugs、JDepend などが組み込まれています。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/checkstyle_plugin.html">Gradle - Checkstyle Plugin&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Checkstyle による静的解析を実施するには、下記のように &lt;strong>&lt;code>checkstyle&lt;/code>&lt;/strong> プラグインを読み込みます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;checkstyle&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">repositories&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mavenCentral&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">checkstyle&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">toolVersion&lt;/span> &lt;span class="s1">&amp;#39;6.7&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>checkstyle&lt;/code> プラグインを適用することによって、&lt;strong>&lt;code>checkstyleMain&lt;/code>&lt;/strong> や &lt;strong>&lt;code>checkstyleTest&lt;/code>&lt;/strong> などのタスクが定義されます。
これらのタスクは、&lt;strong>&lt;code>check&lt;/code>&lt;/strong> タスクに依存するタスクとして定義されるので、&lt;strong>&lt;code>check&lt;/code>&lt;/strong> タスクを定義する &lt;strong>&lt;code>java&lt;/code>&lt;/strong> プラグインも読み込んでおく必要があります。
また、Checkstyle はバージョンアップごとに微妙に互換性がなくなるので、上記のように &lt;code>checkstyle&lt;/code> コンフィギュレーションで、使用する Checkstyle のバージョンを指定しておくのがよいでしょう。&lt;/p>
&lt;p>Checkstyle プラグインは、デフォルトで Checkstyle の設定ファイルとして &lt;strong>&lt;code>${projectDir}/config/checkstyle/checkstyle.xml&lt;/code>&lt;/strong> を読み込むので、まずはここにプロジェクトで使用する Checkstyle の設定を置いておく必要があります。&lt;/p>
&lt;p>デフォルトの構成に従うと、こんな感じのディレクトリ構成になります。&lt;/p>
&lt;pre tabindex="0">&lt;code>+-- build.gradle
+-- config/
| +-- checkstyle/
| +-- checkstyle.xml （Checkstyle の設定ファイル）
+-- src/
 +-- main/
 +-- java/
 +-- com/
 +-- example/
 +-- Main.java （静的解析対象のソースコード）
&lt;/code>&lt;/pre>&lt;p>&lt;strong>&lt;code>checkstyleMain&lt;/code>&lt;/strong> あるいは &lt;strong>&lt;code>check&lt;/code>&lt;/strong> タスクを実行すると、Checkstyle による静的解析が実行されます。&lt;/p></description></item><item><title>Gradle のマルチプロジェクトで依存関係を扱う (dependencies, compile)</title><link>https://maku77.github.io/p/hg9n9wd/</link><pubDate>Tue, 04 Aug 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/hg9n9wd/</guid><description>&lt;p>マルチプロジェクトビルドにおいて、別のサブプロジェクトが生成するクラスへの依存があることを示したい場合は、&lt;strong>&lt;code>dependencies&lt;/code>&lt;/strong> ブロックで依存先のプロジェクトを指定します。
例えば、下記のように、2 つのサブプロジェクト (&lt;code>myapp&lt;/code> と &lt;code>mylib&lt;/code>) で構成されているとします。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">プロジェクト構成&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">root/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- build.gradle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- settings.gradle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- myapp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | +-- src/main/java/Main.java
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- mylib/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- src/main/java/MyLib.java&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">settings.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;myapp&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;mylib&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>プロジェクト &lt;code>myapp&lt;/code> は、プロジェクト &lt;code>mylib&lt;/code> が提供するクラスを参照して実装されています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">myapp/src/main/java/Main.java&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">Main&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">MyLib&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">100&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">200&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">mylib/src/main/java/MyLib.java&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">MyLib&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>このように Java のビルドにプロジェクト間の依存関係がある場合は、&lt;strong>&lt;code>dependencies&lt;/code>&lt;/strong> ブロック内の &lt;strong>&lt;code>compile&lt;/code>&lt;/strong> コンフィギュレーションに対して依存先のプロジェクトを指定します。&lt;/p></description></item><item><title>Gradle で Javadoc API ドキュメントを出力する</title><link>https://maku77.github.io/p/sj6sc4d/</link><pubDate>Mon, 03 Aug 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sj6sc4d/</guid><description>&lt;h2 id="javadoc-タスクを使えるようにする">javadoc タスクを使えるようにする&lt;/h2>
&lt;p>Gradle で &lt;code>java&lt;/code> プラグインをロードすると、自動的に &lt;strong>&lt;code>javadoc&lt;/code>&lt;/strong> タスクが定義されます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>下記のように実行すると、&lt;code>src/main/java&lt;/code> 以下の Java ソースコードに記述された Javadoc コメントを元に、&lt;strong>&lt;code>build/docs/javadocs&lt;/code>&lt;/strong> に API ドキュメントが生成されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle javadoc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="javadoc-タスクをカスタマイズする">javadoc タスクをカスタマイズする&lt;/h2>
&lt;p>&lt;code>javadoc&lt;/code> タスクをプロジェクトに合わせてカスタマイズしたい場合は、下記のように &lt;strong>&lt;code>Javadoc&lt;/code>&lt;/strong> 型の新しいタスクを定義します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">myJavadoc&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Javadoc&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">group&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Sample&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">description&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Generates API documents.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">source&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sourceSets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">main&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">allJava&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>タスク定義時に &lt;code>type: Javadoc&lt;/code> と指定することで、Configuration クロージャの中で参照されるオブジェクト（Closure delegate）が、&lt;code>Task&lt;/code> オブジェクトから &lt;code>Javadoc&lt;/code> オブジェクトに変わります。
Configuration クロージャ内で &lt;code>Javadoc&lt;/code> オブジェクトのメソッドを呼び出すことで、タスクをカスタマイズできるようになっています。
&lt;code>source&lt;/code> プロパティの指定は必須であることに注意してください（指定しないと何も生成されません）。&lt;/p>
&lt;p>Javadoc 用に新しいタスクを定義するのではなく、既存の &lt;code>javadoc&lt;/code> タスクを上書きしてしまいたい場合は、下記のように &lt;code>overwrite&lt;/code> オプションを指定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">javadoc&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Javadoc&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">overwrite:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">group&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Sample&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">description&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Generates API documents.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">source&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sourceSets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">main&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">allJava&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Javadoc&lt;/code> タスクオブジェクトに他にどのようなプロパティがあるかは、下記の DSL ドキュメントで確認できます。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/dsl/org.gradle.api.tasks.javadoc.Javadoc.html">Javadoc task&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Gradle によるマルチプロジェクトの基本 (settings.gradle)</title><link>https://maku77.github.io/p/3g9gimf/</link><pubDate>Mon, 27 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/3g9gimf/</guid><description>&lt;h2 id="マルチプロジェクトを構成する">マルチプロジェクトを構成する&lt;/h2>
&lt;p>Gradle では複数のサブプロジェクトを作成し、それらを連携させてビルドすることができます。
サブプロジェクトの構成は、&lt;strong>&lt;code>settings.gradle&lt;/code>&lt;/strong> ファイルで記述します。
例えば、下記の設定では、2 つのサブプロジェクト (&lt;code>subproject1&lt;/code>, &lt;code>subproject2&lt;/code>) から構成されることを示しています。
ここでサブプロジェクトを &lt;code>include&lt;/code> する順番は、タスクの実行順序には何も影響を与えません。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">settings.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rootProject&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;rootproject&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;subproject1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;subproject2&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>Gradle にデフォルトで用意されている &lt;strong>&lt;code>projects&lt;/code>&lt;/strong> タスクを実行することで、現在のプロジェクト構成を調べることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q projects
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Root project
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Root project &amp;#39;rootproject&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">+--- Project &amp;#39;:subproject1&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">\--- Project &amp;#39;:subproject2&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="サブプロジェクトごとに-buildgradle-を持つ構成">サブプロジェクトごとに build.gradle を持つ構成&lt;/h2>
&lt;p>&lt;code>settings.gradle&lt;/code> の &lt;strong>&lt;code>include&lt;/code>&lt;/strong> メソッドで指定したサブプロジェクト名は、サブプロジェクトを格納するディレクトリ名に対応しています。
サブプロジェクトの各ディレクトリには、そのプロジェクト用のビルドスクリプト (&lt;code>build.gradle&lt;/code>) を格納しておくことができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">マルチプロジェクトのディレクトリ構成&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">root/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- build.gradle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- settings.gradle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- subprojects1/
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> | +-- build.gradle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-- subprojects2/
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> +-- build.gradle&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle（ルート）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">subprojects1/build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>
&lt;/p></description></item><item><title>Gradle のタスクに説明を付け、グルーピングする</title><link>https://maku77.github.io/p/kgwpdtz/</link><pubDate>Mon, 13 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/kgwpdtz/</guid><description>&lt;p>Gradle のタスクを定義するときに &lt;strong>&lt;code>group&lt;/code>&lt;/strong> パラメータを指定すると、複数のタスクをグルーピングすることができます。
また、&lt;strong>&lt;code>description&lt;/code>&lt;/strong> パラメータを指定すると、タスクに説明文を設定することができます。
これらの設定を行うことで、&lt;strong>&lt;code>gradle tasks&lt;/code>&lt;/strong> でタスクを一覧表示したときに、グルーピングされたタスクと説明が表示されるようになります。&lt;/p>
&lt;p>下記の例では、&lt;code>hello1&lt;/code> タスクと &lt;code>hello2&lt;/code> タスクを &lt;code>MyGroup&lt;/code> にグルーピングし、それぞれのタスクに説明文を設定しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello1&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">group:&lt;/span> &lt;span class="s1">&amp;#39;MyGroup&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">description:&lt;/span> &lt;span class="s1">&amp;#39;Description for hello1.&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello2&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">group:&lt;/span> &lt;span class="s1">&amp;#39;MyGroup&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">description:&lt;/span> &lt;span class="s1">&amp;#39;Description for hello2.&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>タスクの Configuration クロージャ内で &lt;code>Task&lt;/code> オブジェクトのメソッド (&lt;code>group&lt;/code>, &lt;code>description&lt;/code>) を呼び出すことでも設定できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">group&lt;/span> &lt;span class="s1">&amp;#39;MyGroup&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">description&lt;/span> &lt;span class="s1">&amp;#39;Description for hello1.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello2&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">group&lt;/span> &lt;span class="s1">&amp;#39;MyGroup&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">description&lt;/span> &lt;span class="s1">&amp;#39;Description for hello2.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Gradle の &lt;code>tasks&lt;/code> タスクを実行することで、それぞれのタスクがグルーピングされて表示されることが分かります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q tasks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">MyGroup tasks
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">-------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">hello1 - Description for hello1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">hello2 - Description for hello2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>既存の Gradle タスクにアクションを追加する (doLast, doFirst)</title><link>https://maku77.github.io/p/6q9wkjm/</link><pubDate>Mon, 13 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6q9wkjm/</guid><description>&lt;p>Gradle の既存のタスクには、自由にアクションを追加していくことができます。
この仕組みにより、サードパーティ製のタスクに対して、前処理や後処理を追加することができます。
タスク内のアクションは、内部的にアクションリストとして保持されており、&lt;strong>&lt;code>Task#doLast&lt;/code>&lt;/strong> メソッドや &lt;strong>&lt;code>Task#doFirst&lt;/code>&lt;/strong> メソッドを使用して、先頭、あるいは末尾にアクションを追加できます。&lt;/p>
&lt;h2 id="アクションを末尾に追加する-dolast">アクションを末尾に追加する (doLast)&lt;/h2>
&lt;p>下記の例では、既存タスク &lt;code>hello&lt;/code> のアクションリストの末尾にアクションを追加しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// タスクの定義
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// アクションリストの末尾にアクションを追加
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Added to last 1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Added to last 2&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Added to last 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Added to last 2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="アクションを先頭に追加する-dofirst">アクションを先頭に追加する (doFirst)&lt;/h2>
&lt;p>下記の例では、既存タスクのアクションリストの先頭にアクションを追加しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// タスクの定義
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello!&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// アクションリストの先頭にアクションを追加
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">doFirst&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Added to first 1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hello&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">doFirst&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Added to first 2&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Added to first 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Added to first 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello!
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>doFirst&lt;/code> メソッドを呼び出すたびに、その時点でのアクションリストの先頭にアクションが追加されていくので、最後に追加したアクションが最初に実行されていることに注意してください。&lt;/p></description></item><item><title>Gradle Wrapper スクリプト (gradlew) を作成する</title><link>https://maku77.github.io/p/m7u5dgp/</link><pubDate>Fri, 10 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/m7u5dgp/</guid><description>&lt;h2 id="gradle-wrapper-とは">Gradle Wrapper とは&lt;/h2>
&lt;p>Gradle Wrapper スクリプト (&lt;strong>&lt;code>gradlew&lt;/code>&lt;/strong>) を作成しておくと、Gradle の実行環境をインストールしていない環境でも &lt;code>gradle&lt;/code> コマンドを実行するのと同様のビルドを行えるようになります。
Gradle Wrapper は、実際には下記のようなスクリプトファイルです。&lt;/p>
&lt;ul>
&lt;li>&lt;code>gradlew&lt;/code> &amp;hellip; Linux 用のシェルスクリプト&lt;/li>
&lt;li>&lt;code>gradlew.bat&lt;/code> &amp;hellip; Windows 用のバッチファイル&lt;/li>
&lt;/ul>
&lt;p>プロジェクトに &lt;code>gradlew&lt;/code> が用意されている場合は、&lt;code>gradle&lt;/code> コマンドの代わりにそちらを使えば OK です。例えば、&lt;code>build&lt;/code> タスクを実行したい場合は、下記のように実行します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">gradle コマンドの代わりに gradlew コマンドを使用&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradlew build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>仕組みは単純で、Gradle がインストールされていない環境で &lt;code>gradlew&lt;/code> コマンドを実行すると、最初に Gradle の実行環境がインストールされてビルドが実行されるようになっています。
Gradle の実行環境の実体は &lt;code>~/.gradle/wrapper/dists/gradle-1.12-bin&lt;/code> といったディレクトリにインストールされ、次回の &lt;code>gradlew&lt;/code> コマンド実行時には、そこにあるファイルが使用されるようになります（この動きを特に意識する必要はありません）。&lt;/p>
&lt;h2 id="gradle-wrapper-の作成">Gradle Wrapper の作成&lt;/h2>
&lt;p>Gradle Wrapper のスクリプトファイル、およびその実行に必要なライブラリ群は、下記のコマンドで生成することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle wrapper
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>これだけでも十分なのですが、下記のように &lt;code>wrapper&lt;/code> タスクのコンフィギュレーションを定義しておくことで、どのバージョンの Gradle 相当の Gradle Wrapper を作成するかを指定することができます（他にもいろいろな設定を行うことができます。詳しくは &lt;a href="https://docs.gradle.org/current/dsl/org.gradle.api.tasks.wrapper.Wrapper.html">Wrapper の DSL ドキュメント&lt;/a> を参照してください）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wrapper&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">gradleVersion&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;5.0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記のようなバージョン指定を行わない場合は、Gradle Wrapper 作成時に使用した &lt;code>gradle&lt;/code> コマンドのバージョンに相当する Gradle Wrapper が作成されます。
ビルド環境をより明確にするためにも、上記のタスクは定義しておいた方がよいでしょう。&lt;/p></description></item><item><title>Gradle デーモンを使って gradle コマンドを高速化する (org.gradle.daemon)</title><link>https://maku77.github.io/p/szhzejv/</link><pubDate>Fri, 10 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/szhzejv/</guid><description>&lt;h2 id="gradle-デーモンの立ち上げ">Gradle デーモンの立ち上げ&lt;/h2>
&lt;p>&lt;code>gradle&lt;/code> コマンドを実行すると、デフォルトでは毎回 Java のバーチャルマシンを起動するため、下記のような簡単なタスクを実行するだけでも &lt;strong>2、3 秒&lt;/strong>の実行時間がかかってしまいます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;pre tabindex="0">&lt;code class="language-command" data-lang="command">$ gradle hello
:hello
Hello

BUILD SUCCESSFUL

Total time: 2.353 secs&lt;/code>&lt;/pre>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>gradle&lt;/code> コマンドを実行するときに、&lt;strong>&lt;code>--daemon&lt;/code>&lt;/strong> オプションを付けるようにすると、Gradle のプロセスを常駐させ（デーモン化）、そのプロセスを毎回のビルドで使いまわすようになります。
初回はデーモンの立ち上げのために時間がかかりますが、2 度目からのビルドは高速に実行することができます。
下記の実行例を見ると、&lt;strong>1 秒以内&lt;/strong>に処理できていることがわかります。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果（--daemonオプションあり）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;pre tabindex="0">&lt;code class="language-command" data-lang="command">$ gradle --daemon hello
:hello
Hello

BUILD SUCCESSFUL

Total time: 0.905 secs&lt;/code>&lt;/pre>&lt;/div>
&lt;/figure>

&lt;p>ちなみに、常駐している Gradle のプロセスは、&lt;strong>3 時間&lt;/strong>使用されないと自動的に終了します。
下記のように明示的に停止することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ gradle --stop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Stopping daemon&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Gradle daemon stopped.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="gradle-デーモンをデフォルトで有効にする">Gradle デーモンをデフォルトで有効にする&lt;/h2>
&lt;p>&lt;code>gradle&lt;/code> コマンドに毎回 &lt;code>--daemon&lt;/code> オプションを付けるのが面倒な場合は、Gradle の設定ファイル (&lt;strong>&lt;code>gradle.properties&lt;/code>&lt;/strong>) でデーモンを常に有効にすることができます。&lt;/p>
&lt;p>設定は下記のいずれかのファイルで行います。&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;Project&amp;gt;/gradle.properties&lt;/code> &amp;hellip; プロジェクトごとの設定&lt;/li>
&lt;li>&lt;code>$HOME/.gradle/gradle.properties&lt;/code> &amp;hellip; ユーザごとの設定 - macOS/Linux の場合&lt;/li>
&lt;li>&lt;code>%USERPROFILE%/.gradle/gradle.properties&lt;/code> &amp;hellip; ユーザごとの設定 - Windows の場合&lt;/li>
&lt;/ul>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">gradle.properties&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">org&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">gradle&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">daemon&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Gradle で実行可能な JAR ファイルを作成する</title><link>https://maku77.github.io/p/5iacmi7/</link><pubDate>Fri, 10 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/5iacmi7/</guid><description>&lt;p>Gradle の &lt;code>java&lt;/code> プラグインを使用して、実行可能な JAR ファイルを作成してみます。
ここでは、下記のような簡単な Hello World アプリケーションをビルドします。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">src/main/java/com/example/Main.java&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">com.example&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">Main&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>JAR ファイルを特別なパラメータなしで実行できるようにするには、JAR ファイルにアーカイブする &lt;code>Manifest&lt;/code> ファイルでエントリポイントとなる &lt;code>Main&lt;/code> クラスを指定しておく必要があります。
ビルドスクリプト内で下記のように記述しておくと、&lt;code>com.example.Main&lt;/code> をエントリポイントとするような &lt;code>Manifest&lt;/code> ファイルを生成してくれるようになります。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">version&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">1.0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">jar&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">manifest&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">attributes&lt;/span> &lt;span class="s1">&amp;#39;Main-Class&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;com.example.Main&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>ビルドします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BUILD SUCCESSFUL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Total time: 1.063 secs
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>作成された JAR ファイルは、下記のように実行できるようになっているはずです。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> java -jar build/libs/sample-1.0.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のファイル名からもわかるように、プロジェクトのプロパティ (&lt;code>version&lt;/code>) に設定したバージョン情報が、自動的に JAR ファイル名のプレフィックスとして設定されます。&lt;/p></description></item><item><title>Gradle でタスクの依存関係を表現する</title><link>https://maku77.github.io/p/sifxuig/</link><pubDate>Thu, 09 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/sifxuig/</guid><description>&lt;h2 id="タスク間に依存関係を設定する">タスク間に依存関係を設定する&lt;/h2>
&lt;p>&lt;code>org.gradle.api.Task&lt;/code> オブジェクトの &lt;a href="https://docs.gradle.org/current/javadoc/org/gradle/api/Task.html#dependsOn(java.lang.Object...)">dependsOn メソッド&lt;/a> を使用することで、タスク間に依存関係を持たせることができます。&lt;/p>
&lt;h3 id="方法1タスク定義時の引数で依存定義する">方法1）タスク定義時の引数で依存定義する&lt;/h3>
&lt;p>タスク定義時の &lt;strong>&lt;code>dependsOn&lt;/code>&lt;/strong> 引数（厳密にはマップキー）でタスク間の依存関係を設定することができます。
次の例では、&lt;code>hello1&lt;/code> タスクに依存する &lt;code>hello2&lt;/code> タスクを定義しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello2&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">dependsOn:&lt;/span> &lt;span class="n">hello1&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 2&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>hello2&lt;/code> タスクを実行するときに、先に &lt;code>hello1&lt;/code> タスクが実行されるようになります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello 2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="方法2configure-クロージャ内で依存定義する">方法2）Configure クロージャ内で依存定義する&lt;/h3>
&lt;p>タスク定義時の Configure クロージャ内で &lt;strong>&lt;code>dependsOn&lt;/code>&lt;/strong> メソッドを呼び出して依存関係を指定することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello2&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dependsOn&lt;/span> &lt;span class="n">hello1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="方法3タスク定義後に依存を追加する">方法3）タスク定義後に依存を追加する&lt;/h3>
&lt;p>すでに定義済みのタスク（&lt;code>Task&lt;/code> オブジェクト）の &lt;strong>&lt;code>dependsOn&lt;/code>&lt;/strong> メソッドを呼び出すことで、後付けで依存関係を追加することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello2&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello 2&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">hello2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">dependsOn&lt;/span> &lt;span class="n">hello1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="まだ定義されていないタスクを依存関係に追加する">まだ定義されていないタスクを依存関係に追加する&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">hello2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">dependsOn&lt;/span> &lt;span class="n">hello1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>のように依存関係を追加するときに、&lt;code>hello1&lt;/code> というオブジェクト名で参照できているのは、&lt;code>hello1&lt;/code> タスクがすでに定義済みで、&lt;code>Project&lt;/code> オブジェクトの &lt;code>hello1&lt;/code> プロパティとして参照可能になっているからです（Configuration フェーズでは上から順番に処理されていくので、&lt;code>hello1&lt;/code> タスクの定義が上に記述されている必要があります）。&lt;/p></description></item><item><title>Gradle で Java プロジェクトをビルドするときのディレクトリ構成を変更する (sourceSets, buildDir)</title><link>https://maku77.github.io/p/odjj8e7/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/odjj8e7/</guid><description>&lt;p>&lt;code>java&lt;/code> プラグインは、プロジェクトのディレクトリ構成が次のようになっていると想定しています。
これは、Gradle のソースセットの設定（インプットファイルの置き場所の設定）がデフォルトでこのようになっているからです。&lt;/p>
&lt;ul>
&lt;li>Java ソースコード: &lt;strong>&lt;code>src/main/java&lt;/code>&lt;/strong> および &lt;strong>&lt;code>src/test/java&lt;/code>&lt;/strong>&lt;/li>
&lt;li>出力先のディレクトリ: &lt;strong>&lt;code>build&lt;/code>&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>このソースセットの設定を変更するとこで、プロジェクトの都合に合わせたディレクトリ構成に変更できます。
例えば、製品用の Java ソースコードを &lt;strong>&lt;code>src&lt;/code>&lt;/strong> ディレクトリ、テスト用の Java ソースコードを &lt;strong>&lt;code>test&lt;/code>&lt;/strong> ディレクトリ、出力先を &lt;strong>&lt;code>out&lt;/code>&lt;/strong> ディレクトリに変更するには以下のように設定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sourceSets&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">main&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">java&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">srcDirs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;src&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">test&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">java&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">srcDirs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;test&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">buildDir&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;out&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>こう書くこともできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sourceSets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">main&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">srcDirs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;src&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sourceSets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">test&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">srcDirs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;test&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">buildDir&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;out&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>この設定により、下記のようなパスに置かれた Java ソースコードがコンパイルされるようになります。&lt;/p>
&lt;ul>
&lt;li>&lt;code>src/com/example/Main.java&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>正確には、&lt;code>srcDirs&lt;/code> メソッドは、&lt;strong>ディレクトリを変更するのではなく追加&lt;/strong> します。
なので、もともとの &lt;code>src/main/java&lt;/code> ディレクトリ以下に置かれている Java ソースコードは、相変わらずコンパイルの対象になります。&lt;/p>
&lt;p>ちなみに、出力先ディレクトリ (&lt;code>buildDir&lt;/code>) を変更した場合、&lt;code>gradle clean&lt;/code> コマンドでクリーンナップされるディレクトリも変更されます。&lt;/p></description></item><item><title>Groovy でクラスを定義する</title><link>https://maku77.github.io/p/j5bvcq9/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/j5bvcq9/</guid><description>&lt;h2 id="クラスを定義する">クラスを定義する&lt;/h2>
&lt;p>Groovy では、クラスやメソッドの可視性はデフォルトで public になります。
下記の &lt;code>Book&lt;/code> クラスは &lt;code>title&lt;/code> と &lt;code>authors&lt;/code> フィールドを持っており、両方とも外部から参照できます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Book&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">title&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">authors&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="nf">getLabel&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">title&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;, &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">authors&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">String&lt;/span> &lt;span class="nf">toString&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">getLabel&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">book&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Book&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Title1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">authors&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;Author1&amp;#39;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;Author2&amp;#39;&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s1">&amp;#39;Author3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">book&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> groovy sample.groovy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Title1, [Author1, Author2, Author3]
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記の例では、&lt;code>book.title&lt;/code> というプロパティに直接アクセスしているかのように見えますが、内部的には、自動的に生成された &lt;code>book.getTitle()&lt;/code> という getter メソッドが呼び出されています。
同様に、&lt;code>book.setTitle()&lt;/code> という setter メソッドも自動的に生成されています。&lt;/p>
&lt;p>つまり、下記の 2 つのコードは同じ動作をします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Title1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">title&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setTitle&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Title1&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getTitle&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="名前付きパラメータによるコンストラクタ呼び出し">名前付きパラメータによるコンストラクタ呼び出し&lt;/h2>
&lt;p>コンストラクタを呼び出すときに、名前付きパラメータを指定することで、任意のプロパティを初期化することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">class&lt;/span> &lt;span class="nc">Book&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">title&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">def&lt;/span> &lt;span class="n">authors&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">book&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Book&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">title:&lt;/span>&lt;span class="s1">&amp;#39;Title1&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">authors:&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;Author1&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s1">&amp;#39;Author2&amp;#39;&lt;/span>&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">book&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">authors&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Groovy でマップ (Map) を扱う</title><link>https://maku77.github.io/p/ohhdpvf/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ohhdpvf/</guid><description>&lt;h2 id="groovy-の-map-の基本">Groovy の Map の基本&lt;/h2>
&lt;p>Groovy の Map インスタンスは、List インスタンスと同様に &lt;strong>&lt;code>[&lt;/code>&lt;/strong> と &lt;strong>&lt;code>]&lt;/code>&lt;/strong> を使用して定義することができます。
ただし、各要素はコロン (&lt;code>:&lt;/code>) で区切って、キーと値を指定します。
内部的には、&lt;code>java.util.LinkedHashMap&lt;/code> インスタンスが生成されています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">map&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="nl">xxx:&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">yyy:&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nl">zzz:&lt;/span>&lt;span class="mi">300&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getClass&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">util&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">LinkedHashMap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">size&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">xxx&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">map&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="map-の要素を列挙する">Map の要素を列挙する&lt;/h2>
&lt;p>Map の要素は、List の要素と同様に &lt;strong>&lt;code>each&lt;/code>&lt;/strong> メソッドを使ってイテレートすることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">map&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">each&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">val&lt;/span> &lt;span class="o">-&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">val&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="空の-map-インスタンスを生成する">空の Map インスタンスを生成する&lt;/h2>
&lt;p>空の Map インスタンスを生成するときは、ちょっと特殊ですが下記のように記述する必要があります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">map&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[:]&lt;/span> &lt;span class="c1">// 空の Map
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>真ん中のコロン &lt;code>:&lt;/code> を省略してしまうと、List オブジェクトの生成とみなされてしまいます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span> &lt;span class="c1">// 空の List
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ちなみに、Ruby や Python におけるハッシュの生成では、リストの生成とは異なる &lt;code>{}&lt;/code> という記号を使用することで、生成すべきオブジェクトがハッシュなのかリストなのかを区別するようになっています。
Groovy ではハッシュとリストの生成に同じ記号 &lt;code>[]&lt;/code> を用いる仕様なので、上記のような細かい制約が出てくるんですね。&lt;/p></description></item><item><title>Groovy でメソッドを定義する</title><link>https://maku77.github.io/p/6qzzzry/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6qzzzry/</guid><description>&lt;p>下記のサンプルでは、2 つの変数を足し合わせる &lt;code>add&lt;/code> メソッドを定義しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// メソッドの定義
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// メソッドの呼び出し
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">val&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>Groovy では、他の多くのスクリプト言語と同様に、メソッド内で最後に評価された式の値がそのまま戻り値となるので、&lt;code>return&lt;/code> キーワードを省略することができます。
また、パラメータの型や、戻り値の型も明示する必要はありません（最初に &lt;code>def&lt;/code> とだけ書けばよい）。&lt;/p>
&lt;p>次のように型を明示することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">add&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>戻り値がないことを明示したいのであれば、Java と同様に &lt;code>void&lt;/code> と定義することもできます。
戻り値の型が &lt;code>void&lt;/code> のメソッドの戻り値を強引に取得しようとすると、&lt;code>null&lt;/code> が返されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">String&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello, &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">greet&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Jack&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">val&lt;/span> &lt;span class="c1">//=&amp;gt; null
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>メソッド呼び出し時のパラメータを囲む括弧は、次のように省略することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">val&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ただし、パラメータを 1 つも持たない場合は、呼び出し時の括弧を省略することはできません。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">greet&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">greet&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="c1">// 括弧は省略できない
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Groovy でリスト (List) を扱う</title><link>https://maku77.github.io/p/z9qmfd4/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/z9qmfd4/</guid><description>&lt;h2 id="groovy-のリストの基本">Groovy のリストの基本&lt;/h2>
&lt;p>Groovy では、&lt;strong>&lt;code>[1, 2, 3]&lt;/code>&lt;/strong> といった構文を使用して、簡単に List インスタンスを生成することができます。
内部的には &lt;code>java.util.ArrayList&lt;/code> のインスタンスが生成されます。
下記の例では、3 つの要素を持つ List インスタンスを生成しています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mf">0.25&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getClass&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">util&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">ArrayList&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">size&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="リストへの要素の追加">リストへの要素の追加&lt;/h2>
&lt;p>リストの末尾に要素を追加する場合、&lt;strong>&lt;code>&amp;lt;&amp;lt;&lt;/code>&lt;/strong> というショートカット記法を使用することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="c1">//=&amp;gt; [100, 200, 300]
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>これは、下記のように &lt;code>add&lt;/code> メソッドを呼び出すのと同等の動作をします。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">add&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">add&lt;/span> &lt;span class="mi">200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">add&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="c1">//=&amp;gt; [100, 200, 300]
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>あまり違いはないように見えますが、&lt;code>&amp;lt;&amp;lt;&lt;/code> を使った方が可読性は若干上がるようです。
また、&lt;code>&amp;lt;&amp;lt;&lt;/code> を使うことにより、下記のように連続して要素を追加することが可能です。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">200&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="リストの要素を列挙する">リストの要素を列挙する&lt;/h2>
&lt;p>リスト内の要素をループ処理したいときは、下記のように &lt;strong>&lt;code>each&lt;/code>&lt;/strong> メソッドを使用します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s1">&amp;#39;AAA&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mf">0.25&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">each&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">elem&lt;/span> &lt;span class="o">-&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="n">elem&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の例では、イテレート用の変数を明示していますが、下記のようにデフォルトの &lt;strong>&lt;code>it&lt;/code>&lt;/strong> 変数を使用することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">each&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="n">it&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="負のインデックス範囲外インデックスの扱い">負のインデックス、範囲外インデックスの扱い&lt;/h2>
&lt;p>負のインデックスを指定することで、末尾から数えた位置の要素を取得することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="mi">300&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="o">[-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">300&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>存在しない位置のインデックスを指定した場合は、Java のように &lt;code>ArrayIndexOutOfBoundsException&lt;/code> 例外が発生することはなく、単純に &lt;strong>&lt;code>null&lt;/code>&lt;/strong> が返されます。&lt;/p></description></item><item><title>Groovy で文字列リテラルを扱う</title><link>https://maku77.github.io/p/v8m6rme/</link><pubDate>Wed, 08 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/v8m6rme/</guid><description>&lt;h2 id="文字列リテラルと-gstrings">文字列リテラルと GStrings&lt;/h2>
&lt;p>Groovy の文字列リテラルは、シングルクォート (&lt;code>'&lt;/code>) あるいは、ダブルクォート (&lt;code>&amp;quot;&lt;/code>) で囲んで表現します。
ダブルクォートで囲んだ文字列リテラルは、&lt;strong>&lt;code>$&lt;/code>&lt;/strong> で始まる変数が展開されます。
このような変数を含む文字列を &lt;strong>GStrings (Groovy Strings)&lt;/strong> と呼びます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Britney&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello $name&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;Hello $name&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Hello $name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Britney&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="文字列の中の式">文字列の中の式&lt;/h2>
&lt;p>&lt;strong>&lt;code>${式}&lt;/code>&lt;/strong> という構文を使用すると、文字列の中で任意の式を実行することができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;mickey&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">println&lt;/span> &lt;span class="s2">&amp;#34;Hello ${name.capitalize()}&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Hello Mickey&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ヒアドキュメント">ヒアドキュメント&lt;/h2>
&lt;p>3 連続のクォーテーションマーク（&lt;strong>&lt;code>'''&lt;/code>&lt;/strong> あるいは &lt;strong>&lt;code>&amp;quot;&amp;quot;&amp;quot;&lt;/code>&lt;/strong>）で文字列を囲むことによって、複数行にまたがる文字列リテラル（ヒアドキュメント）を定義することができます。
通常の文字列リテラルと同様に、ダブルクォート (&lt;code>&amp;quot;&lt;/code>) で囲んだ場合だけ、&lt;code>$&lt;/code> で始まる変数が展開されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">html&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&amp;lt;html&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;lt;head&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;lt;title&amp;gt;$title&amp;lt;/title&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;lt;head&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;lt;body&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> $body
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &amp;lt;/body&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;lt;/html&amp;gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Groovy で assert を使用する</title><link>https://maku77.github.io/p/m9veity/</link><pubDate>Tue, 07 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/m9veity/</guid><description>&lt;p>Groovy では、デフォルトで &lt;code>assert&lt;/code> が使用できるようになっています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.groovy&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">num&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getClass&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Integer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">def&lt;/span> &lt;span class="n">str&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">assert&lt;/span> &lt;span class="n">str&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getClass&lt;/span>&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">java&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">lang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">Integer&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記のスクリプトを実行すると、2 つ目の &lt;code>assert&lt;/code> で fail して、下記のように詳細な情報が表示されます。
分かりやすいですね！&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> groovy sample.groovy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Assertion failed:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">assert str.getClass() == java.lang.Integer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> | | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> | | false
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> | class java.lang.String
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go"> Hello
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go"> at sample.run(sample.groovy:5)
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Groovy と Java の違い</title><link>https://maku77.github.io/p/som2e4k/</link><pubDate>Tue, 07 Jul 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/som2e4k/</guid><description>&lt;p>Groovy は Java と異なり、下記のような特徴を持っています。&lt;/p>
&lt;ul>
&lt;li>行末のセミコロンは省略できる&lt;/li>
&lt;li>クラス、コンストラクタ、メソッドはデフォルトで &lt;code>public&lt;/code> となる&lt;/li>
&lt;li>&lt;code>return&lt;/code> の記述は省略できる（最後に評価された式が戻り値となる）&lt;/li>
&lt;li>getter/setter メソッドが自動的に作られる（&lt;code>obj.prop&lt;/code> のようにアクセスすれば &lt;code>obj.getProp&lt;/code> や &lt;code>setProp&lt;/code> が呼び出される）&lt;/li>
&lt;li>&lt;code>==&lt;/code> によるオブジェクトの比較は、自動的に &lt;code>equals&lt;/code> による比較となる（しかも &lt;code>null&lt;/code> チェックの必要はない）&lt;/li>
&lt;li>&lt;code>assert&lt;/code> は常に有効（Java の場合は &lt;code>-ea&lt;/code> または &lt;code>--enable-assertion&lt;/code> オプションの指定が必要）&lt;/li>
&lt;li>変数の型や、メソッドの戻り値の型は &lt;code>def&lt;/code> としておけば、自動で判別してくれる&lt;/li>
&lt;li>コレクション（List や Map）の扱いがシンプルで、Python や Ruby に近い構文で記述できる&lt;/li>
&lt;/ul></description></item><item><title>Gradle でファイルをコピー、リネームするためのタスクを作成する (type: Copy)</title><link>https://maku77.github.io/p/q6ducqz/</link><pubDate>Tue, 30 Jun 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/q6ducqz/</guid><description>&lt;p>Gradle のビルドスクリプトで &lt;strong>&lt;code>Copy&lt;/code>&lt;/strong> 型のタスクを定義すると、ファイルのコピーや移動を簡単に行うことができます。&lt;/p>
&lt;h2 id="ファイルコピーの基本">ファイルコピーの基本&lt;/h2>
&lt;p>次の &lt;code>hello&lt;/code> タスクは、ディレクトリ &lt;code>from/dir&lt;/code> 以下のファイルを再帰的にコピーします。
&lt;code>from/dir&lt;/code> 以下のディレクトリ階層は保たれます。
コピー先のディレクトリ &lt;code>to/dir&lt;/code> が存在しない場合は、自動的に作成されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;from/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;to/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="コピーする対象を絞り込む">コピーする対象を絞り込む&lt;/h2>
&lt;p>&lt;code>Copy&lt;/code> タスクにおいて、&lt;strong>&lt;code>include&lt;/code>&lt;/strong> や &lt;strong>&lt;code>exclude&lt;/code>&lt;/strong> でファイル名のパターンを指定することで、コピーするファイルを絞り込むことができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">拡張子が .txt のファイルをすべてコピー&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;from/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;to/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;**/*.txt&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">拡張子が .bk ではないファイルをすべてコピー&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;from/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;to/dir&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exclude&lt;/span> &lt;span class="s1">&amp;#39;**/*.bk&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="複数のディレクトリからファイルをコピーする">複数のディレクトリからファイルをコピーする&lt;/h2>
&lt;p>コピー元のディレクトリを複数指定して、一つのディレクトリにコピーすることもできます。
下記の例では、&lt;code>from1&lt;/code> ディレクトリと &lt;code>from2&lt;/code> ディレクトリ内のファイルを &lt;code>to&lt;/code> ディレクトリにコピーしています。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;from1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;from2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;to&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ただし、この方法だと、複数のコピー元に同じファイル名のファイルがあると、ファイルが上書きコピーされてしまいます（ツリー構造が異なれば大丈夫です）。
下記のようにすると、コピー先にディレクトリを作って、その中にファイルをコピーすることができます。
&lt;code>from&lt;/code> のパラメータを括弧で囲むことに注意してください。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;from1&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;f1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;from2&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;f2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;to&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>このようにすると、&lt;code>from1&lt;/code> ディレクトリ内のファイルは &lt;code>to/f1&lt;/code> に、&lt;code>from2&lt;/code> ディレクトリ内のファイルは &lt;code>to/f2&lt;/code> に、それぞれコピーされるようになります。&lt;/p></description></item><item><title>Gradle のテンプレート機能を使ってファイルを生成する</title><link>https://maku77.github.io/p/ijynhet/</link><pubDate>Tue, 30 Jun 2015 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/ijynhet/</guid><description>&lt;p>Groovy の SimpleTemplateEngine クラスの機能を使用することで、ファイルコピー時にファイル内の文字列を置換することができます。
例えば、入力ファイルとして、下記のようなテンプレートファイルを用意しておきます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">input/build.properties&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">version=${version}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">buildDate=${buildDate.format(&amp;#34;yyyyMMdd&amp;#39;T&amp;#39;HHmmss&amp;#34;)}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;strong>&lt;code>${string}&lt;/code>&lt;/strong> という部分が動的に置換される部分です。
そこにどんな値を格納するかは、&lt;code>Copy&lt;/code> 型タスクの &lt;strong>&lt;code>expand()&lt;/code>&lt;/strong> メソッドで指定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">hello&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">type:&lt;/span> &lt;span class="n">Copy&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;input&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;build.properties&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">into&lt;/span> &lt;span class="s1">&amp;#39;output&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">expand&lt;/span>&lt;span class="o">([&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">version:&lt;/span> &lt;span class="s1">&amp;#39;1.0.0&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">buildDate:&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Date&lt;/span>&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記のタスクを実行すると、下記のようなファイルが出力されます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">output/build.properties&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">version=1.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">buildDate=20150630T224515&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Gradle タスクの一覧を表示する (gradle tasks)</title><link>https://maku77.github.io/p/qoaky8w/</link><pubDate>Tue, 17 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/qoaky8w/</guid><description>&lt;p>Gradle で実行可能なタスクの一覧は &lt;strong>&lt;code>tasks&lt;/code>&lt;/strong> タスクを走らせることで確認できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q tasks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">All tasks runnable from root project
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Build Setup tasks
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">-----------------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">init - Initializes a new Gradle build. [incubating]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">wrapper - Generates Gradle wrapper files. [incubating]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">Help tasks
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">----------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">dependencies - Displays all dependencies declared in root project &amp;#39;gradle&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">dependencyInsight - Displays the insight into a specific dependency in root project &amp;#39;gradle&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">help - Displays a help message
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">projects - Displays the sub-projects of root project &amp;#39;gradle&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">properties - Displays the properties of root project &amp;#39;gradle&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">tasks - Displays the tasks runnable from root project &amp;#39;gradle&amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="go">To see all tasks and more detail, run with --all.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>もう少し詳細に表示したい場合は、&lt;strong>&lt;code>--all&lt;/code>&lt;/strong> オプションを付けて &lt;code>tasks&lt;/code> タスクを実行します。
下記の例では、&lt;code>apply plugin: 'java'&lt;/code> したときのタスク一覧を確認しています。&lt;/p></description></item><item><title>Gradle のタスクを定義する</title><link>https://maku77.github.io/p/a88r2ua/</link><pubDate>Tue, 17 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/a88r2ua/</guid><description>&lt;p>&lt;code>gradle&lt;/code> コマンドを実行すると、カレントディレクトリにある &lt;strong>&lt;code>build.gradle&lt;/code>&lt;/strong> ビルドスクリプト（レシピ）を読み込み、そこに定義されているタスクを実行します。
下記は、&lt;code>hello&lt;/code> というタスクを定義する例で、Excecution フェーズで &lt;code>Hello World&lt;/code> と表示するように指定しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello World&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>具体的には、&lt;code>hello&lt;/code> という名前の &lt;a href="https://docs.gradle.org/current/javadoc/org/gradle/api/Task.html">Task オブジェクト&lt;/a> を作成し、&lt;code>Task#doLast()&lt;/code> メソッドでタスクのアクションリストの末尾にアクションを追加する、ということをしています。
このように定義したタスクを実行するには、&lt;code>gradle&lt;/code> コマンドの引数でタスク名を指定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">:hello
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello World
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BUILD SUCCESSFUL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Total time: 2.527 secs
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>コロンから始まる &lt;strong>&lt;code>:hello&lt;/code>&lt;/strong> という行が、hello タスクを実行していることを示しています。
&lt;code>gradle&lt;/code> コマンドを実行するときに、&lt;strong>&lt;code>-q&lt;/code>&lt;/strong> あるいは &lt;strong>&lt;code>--quiet&lt;/code>&lt;/strong> オプションを指定すると、エラー以外のログ出力を抑制できます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q hello
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello World
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="xNote">
 &lt;span class="xNote_title">☝️ （コラム）leftShift は deprecated&lt;/span>
 &lt;span class="xNote_body">&lt;p>Gradle 4.x までは、タスクの Configuration クロージャ内に &lt;code>doLast&lt;/code> アクションを定義する代わりに、次のようなショートカット記法が使えました。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello World&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Gradle 5.x 以降はこのような記述方法は deprecated になっているため、次のようなエラーが出ます。&lt;/p>
&lt;pre tabindex="0">&lt;code>Could not find method leftShift()
&lt;/code>&lt;/pre>&lt;p>しょうがないので &lt;code>doLast&lt;/code> を使いましょう。&lt;/p></description></item><item><title>Gradle で Java プロジェクトをビルドする</title><link>https://maku77.github.io/p/bvinwfk/</link><pubDate>Sun, 08 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/bvinwfk/</guid><description>&lt;p>Java プラグインを適用すると、Java のプロジェクトをビルドするためのタスクが定義されます。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.gradle.org/current/userguide/java_plugin.html">Java Plugin の説明&lt;/a>&lt;/li>
&lt;/ul>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">apply&lt;/span> &lt;span class="nl">plugin:&lt;/span> &lt;span class="s1">&amp;#39;java&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="java-プロジェクトのディレクトリ構成">Java プロジェクトのディレクトリ構成&lt;/h2>
&lt;p>Java プラグインはデフォルトで、以下のようなディレクトリ構造でソースコードが格納されていることを期待して動作します。&lt;/p>
&lt;ul>
&lt;li>&lt;code>src/main/java&lt;/code> &amp;hellip; 製品用の Java ソースコード&lt;/li>
&lt;li>&lt;code>src/main/resources&lt;/code> &amp;hellip; 製品用のリソースファイル&lt;/li>
&lt;li>&lt;code>src/test/java&lt;/code> &amp;hellip; ユニットテスト用の Java ソースコード&lt;/li>
&lt;li>&lt;code>src/test/resources&lt;/code> &amp;hellip; ユニットテスト用のリソースファイル&lt;/li>
&lt;/ul>
&lt;p>例えば、&lt;code>com.example.Main&lt;/code> クラスのソースコードは下記のようなパスに格納します（&lt;code>build.gradle&lt;/code> ファイルがあるディレクトリからの相対パスです）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">src/main/java/com/example/Main.java&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nn">com.example&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">class&lt;/span> &lt;span class="nc">Main&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">public&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">static&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">String&lt;/span>&lt;span class="p">...&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">out&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="java-プラグインを使ったビルドとプログラムの実行">java プラグインを使ったビルドとプログラムの実行&lt;/h2>
&lt;p>Java プラグインが提供する &lt;strong>&lt;code>build&lt;/code>&lt;/strong> タスクを実行することにより、Java プロジェクトのビルドを行うことができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">BUILD SUCCESSFUL
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ビルドが成功すると、&lt;code>build&lt;/code> ディレクトリに生成物が出力されます。
例えば、クラスファイルは &lt;strong>&lt;code>build/classes/main&lt;/code>&lt;/strong> や &lt;strong>&lt;code>build/classes/test&lt;/code>&lt;/strong> ディレクトリ以下に出力されます。
このディレクトリにクラスパスを通せば、Java プログラムを実行することができます。&lt;/p></description></item><item><title>Gradle でデフォルトタスクを指定する (defaultTasks)</title><link>https://maku77.github.io/p/zfc37zt/</link><pubDate>Sun, 08 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/zfc37zt/</guid><description>&lt;p>&lt;code>gradle&lt;/code> コマンドではパラメータとしてタスク名を指定するのですが、パラメータを省略した場合に実行する &lt;strong>デフォルトタスク&lt;/strong> を指定しておくこともできます。
下記のサンプルでは、&lt;code>hello&lt;/code> タスクをデフォルトタスクとして指定しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">defaultTasks&lt;/span> &lt;span class="s1">&amp;#39;hello&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello World&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q &lt;span class="c1"># gradle -q hello と同じ結果になる&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello World
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>デフォルトタスクはカンマで区切って、複数指定することができます。
デフォルトタスクを複数指定した場合、指定した順番に実行されます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">build.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">defaultTasks&lt;/span> &lt;span class="s1">&amp;#39;hello1&amp;#39;&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s1">&amp;#39;hello2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello1&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello1&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="n">hello2&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">doLast&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello2&amp;#39;&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle -q &lt;span class="c1"># gradle -q hello1 hello2 と同じ結果になる&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="go">Hello2
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Gradle 実行時の 3 つのフェーズ (initialization, configuration, execution)</title><link>https://maku77.github.io/p/o7yqmcx/</link><pubDate>Sun, 08 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/o7yqmcx/</guid><description>&lt;h2 id="3-つのフェーズ">3 つのフェーズ&lt;/h2>
&lt;p>Gradle によるビルドを実行するとき、内部では下記のような 3 つのフェーズに分けてビルドが実行されていきます。&lt;/p>
&lt;ol>
&lt;li>Initialization フェーズ&lt;/li>
&lt;li>Configuration フェーズ&lt;/li>
&lt;li>Execution フェーズ&lt;/li>
&lt;/ol>
&lt;h3 id="1-initialization-フェーズ">(1) Initialization フェーズ&lt;/h3>
&lt;p>マルチプロジェクトにおけるプロジェクトの依存関係が解決され、プロジェクトのビルド順序が決められるフェーズです。
サブプロジェクトの構成は、トップレベルのディレクトリに置かれる &lt;strong>&lt;code>settings.gradle&lt;/code>&lt;/strong> ファイルで定義されます（Gradle の内部では、このファイルを基に &lt;a href="https://docs.gradle.org/current/dsl/org.gradle.api.initialization.Settings.html">Settings&lt;/a> オブジェクトが生成されています）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">settings.gradle&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;subproject1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s1">&amp;#39;subproject2&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>また、プロジェクトごとに Gradle 内部で &lt;a href="https://docs.gradle.org/current/dsl/org.gradle.api.Project.html">Project&lt;/a> インスタンスが生成されています（マルチプロジェクトなビルド構成であれば、複数の &lt;code>Project&lt;/code> インスタンスが生成されます）。
プロジェクトの依存関係は、各プロジェクトの &lt;strong>&lt;code>dependencies&lt;/code>&lt;/strong> ブロック内で定義されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dependencies&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">compile&lt;/span> &lt;span class="nf">project&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;:subproject&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-configuration-フェーズ">(2) Configuration フェーズ&lt;/h3>
&lt;p>すべてのプロジェクトの &lt;strong>&lt;code>build.gradle&lt;/code>&lt;/strong> が処理され、すべてのタスクの依存関係を認識するフェーズです。
タスクの依存関係は、下記のように &lt;strong>&lt;code>dependsOn&lt;/code>&lt;/strong> プロパティで指定されます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">task&lt;/span> &lt;span class="nf">task2&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nl">dependsOn:&lt;/span> &lt;span class="n">task1&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">println&lt;/span> &lt;span class="s1">&amp;#39;Hello task2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記の例では依存タスクを &lt;code>task1&lt;/code> というオブジェクトで指定していますが、&lt;code>'task1'&lt;/code> のように、文字列でタスク名を指定することもできます。
文字列でタスク名を指定することにより、その時点でまだ定義されていないタスクを指定することができます。
Configuration フェーズでは、すべてのタスク定義を走査するため、最終的にはすべての依存関係が問題なく解決されます（逆に、Configuration フェーズ終了時に未解決なタスクがあるとエラーになります）。&lt;/p>
&lt;p>Gradle の処理系内部では、依存グラフ (dependency graph) が生成されています。&lt;/p>
&lt;h3 id="3-execution-フェーズ">(3) Execution フェーズ&lt;/h3>
&lt;p>実際にどのタスクを実行すべきかを判断し、タスクの実行を行うフェーズです。
&lt;code>gradle&lt;/code> コマンドに渡したタスク名や、実行時のカレントディレクトリによってどのタスクを実行するかが変化します。&lt;/p>
&lt;h2 id="振る舞いを調べてみる">振る舞いを調べてみる&lt;/h2>
&lt;p>次のようなビルドファイルを作成すると、3 つのフェーズがどのような順番で実行されていくかを確認することができます。&lt;/p></description></item><item><title>Gradle のプロキシを設定する (gradle.properties)</title><link>https://maku77.github.io/p/5x6qgkx/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/5x6qgkx/</guid><description>&lt;p>&lt;code>gradle&lt;/code> コマンド実行時に Maven リポジトリにアクセスしたり、Gradle Wrapper をインストールするためのアーカイブをダウンロードしたりする際にネットワークアクセスが発生します。
これらのアクセスをプロキシ経由で行う必要がある場合は、&lt;strong>&lt;code>gradle.properties&lt;/code>&lt;/strong> ファイルにプロキシの設定を記述します。&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>用途&lt;/th>
 &lt;th>設定ファイル&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>プロジェクトごとの設定&lt;/td>
 &lt;td>&lt;code>&amp;lt;project&amp;gt;/gradle.properties&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>ユーザごとの設定 (macOS/Linux)&lt;/td>
 &lt;td>&lt;code>$HOME/.gradle/gradle.properties&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>ユーザごとの設定 (Windows)&lt;/td>
 &lt;td>&lt;code>%USERPROFILE%/.gradle/gradle.properties&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>以下のように設定します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">gradle.properties&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyHost&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ホスト&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPort&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ポート番号&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyUser&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ユーザ&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPassword&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">パスワード&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyHost&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ホスト&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPort&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ポート番号&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyUser&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">ユーザ&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPassword&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="err">パスワード&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">設定例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyHost&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">proxy&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPort&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyHost&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">proxy&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemProp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">https&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">proxyPort&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">8080&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Gradle をインストールする (macOS/Windows)</title><link>https://maku77.github.io/p/6qdfg4d/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6qdfg4d/</guid><description>&lt;h2 id="macos-への-gradle-インストール">macOS への Gradle インストール&lt;/h2>
&lt;p>ここでは、&lt;strong>GVM (Groovy enVironment Manager)&lt;/strong> を使って gradle コマンドをインストールします。
GVM を使うと、複数バージョンの Gradle を管理することができます。&lt;/p>
&lt;ol>
&lt;li>
&lt;p>GVM のインストール&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> curl -s get.gvmtool.net &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>GVM で gradle のインストール&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gvm install gradle
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>動作確認&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle --version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="windows-への-gradle-インストール">Windows への Gradle インストール&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://gradle.org/install/">https://gradle.org/install/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>から &lt;code>gradle-1.12-bin.zip&lt;/code> などをダウンロードして、適当なディレクトリに配置します。
&lt;code>gradle&lt;/code> コマンドを実行するには、&lt;code>java&lt;/code> コマンドを実行できるようになっている必要があります。
任意のバージョンの &lt;code>java&lt;/code> コマンドを使用するには、&lt;code>JAVA_HOME&lt;/code> 環境変数を設定しておきます。&lt;/p>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_05
 （binまでは含めないことに注意）
&lt;/code>&lt;/pre>&lt;p>&lt;code>gradle&lt;/code> コマンドを任意のディレクトリから実行できるように、PATH を通しておきます。&lt;/p>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; set PATH=%PATH%;C:\app\gradle-1.12\bin
&lt;/code>&lt;/pre>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行テスト&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">C:\&amp;gt; gradle -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Gradle 1.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Build time: 2014-04-29 09:24:31 UTC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Build number: none
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Revision: a831fa866d46cbee94e61a09af15f9dd95987421
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Groovy: 1.8.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ant: Apache Ant(TM) version 1.9.3 compiled on December 23 2013
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ivy: 2.2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">JVM: 1.8.0_05 (Oracle Corporation 25.5-b02)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OS: Windows 7 6.1 amd64&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>Gradle をインストールする (macOS/Windows)</title><link>https://maku77.github.io/p/6qdfg4d/</link><pubDate>Sun, 01 Jun 2014 00:00:00 +0900</pubDate><guid>https://maku77.github.io/p/6qdfg4d/</guid><description>&lt;h2 id="macos-への-gradle-インストール">macOS への Gradle インストール&lt;/h2>
&lt;p>ここでは、&lt;strong>GVM (Groovy enVironment Manager)&lt;/strong> を使って gradle コマンドをインストールします。
GVM を使うと、複数バージョンの Gradle を管理することができます。&lt;/p>
&lt;ol>
&lt;li>
&lt;p>GVM のインストール&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> curl -s get.gvmtool.net &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>GVM で gradle のインストール&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gvm install gradle
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>動作確認&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> gradle --version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="windows-への-gradle-インストール">Windows への Gradle インストール&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.gradle.org/downloads">https://www.gradle.org/downloads&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>から &lt;code>gradle-1.12-bin.zip&lt;/code> などをダウンロードして、適当なディレクトリに配置します。
&lt;code>gradle&lt;/code> コマンドを実行するには、&lt;code>java&lt;/code> コマンドを実行できるようになっている必要があります。
任意のバージョンの &lt;code>java&lt;/code> コマンドを使用するには、&lt;code>JAVA_HOME&lt;/code> 環境変数を設定しておきます。&lt;/p>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; set JAVA_HOME=C:\Program Files\Java\jdk1.8.0_05
 （binまでは含めないことに注意）
&lt;/code>&lt;/pre>&lt;p>&lt;code>gradle&lt;/code> コマンドを任意のディレクトリから実行できるように、PATH を通しておきます。&lt;/p>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; set PATH=%PATH%;C:\app\gradle-1.12\bin
&lt;/code>&lt;/pre>
&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行テスト&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">C:\&amp;gt; gradle -v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Gradle 1.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Build time: 2014-04-29 09:24:31 UTC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Build number: none
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Revision: a831fa866d46cbee94e61a09af15f9dd95987421
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Groovy: 1.8.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ant: Apache Ant(TM) version 1.9.3 compiled on December 23 2013
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ivy: 2.2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">JVM: 1.8.0_05 (Oracle Corporation 25.5-b02)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OS: Windows 7 6.1 amd64&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item></channel></rss>